import{V as P,_ as Ka,u as Ya,r as w,T as aa,c as ra,a1 as Aa,w as Ia,o as Ua,J as $a,a as p,a2 as Na,b as y,d as h,e as t,f as i,B as j,k as D,i as s,h as V,j as C,L as Ra,s as za,am as Oa,v as Xa,t as d,aN as ua,ao as Fa,a6 as ja,l as qa,n as k,aO as q}from"./index-I05jmhuU.js";import{S as ea}from"./sweetalert2.esm.all-DGhwgajj.js";import{c as Qa}from"./createLucideIcon-GQ3IAryt.js";const L="/admin/phieu-giam-gia",Wa=async f=>{var u;try{return(await P.get(L,{params:f})).data}catch(c){throw console.error("Lỗi khi lấy danh sách phiếu giảm giá:",c),((u=c.response)==null?void 0:u.data)||new Error("Lỗi khi lấy danh sách phiếu giảm giá")}},ca=async f=>{var u;try{return(await P.get(L+`/${f}`)).data}catch(c){throw console.error(`Lỗi khi lấy chi tiết phiếu giảm giá với ID ${f}:`,c),((u=c.response)==null?void 0:u.data)||new Error("Lỗi khi lấy chi tiết phiếu giảm giá")}},Ja=async f=>{var u;try{return(await P.post(L,f)).data}catch(c){throw console.error("Lỗi khi thêm phiếu giảm giá:",c),((u=c.response)==null?void 0:u.data)||new Error("Lỗi khi thêm phiếu giảm giá")}},Za=async(f,u)=>{var c;try{return(await P.put(L+`/${f}`,u)).data}catch(T){throw console.error(`Lỗi khi cập nhật phiếu giảm giá với ID ${f}:`,T),((c=T.response)==null?void 0:c.data)||new Error("Lỗi khi cập nhật phiếu giảm giá")}},ae=async f=>{var u;try{return(await P.delete(L+`/${f}`)).data}catch(c){throw console.error(`Lỗi khi xóa phiếu giảm giá với ID ${f}:`,c),((u=c.response)==null?void 0:u.data)||new Error("Lỗi khi xóa phiếu giảm giá")}},ee=async(f,u)=>{var c;try{return(await P.post(`${L}/${f}/gift?type=${u}`)).data}catch(T){throw console.error("Lỗi khi thêm khách hàng giảm giá:",T),((c=T.response)==null?void 0:c.data)||new Error("Lỗi khi thêm khách hàng giảm giá")}},te=async(f,u)=>{var c;try{return await P.get(L+"/next-delay")}catch(T){throw console.error("Lỗi khi lấy thời gian update:",T),((c=T.response)==null?void 0:c.data)||new Error("Lỗi khi lấy thời gian update")}};/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Qa("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),ie={class:"promotion-container"},ne={class:"page-header"},le={class:"header-content"},se={class:"filters-content"},oe={class:"filter-group"},re={class:"filter-item"},ue={class:"filter-item"},ce={class:"filter-item"},de={class:"filter-item"},ge={class:"filter-actions"},me={class:"row-index"},he={class:"code-cell"},pe={class:"name-cell"},fe={class:"promotion-name"},Te={class:"value-cell"},Ge={key:0,class:"discount-percent"},ve={key:1,class:"discount-amount"},ye={class:"date-range"},De={class:"date-item"},_e={class:"date-item"},we={class:"action-buttons"},be={class:"pagination-wrapper"},ke={class:"dialog-content"},Ve={class:"form-grid"},Ce={class:"form-section"},xe={class:"form-row"},Se={key:0,class:"error-text"},Ee={key:0,class:"error-text"},Be={class:"form-row"},Pe={key:0,class:"error-text"},Le={key:0,class:"error-text"},Me={key:0,class:"error-text"},He={class:"form-section"},Ke={class:"form-row"},Ye={key:0,class:"error-text"},Ae={key:0,class:"error-text"},Ie={class:"form-section"},Ue={class:"form-row"},$e={key:0,class:"error-text"},Ne={key:0,class:"error-text"},Re={class:"form-row"},ze={key:0,class:"error-text"},Oe={class:"dialog-footer"},Xe={class:"dialog-content"},Fe={class:"detail-section"},je={class:"detail-row"},qe={class:"detail-value"},Qe={class:"detail-row"},We={class:"detail-value"},Je={class:"detail-row"},Ze={class:"detail-value"},at={class:"detail-row"},et={class:"detail-value"},tt={class:"detail-row"},it={class:"detail-value"},nt={key:0,class:"detail-row"},lt={class:"detail-value"},st={class:"detail-section"},ot={class:"detail-row"},rt={class:"detail-value"},ut={class:"detail-row"},ct={class:"detail-value"},dt={class:"detail-section"},gt={class:"detail-row"},mt={class:"detail-value"},ht={class:"detail-row"},pt={class:"detail-value"},ft={class:"detail-row"},Tt={class:"detail-value"},Gt={class:"detail-row"},vt={class:"detail-value"},yt={class:"detail-row"},Dt={class:"detail-value"},_t={class:"dialog-footer"},wt={class:"left"},bt={class:"right"},kt={__name:"PhieuGiamGiaAdmin",setup(f){const u=Ya(),c=w(!1),T=w([]),S=w(0),ga=w(0),ta=w(0),$=w(5),K=w(""),Y=w(null),A=w(null),I=w(null),M=w(!1),x=w(!1),N=w(!1),m=aa({id:null,maGiamGia:"",tenGiamGia:"",loaiGiamGia:"",giaTriGiamGia:0,giaTriDonHangToiThieu:0,giaTriGiamGiaToiDa:0,ngayBatDau:"",ngayKetThuc:"",hangToiThieu:"",soDiemCanDeDoi:0,soLuong:0,dieuKienApDung:"",trangThaiPhatHanh:""}),e=aa({id:null,maGiamGia:"",tenGiamGia:"",loaiGiamGia:"Phần trăm",giaTriGiamGia:0,giaTriDonHangToiThieu:0,giaTriGiamGiaToiDa:0,ngayBatDau:"",ngayKetThuc:"",hangToiThieu:"MEMBER",soDiemCanDeDoi:0,soLuong:0,dieuKienApDung:"",trangThaiPhieuGiamGia:"ACTIVE",trangThaiPhatHanh:"NOT_ISSUED"}),o=aa({maGiamGia:"",tenGiamGia:"",giaTriGiamGia:"",giaTriDonHangToiThieu:"",giaTriGiamGiaToiDa:"",ngayBatDau:"",ngayKetThuc:"",soDiemCanDeDoi:"",soLuong:"",dieuKienApDung:""}),ma=()=>{e.id=null,e.maGiamGia="",e.tenGiamGia="",e.loaiGiamGia="Phần trăm",e.giaTriGiamGia=0,e.giaTriDonHangToiThieu=0,e.giaTriGiamGiaToiDa=0,e.ngayBatDau="",e.ngayKetThuc="",e.hangToiThieu="MEMBER",e.soDiemCanDeDoi=0,e.soLuong=0,e.dieuKienApDung="",e.trangThaiPhieuGiamGia="ACTIVE",e.trangThaiPhatHanh="NOT_ISSUED",x.value=!1},Q=()=>{Object.keys(o).forEach(n=>{o[n]=""})},ha=()=>{Q();let n=!0;if(e.maGiamGia&&e.maGiamGia.trim().length>0&&(e.maGiamGia.length<3?(o.maGiamGia="Mã giảm giá phải có ít nhất 3 ký tự",n=!1):e.maGiamGia.length>10&&(o.maGiamGia="Mã giảm giá không được vượt quá 10 ký tự",n=!1)),e.tenGiamGia.trim()?e.tenGiamGia.length<3?(o.tenGiamGia="Tên giảm giá phải có ít nhất 3 ký tự",n=!1):e.tenGiamGia.length>255&&(o.tenGiamGia="Tên giảm giá không được vượt quá 255 ký tự",n=!1):(o.tenGiamGia="Tên giảm giá là bắt buộc",n=!1),e.giaTriGiamGia<=0?(o.giaTriGiamGia="Giá trị giảm giá phải lớn hơn 0",n=!1):e.loaiGiamGia==="Phần trăm"&&e.giaTriGiamGia>60&&(o.giaTriGiamGia="Giá trị giảm giá không được vượt quá 60%",n=!1),!e.ngayBatDau)o.ngayBatDau="Thời gian bắt đầu là bắt buộc",n=!1;else{const a=new Date;new Date(e.ngayBatDau)<a&&!e.id&&(o.ngayBatDau="Thời gian bắt đầu phải sau Thời gian hiện tại",n=!1)}if(!e.ngayKetThuc)o.ngayKetThuc="Thời gian kết thúc là bắt buộc",n=!1;else{const a=new Date(e.ngayBatDau),r=new Date(e.ngayKetThuc),g=new Date;e.ngayBatDau&&r<=a&&(o.ngayKetThuc="Thời gian kết thúc phải sau Thời gian bắt đầu",n=!1),e.id&&e.trangThaiPhieuGiamGia!=="EXPIRED"&&r<=g&&(o.ngayKetThuc="Thời gian kết thúc phải sau Thời gian hiện tại",n=!1)}return e.giaTriGiamGiaToiDa<1e4&&e.loaiGiamGia==="Phần trăm"&&(o.giaTriGiamGiaToiDa="Giá trị giảm giá tối đa không được ít hơn 10000.00",n=!1),e.soLuong<=0&&(o.soLuong="Số lượng phải lớn hơn 0",n=!1),e.dieuKienApDung.trim()||(o.dieuKienApDung="Điều kiện áp dụng là bắt buộc",n=!1),n},E=async n=>{try{c.value=!0;const a=await Wa({page:n,size:$.value,search:K.value||null,trangThai:Y.value||null,ngayBatDau:A.value||null,ngayKetThuc:I.value||null});T.value=a.content.map(r=>({...r,trangThaiPhieuGiamGia:W(r.ngayBatDau,r.ngayKetThuc)})),ga.value=a.totalPages,ta.value=a.totalElements,S.value=n}catch(a){console.error(a.message||"Lỗi lấy danh sách phiếu giảm giá"),u.error(a.message||"Lỗi lấy danh sách phiếu giảm giá")}finally{c.value=!1}},pa=()=>{ma(),Q(),M.value=!0},fa=async()=>{if(!(await ea.fire({title:e.id?"Xác nhận cập nhật":"Xác nhận tạo mới",text:e.id?"Bạn có chắc muốn cập nhật phiếu giảm giá này?":"Bạn có chắc muốn tạo phiếu giảm giá này?",icon:"question",showCancelButton:!0,confirmButtonText:e.id?"Cập nhật":"Tạo mới",cancelButtonText:"Hủy"})).isConfirmed){u.info(e.id?"Đã hủy cập nhật":"Đã hủy tạo mới");return}if(!ha()){u.error("Vui lòng kiểm tra các lỗi trong form");return}try{c.value=!0;const a={...e,giaTriGiamGia:e.giaTriGiamGia.toString(),giaTriDonHangToiThieu:e.giaTriDonHangToiThieu.toString(),giaTriGiamGiaToiDa:e.loaiGiamGia==="Phần trăm"?e.giaTriGiamGiaToiDa.toString():e.giaTriGiamGia.toString(),soDiemCanDeDoi:e.soDiemCanDeDoi.toString(),ngayBatDau:na(e.ngayBatDau),ngayKetThuc:na(e.ngayKetThuc),trangThaiPhieuGiamGia:W(e.ngayBatDau,e.ngayKetThuc)};e.id?(await Za(e.id,a),u.success("Cập nhật giảm giá thành công!")):(await Ja(a),u.success("Tạo giảm giá thành công!")),M.value=!1,await E(S.value)}catch(a){console.error("Error saving phieu giam gia:",a),u.error((a==null?void 0:a.message)||"Đã xảy ra lỗi khi lưu phiếu giảm giá")}finally{c.value=!1}},ia=async n=>{if(!(await ea.fire({title:"Xác nhận tặng phiếu giảm giá",text:`Bạn có chắc muốn tặng phiếu giảm giá này mừng ${n==="BIRTHDAY"?"sinh nhật khách hàng":"khách hàng mới"}?`,icon:"question",showCancelButton:!0,confirmButtonText:"Tặng",cancelButtonText:"Hủy"})).isConfirmed){u.info("Đã hủy tặng phiếu giảm giá");return}try{if(c.value=!0,!m.id){u.error("Vui lòng tạo hoặc chọn phiếu giảm giá trước khi tặng");return}if(m.trangThaiPhieuGiamGia==="EXPIRED"){u.error("Phiếu giảm giá đã hết hạn");return}if(m.trangThaiPhatHanh!=="ISSUED"){u.error("Phiếu giảm giá chưa được phát hành");return}if(!["BIRTHDAY","NEW_CUSTOMER"].includes(n.toUpperCase())){u.error("Loại tặng phiếu không hợp lệ");return}const r=await ee(m.id,n);r.code===1?u.success(r.message):u.error(r.message)}catch(r){console.error("Error gifting phieu giam gia:",r),u.error(r.message||"Đã xảy ra lỗi khi tặng phiếu giảm giá")}finally{c.value=!1}},Ta=async n=>{var a,r;try{if(!(await ea.fire({title:"Xác nhận xóa giảm giá",text:"Bạn có chắc muốn xóa phiếu giảm giá này?",icon:"warning",showCancelButton:!0,confirmButtonText:"Xóa",cancelButtonText:"Hủy"})).isConfirmed){u.info("Đã hủy xóa");return}c.value=!0;const G=await ae(n);G.code===1?u.success(G.message):u.error(G.message),E(S.value)}catch(g){console.error("Error deleting phieu giam gia:",g),u.error(((r=(a=g.response)==null?void 0:a.data)==null?void 0:r.message)||"Đã xảy ra lỗi khi xóa giảm giá")}finally{c.value=!1}},Ga=async n=>{try{const a=await ca(n);Object.assign(e,a),_a(e.ngayBatDau),M.value=!0}catch(a){console.error(a.message||"Lỗi khi tải chi tiết giảm giá"),u.error(a.message||"Lỗi khi tải chi tiết giảm giá")}Q()},va=async n=>{try{const a=await ca(n);Object.assign(m,a),N.value=!0}catch(a){console.error(a.message||"Lỗi khi tải chi tiết giảm giá"),u.error(a.message||"Lỗi khi tải chi tiết giảm giá")}},ya=()=>{S.value=0,K.value="",Y.value=null,A.value=null,I.value=null,E(0)},Da=n=>{if(!n)return;let a=new Date(n);const r=new Date;if(a.getFullYear()===r.getFullYear()&&a.getMonth()===r.getMonth()&&a.getDate()===r.getDate()&&a.getHours()===r.getHours()&&a.getMinutes()===r.getMinutes()&&a.setMinutes(a.getMinutes()+1),e.ngayBatDau=q(a).format("YYYY-MM-DD HH:mm"),!e.id&&!e.ngayKetThuc){let g=new Date(a);g.setDate(a.getDate()+2),e.ngayKetThuc=q(g).format("YYYY-MM-DD HH:mm")}},_a=n=>{const a=q(),r=q(n);x.value=r.isBefore(a)||r.isSame(a,"day")},wa=n=>{$.value=n,E(0)};let R=null;const W=(n,a)=>{const r=new Date,g=new Date(n),G=new Date(a);return r<g?"NOT_STARTED":r>=g&&r<=G?"ACTIVE":"EXPIRED"},ba=()=>{T.value=T.value.map(n=>({...n,trangThaiPhieuGiamGia:W(n.ngayBatDau,n.ngayKetThuc)}))},ka={NOT_STARTED:"Chưa bắt đầu",ACTIVE:"Đang hoạt động",EXPIRED:"Đã hết hạn"},Va=n=>ka[n]||"Không xác định",Ca=n=>({NOT_STARTED:"info",ACTIVE:"success",EXPIRED:"danger"})[n]||"info",xa=({row:n,rowIndex:a})=>a%2===0?"even-row":"odd-row",Sa=n=>({activeValue:"ISSUED",inactiveValue:n==="ISSUED"?"STOP_ISSUED":"NOT_ISSUED",activeText:"Phát hành",inactiveText:""}),z=ra(()=>Sa(e.trangThaiPhatHanh)),O=n=>{if(!n)return"";const a=new Date(n),r=a.getDate().toString().padStart(2,"0"),g=(a.getMonth()+1).toString().padStart(2,"0"),G=a.getFullYear(),v=a.getHours().toString().padStart(2,"0"),B=a.getMinutes().toString().padStart(2,"0");return`${r}/${g}/${G} ${v}:${B}`},na=n=>{if(!n)return null;const a=new Date(n),r=b=>b<10?"0"+b:b,g=a.getFullYear(),G=r(a.getMonth()+1),v=r(a.getDate()),B=r(a.getHours()),H=r(a.getMinutes()),F=r(a.getSeconds());return`${g}-${G}-${v}T${B}:${H}:${F}`},X=n=>n==null?"0 ₫":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n),la=ra(()=>{const n=Aa.state.roles;return Array.isArray(n)&&n.map(a=>typeof a=="string"?a:a.authority).includes("ROLE_ADMIN")}),Ea=async()=>{try{const n=await te();return Math.max(1e3,n.data.delay||6e4)}catch(n){return n.name!=="AbortError"&&(console.error("Không thể lấy thời gian cập nhật:",n),u.error("Không thể lấy thời gian cập nhật")),6e4}};return Ia([K,Y,A,I],()=>{E(0)}),Ua(()=>{E(S.value);const n=Ea();R=setInterval(ba,n)}),$a(()=>{R&&(clearInterval(R),R=null)}),(n,a)=>{const r=p("el-icon"),g=p("el-button"),G=p("el-input"),v=p("el-option"),B=p("el-select"),H=p("el-date-picker"),F=p("el-card"),b=p("el-table-column"),J=p("el-tag"),Z=p("el-tooltip"),Ba=p("el-table"),Pa=p("el-pagination"),_=p("el-form-item"),U=p("el-input-number"),La=p("el-switch"),Ma=p("el-form"),sa=p("el-dialog"),Ha=Na("loading");return h(),y("div",ie,[t("div",ne,[t("div",le,[a[25]||(a[25]=t("div",{class:"title-section"},[t("h1",{class:"page-title"},"Quản lý giảm giá"),t("p",{class:"page-subtitle"},"Tạo và quản lý các chương trình giảm giá")],-1)),la.value?(h(),j(g,{key:0,type:"primary",size:"large",class:"create-btn",onClick:pa},{default:s(()=>[i(r,{class:"btn-icon"},{default:s(()=>[i(C(Ra))]),_:1}),a[24]||(a[24]=V(" Tạo giảm giá "))]),_:1})):D("",!0)])]),i(F,{class:"filters-card",shadow:"never"},{default:s(()=>[t("div",se,[t("div",oe,[t("div",re,[a[26]||(a[26]=t("label",{class:"filter-label"},"Tìm kiếm",-1)),i(G,{modelValue:K.value,"onUpdate:modelValue":a[0]||(a[0]=l=>K.value=l),placeholder:"Tìm kiếm theo mã hoặc tên...",clearable:"",class:"filter-input"},{prefix:s(()=>[i(r,{class:"search-icon"},{default:s(()=>[i(C(za))]),_:1})]),_:1},8,["modelValue"])]),t("div",ue,[a[27]||(a[27]=t("label",{class:"filter-label"},"Trạng thái",-1)),i(B,{modelValue:Y.value,"onUpdate:modelValue":a[1]||(a[1]=l=>Y.value=l),placeholder:"Chọn trạng thái",clearable:"",class:"filter-select"},{default:s(()=>[i(v,{label:"Tất cả",value:""}),i(v,{label:"Chưa bắt đầu",value:"NOT_STARTED"}),i(v,{label:"Đang hoạt động",value:"ACTIVE"}),i(v,{label:"Đã hết hạn",value:"EXPIRED"})]),_:1},8,["modelValue"])]),t("div",ce,[a[28]||(a[28]=t("label",{class:"filter-label"},"Ngày bắt đầu",-1)),i(H,{modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=l=>A.value=l),type:"date",placeholder:"Chọn ngày bắt đầu","value-format":"YYYY-MM-DD",clearable:"",class:"filter-date"},null,8,["modelValue"])]),t("div",de,[a[29]||(a[29]=t("label",{class:"filter-label"},"Ngày kết thúc",-1)),i(H,{modelValue:I.value,"onUpdate:modelValue":a[3]||(a[3]=l=>I.value=l),type:"date",placeholder:"Chọn ngày kết thúc","value-format":"YYYY-MM-DD",clearable:"",class:"filter-date"},null,8,["modelValue"])]),t("div",ge,[i(g,{onClick:ya,class:"reset-btn"},{default:s(()=>[i(r,null,{default:s(()=>[i(C(Oa))]),_:1}),a[30]||(a[30]=V(" Làm mới "))]),_:1})])])])]),_:1}),i(F,{class:"table-card",shadow:"never"},{default:s(()=>[Xa((h(),j(Ba,{data:T.value,class:"promotion-table","row-class-name":xa,"empty-text":"Không có dữ liệu"},{default:s(()=>[i(b,{label:"STT",width:"75",align:"center"},{default:s(l=>[t("span",me,d(l.$index+1+S.value*$.value),1)]),_:1}),i(b,{prop:"maGiamGia",label:"Mã giảm giá","min-width":"145"},{default:s(l=>[t("div",he,[i(J,{type:"info",size:"small",class:"code-tag"},{default:s(()=>[V(d(l.row.maGiamGia),1)]),_:2},1024)])]),_:1}),i(b,{prop:"tenGiamGia",label:"Tên giảm giá","min-width":"170"},{default:s(l=>[t("div",pe,[t("span",fe,d(l.row.tenGiamGia),1)])]),_:1}),i(b,{label:"Giá trị giảm",width:"140",align:"center"},{default:s(l=>[t("div",Te,[l.row.loaiGiamGia==="Phần trăm"?(h(),y("span",Ge,d(l.row.giaTriGiamGia)+"% ",1)):(h(),y("span",ve,d(X(l.row.giaTriGiamGia)),1))])]),_:1}),i(b,{label:"Thời gian",width:"180"},{default:s(l=>[t("div",ye,[t("div",De,[i(r,{class:"date-icon"},{default:s(()=>[i(C(ua))]),_:1}),t("span",null,d(O(l.row.ngayBatDau)),1)]),a[31]||(a[31]=t("div",{class:"date-separator"},"→",-1)),t("div",_e,[i(r,{class:"date-icon"},{default:s(()=>[i(C(ua))]),_:1}),t("span",null,d(O(l.row.ngayKetThuc)),1)])])]),_:1}),i(b,{prop:"soLuong",label:"Số lượng",width:"110",align:"center"},{default:s(l=>[i(J,{type:l.row.soLuong>0?"success":"danger",size:"small"},{default:s(()=>[V(d(l.row.soLuong),1)]),_:2},1032,["type"])]),_:1}),i(b,{label:"Trạng thái",width:"140",align:"center"},{default:s(l=>[i(J,{type:Ca(l.row.trangThaiPhieuGiamGia),size:"small"},{default:s(()=>[V(d(Va(l.row.trangThaiPhieuGiamGia)),1)]),_:2},1032,["type"])]),_:1}),la.value?(h(),j(b,{key:0,label:"Thao tác",width:"160",align:"center",fixed:"right"},{default:s(l=>[t("div",we,[i(Z,{content:"Xem chi tiết",placement:"top"},{default:s(()=>[i(g,{size:"small",type:"info",icon:C(Fa),circle:"",onClick:oa=>va(l.row.id),class:"action-btn detail-btn"},null,8,["icon","onClick"])]),_:2},1024),i(Z,{content:"Chỉnh sửa",placement:"top"},{default:s(()=>[i(g,{size:"small",type:"primary",icon:C(ja),circle:"",onClick:oa=>Ga(l.row.id),class:"action-btn edit-btn"},null,8,["icon","onClick"])]),_:2},1024),i(Z,{content:"Xóa",placement:"top"},{default:s(()=>[i(g,{size:"small",type:"danger",icon:C(qa),circle:"",onClick:oa=>Ta(l.row.id),class:"action-btn delete-btn"},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})):D("",!0)]),_:1},8,["data"])),[[Ha,c.value]]),t("div",be,[i(Pa,{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":S.value+1,"page-size":$.value,"page-sizes":[5,10,20,50],total:ta.value,onCurrentChange:a[4]||(a[4]=l=>E(l-1)),onSizeChange:wa,class:"custom-pagination"},null,8,["current-page","page-size","total"])])]),_:1}),i(sa,{modelValue:M.value,"onUpdate:modelValue":a[19]||(a[19]=l=>M.value=l),width:"800px",style:{"margin-top":"30px"},class:"promotion-dialog","close-on-click-modal":!1},{footer:s(()=>[t("div",Oe,[i(g,{onClick:a[18]||(a[18]=l=>M.value=!1),size:"large",class:"cancel-btn"},{default:s(()=>a[35]||(a[35]=[V(" Hủy ")])),_:1}),i(g,{type:"primary",onClick:fa,size:"large",class:"save-btn",loading:c.value},{default:s(()=>[V(d(e.id?"Cập nhật":"Tạo mới"),1)]),_:1},8,["loading"])])]),default:s(()=>[t("div",ke,[i(Ma,{model:e,"label-position":"top",class:"promotion-form"},{default:s(()=>[t("div",Ve,[t("div",Ce,[a[32]||(a[32]=t("h3",{class:"section-title"},"Thông tin cơ bản",-1)),t("div",xe,[i(_,{label:"Mã giảm giá",class:"form-item"},{default:s(()=>[i(G,{modelValue:e.maGiamGia,"onUpdate:modelValue":a[5]||(a[5]=l=>e.maGiamGia=l),placeholder:"Mã tự động",readonly:!!e.id,class:k({error:o.maGiamGia})},null,8,["modelValue","readonly","class"]),o.maGiamGia?(h(),y("span",Se,d(o.maGiamGia),1)):D("",!0)]),_:1}),i(_,{label:"Tên giảm giá *",class:"form-item"},{default:s(()=>[i(G,{modelValue:e.tenGiamGia,"onUpdate:modelValue":a[6]||(a[6]=l=>e.tenGiamGia=l),placeholder:"Nhập tên giảm giá",class:k({error:o.tenGiamGia})},null,8,["modelValue","class"]),o.tenGiamGia?(h(),y("span",Ee,d(o.tenGiamGia),1)):D("",!0)]),_:1})]),t("div",Be,[i(_,{label:"Loại giảm giá",class:"form-item"},{default:s(()=>[i(B,{modelValue:e.loaiGiamGia,"onUpdate:modelValue":a[7]||(a[7]=l=>e.loaiGiamGia=l),placeholder:"Chọn loại",class:k({"readonly-select":x.value})},{default:s(()=>[i(v,{value:"Phần trăm",label:"Phần trăm (%)"}),i(v,{value:"Cố định",label:"Số tiền cố định"})]),_:1},8,["modelValue","class"])]),_:1}),i(_,{label:"Giá trị giảm giá *",class:"form-item"},{default:s(()=>[i(U,{modelValue:e.giaTriGiamGia,"onUpdate:modelValue":a[8]||(a[8]=l=>e.giaTriGiamGia=l),min:0,max:e.loaiGiamGia==="Phần trăm"?60:99999999,step:e.loaiGiamGia==="Phần trăm"?1:5e3,placeholder:"0",class:k(["full-width",{error:o.giaTriGiamGia}]),readonly:x.value},null,8,["modelValue","max","step","readonly","class"]),o.giaTriGiamGia?(h(),y("span",Pe,d(o.giaTriGiamGia),1)):D("",!0)]),_:1}),i(_,{label:"Giá trị đơn hàng tối thiểu",class:"form-item"},{default:s(()=>[i(U,{modelValue:e.giaTriDonHangToiThieu,"onUpdate:modelValue":a[9]||(a[9]=l=>e.giaTriDonHangToiThieu=l),min:0,step:1e4,placeholder:"0",class:k(["full-width",{error:o.giaTriDonHangToiThieu}]),readonly:x.value},null,8,["modelValue","readonly","class"]),o.giaTriDonHangToiThieu?(h(),y("span",Le,d(o.giaTriDonHangToiThieu),1)):D("",!0)]),_:1}),e.loaiGiamGia==="Phần trăm"?(h(),j(_,{key:0,label:"Giá trị giảm giá tối đa",class:"form-item"},{default:s(()=>[i(U,{modelValue:e.giaTriGiamGiaToiDa,"onUpdate:modelValue":a[10]||(a[10]=l=>e.giaTriGiamGiaToiDa=l),min:0,step:5e3,placeholder:"0",class:k(["full-width",{error:o.giaTriGiamGiaToiDa}]),readonly:x.value},null,8,["modelValue","readonly","class"]),o.giaTriGiamGiaToiDa?(h(),y("span",Me,d(o.giaTriGiamGiaToiDa),1)):D("",!0)]),_:1})):D("",!0)])]),t("div",He,[a[33]||(a[33]=t("h3",{class:"section-title"},"Thời gian hiệu lực",-1)),t("div",Ke,[i(_,{label:"Thời gian bắt đầu *",class:"form-item"},{default:s(()=>[i(H,{modelValue:e.ngayBatDau,"onUpdate:modelValue":a[11]||(a[11]=l=>e.ngayBatDau=l),type:"datetime",placeholder:"Chọn thời gian bắt đầu",readonly:x.value,class:k(["full-width",{error:o.ngayBatDau}]),format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm","default-time":[new Date(2e3,1,1,0,0,0)],"show-seconds":!1,onChange:Da},null,8,["modelValue","readonly","default-time","class"]),o.ngayBatDau?(h(),y("span",Ye,d(o.ngayBatDau),1)):D("",!0)]),_:1}),i(_,{label:"Thời gian kết thúc *",class:"form-item"},{default:s(()=>[i(H,{modelValue:e.ngayKetThuc,"onUpdate:modelValue":a[12]||(a[12]=l=>e.ngayKetThuc=l),type:"datetime",placeholder:"Chọn thời gian kết thúc",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm","default-time":[new Date(2e3,1,1,0,0,0)],"show-seconds":!1,class:k(["full-width",{error:o.ngayKetThuc}])},null,8,["modelValue","default-time","class"]),o.ngayKetThuc?(h(),y("span",Ae,d(o.ngayKetThuc),1)):D("",!0)]),_:1})])]),t("div",Ie,[a[34]||(a[34]=t("h3",{class:"section-title"},"Cài đặt bổ sung",-1)),t("div",Ue,[i(_,{label:"Số lượng *",class:"form-item"},{default:s(()=>[i(U,{modelValue:e.soLuong,"onUpdate:modelValue":a[13]||(a[13]=l=>e.soLuong=l),min:1,placeholder:"1",class:k(["full-width",{error:o.soLuong}])},null,8,["modelValue","class"]),o.soLuong?(h(),y("span",$e,d(o.soLuong),1)):D("",!0)]),_:1}),i(_,{label:"Số điểm cần đổi",class:"form-item"},{default:s(()=>[i(U,{modelValue:e.soDiemCanDeDoi,"onUpdate:modelValue":a[14]||(a[14]=l=>e.soDiemCanDeDoi=l),min:0,placeholder:"0",class:k(["full-width",{error:o.soDiemCanDeDoi}]),readonly:x.value},null,8,["modelValue","readonly","class"]),o.soDiemCanDeDoi?(h(),y("span",Ne,d(o.soDiemCanDeDoi),1)):D("",!0)]),_:1})]),t("div",Re,[i(_,{label:"Hạng tối thiểu",class:"form-item"},{default:s(()=>[i(B,{modelValue:e.hangToiThieu,"onUpdate:modelValue":a[15]||(a[15]=l=>e.hangToiThieu=l),placeholder:"Chọn hạng"},{default:s(()=>[i(v,{value:"MEMBER",label:"Thành viên"}),i(v,{value:"SILVER",label:"Bạc"}),i(v,{value:"GOLD",label:"Vàng"}),i(v,{value:"DIAMOND",label:"Kim cương"})]),_:1},8,["modelValue"])]),_:1})]),i(_,{label:"Mô tả điều kiện áp dụng *",class:"form-item full-width"},{default:s(()=>[i(G,{modelValue:e.dieuKienApDung,"onUpdate:modelValue":a[16]||(a[16]=l=>e.dieuKienApDung=l),type:"textarea",rows:3,placeholder:"Nhập mô tả điều kiện áp dụng giảm giá...",class:k({error:o.dieuKienApDung})},null,8,["modelValue","class"]),o.dieuKienApDung?(h(),y("span",ze,d(o.dieuKienApDung),1)):D("",!0)]),_:1}),i(_,{label:"Trạng thái phát hành",class:"form-item"},{default:s(()=>[i(La,{modelValue:e.trangThaiPhatHanh,"onUpdate:modelValue":a[17]||(a[17]=l=>e.trangThaiPhatHanh=l),"active-value":z.value.activeValue,"inactive-value":z.value.inactiveValue,"active-text":z.value.activeText,"inactive-text":z.value.inactiveText,class:"status-switch"},null,8,["modelValue","active-value","inactive-value","active-text","inactive-text"])]),_:1})])])]),_:1},8,["model"])])]),_:1},8,["modelValue"]),i(sa,{modelValue:N.value,"onUpdate:modelValue":a[23]||(a[23]=l=>N.value=l),width:"800px",style:{"margin-top":"30px"},class:"promotion-detail-dialog","close-on-click-modal":!1},{footer:s(()=>[t("div",_t,[t("div",wt,[i(g,{type:"primary",onClick:a[20]||(a[20]=l=>ia("BIRTHDAY")),size:"large",class:"gift-btn",loading:c.value},{default:s(()=>[i(r,{class:"btn-icon"},{default:s(()=>[i(C(da))]),_:1}),a[52]||(a[52]=V(" Tặng sinh nhật "))]),_:1},8,["loading"]),i(g,{type:"primary",onClick:a[21]||(a[21]=l=>ia("NEW_CUSTOMER")),size:"large",class:"gift-btn",loading:c.value},{default:s(()=>[i(r,{class:"btn-icon"},{default:s(()=>[i(C(da))]),_:1}),a[53]||(a[53]=V(" Tặng khách hàng mới "))]),_:1},8,["loading"])]),t("div",bt,[i(g,{onClick:a[22]||(a[22]=l=>N.value=!1),size:"large",class:"cancel-btn"},{default:s(()=>a[54]||(a[54]=[V(" Đóng ")])),_:1})])])]),default:s(()=>[t("div",Xe,[t("div",Fe,[a[42]||(a[42]=t("h3",{class:"section-title"},"Thông tin cơ bản",-1)),t("div",je,[a[36]||(a[36]=t("span",{class:"detail-label"},"Mã giảm giá:",-1)),t("span",qe,d(m.maGiamGia||"Tự động"),1)]),t("div",Qe,[a[37]||(a[37]=t("span",{class:"detail-label"},"Tên giảm giá:",-1)),t("span",We,d(m.tenGiamGia),1)]),t("div",Je,[a[38]||(a[38]=t("span",{class:"detail-label"},"Loại giảm giá:",-1)),t("span",Ze,d(m.loaiGiamGia),1)]),t("div",at,[a[39]||(a[39]=t("span",{class:"detail-label"},"Giá trị giảm giá:",-1)),t("span",et,d(m.loaiGiamGia==="Phần trăm"?`${m.giaTriGiamGia}%`:X(m.giaTriGiamGia)),1)]),t("div",tt,[a[40]||(a[40]=t("span",{class:"detail-label"},"Giá trị đơn hàng tối thiểu:",-1)),t("span",it,d(X(m.giaTriDonHangToiThieu)),1)]),m.loaiGiamGia==="Phần trăm"?(h(),y("div",nt,[a[41]||(a[41]=t("span",{class:"detail-label"},"Giá trị giảm giá tối đa:",-1)),t("span",lt,d(X(m.giaTriGiamGiaToiDa)),1)])):D("",!0)]),t("div",st,[a[45]||(a[45]=t("h3",{class:"section-title"},"Thời gian hiệu lực",-1)),t("div",ot,[a[43]||(a[43]=t("span",{class:"detail-label"},"Thời gian bắt đầu:",-1)),t("span",rt,d(O(m.ngayBatDau)),1)]),t("div",ut,[a[44]||(a[44]=t("span",{class:"detail-label"},"Thời gian kết thúc:",-1)),t("span",ct,d(O(m.ngayKetThuc)),1)])]),t("div",dt,[a[51]||(a[51]=t("h3",{class:"section-title"},"Cài đặt bổ sung",-1)),t("div",gt,[a[46]||(a[46]=t("span",{class:"detail-label"},"Số lượng:",-1)),t("span",mt,d(m.soLuong),1)]),t("div",ht,[a[47]||(a[47]=t("span",{class:"detail-label"},"Số điểm cần đổi:",-1)),t("span",pt,d(m.soDiemCanDeDoi),1)]),t("div",ft,[a[48]||(a[48]=t("span",{class:"detail-label"},"Hạng tối thiểu:",-1)),t("span",Tt,d(m.hangToiThieu),1)]),t("div",Gt,[a[49]||(a[49]=t("span",{class:"detail-label"},"Điều kiện áp dụng:",-1)),t("span",vt,d(m.dieuKienApDung),1)]),t("div",yt,[a[50]||(a[50]=t("span",{class:"detail-label"},"Trạng thái phát hành:",-1)),t("span",Dt,d(m.trangThaiPhatHanh==="ISSUED"?"Phát hành":"Chưa phát hành"),1)])])])]),_:1},8,["modelValue"])])}}},St=Ka(kt,[["__scopeId","data-v-943186aa"]]);export{St as default};
