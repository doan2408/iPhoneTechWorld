import{a2 as W,a3 as Y,a4 as Z,a5 as ee}from"./ProductAdminService-BjtVeFMT.js";import{_ as te,u as ae,r as p,T as V,c as B,o as le,w as j,a as c,b as ne,d as oe,f as t,e as _,i as a,h as M,P as se,t as E,j as D,a6 as re,l as ue,R as F}from"./index-I05jmhuU.js";import{c as ce}from"./index-DUfPS_J0.js";const ie={class:"container mt-4"},me={class:"table-responsive mb-4",style:{"margin-top":"20px"}},de={class:"action-buttons-horizontal"},pe={class:"pagination-fixed"},fe={class:"d-flex justify-content-center align-items-center gap-3"},b=5,he={__name:"MauSacAdmin",setup(_e){const o=ae(),w=p([]),m=p(1),z=p(1),x=p(0),y=p(""),g=p(!1),v=p(!1),T=p(null),n=V({id:null,tenMau:"",maMau:"#409EFF"}),C=()=>{n.id=null,n.tenMau="",n.maMau="#409EFF",u.tenMau="",u.maMau=""},P=()=>{u.tenMau="",u.maMau=""},u=V({tenMau:"",maMau:""}),k=async()=>{try{const l=await W(m.value-1,b,y.value.trim());w.value=l.content,z.value=l.totalPages,x.value=l.totalElements}catch(l){console.error("Không thể load dữ liệu:",l)}},R=async()=>{if(!T.value)return;const l=v.value?"Bạn có chắc chắn muốn cập nhật RAM này?":"Bạn có chắc chắn muốn thêm mới RAM này?";try{await F.confirm(l,"Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Hủy",type:"warning"}),v.value?(await Z(n.id,n),o.success("Cập nhật màu sắc thành công!")):(await ee(n),o.success("Thêm mới màu sắc thành công!")),C(),g.value=!1,k()}catch(e){if(e&&e==="cancel"){o.info("Đã hủy thao tác");return}if(Object.keys(u).forEach(d=>u[d]=""),e.response){const{status:d,data:i}=e.response;if(d===400){const r=i.message;if(typeof r=="string")o.error(r);else if(typeof r=="object"){Object.keys(u).forEach(h=>{u[h]=r[h]||""});const f=Object.values(u).filter(Boolean);o.error(f.length?f.join(`
`):"Dữ liệu không hợp lệ!")}else o.error("Dữ liệu không hợp lệ!")}else d===409?o.error(i.message||"Dữ liệu đã tồn tại"):d>=500?o.error("Server lỗi, vui lòng thử lại sau"):o.error(i.message||"Đã xảy ra lỗi không xác định")}else e.request?o.error("Không nhận được phản hồi từ server"):o.error("Lỗi gửi request: "+e.message);console.error("Lỗi submitForm:",e)}},A=async l=>{try{await F.confirm("Bạn có chắc chắn muốn xoá màu này không?","Xác nhận xoá",{confirmButtonText:"Xoá",cancelButtonText:"Huỷ",type:"warning"}),await Y(l),o.success("Xoá thành công!"),k()}catch(e){e!=="cancel"&&o.error("Xoá thất bại! Vui lòng thử lại.")}};B(()=>x.value===0?0:(m.value-1)*b+1),B(()=>Math.min(m.value*b,x.value));const L=l=>{m.value=l};le(()=>{k()}),j([m,y],()=>{k()});const X=()=>{m.value=1},N=()=>{y.value="",m.value=1},O=()=>{C(),g.value=!0,v.value=!1},U=()=>{g.value=!1,C()},H=l=>{v.value=!0,Object.assign(n,l),g.value=!0,P()},q=l=>(m.value-1)*b+l+1;return j(()=>n.maMau,l=>{if(l)try{const e=ce(l).hex("rgba");n.maMau=e.toLowerCase(),console.log("11111111111111111111",l)}catch{console.warn("Mã màu không hợp lệ:",l)}}),(l,e)=>{const d=c("el-input"),i=c("el-col"),r=c("el-button"),f=c("el-row"),h=c("el-table-column"),I=c("el-table"),K=c("el-pagination"),S=c("el-form-item"),$=c("el-color-picker"),Q=c("el-form"),G=c("el-dialog");return oe(),ne("div",ie,[t(f,{gutter:20,class:"mb-4 justify-content-center"},{default:a(()=>[t(i,{span:6},{default:a(()=>[t(d,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),placeholder:"Tìm kiếm",clearable:""},null,8,["modelValue"])]),_:1}),t(i,{span:3},{default:a(()=>[t(r,{type:"primary",onClick:X,class:"w-100"},{default:a(()=>e[4]||(e[4]=[M("Tìm kiếm")])),_:1})]),_:1})]),_:1}),t(f,{gutter:20,class:"mb-2",justify:"end"},{default:a(()=>[t(i,{span:3},{default:a(()=>[t(r,{type:"primary",onClick:O,class:"w-100"},{default:a(()=>e[5]||(e[5]=[M("Tạo mới")])),_:1})]),_:1}),t(i,{span:3},{default:a(()=>[t(r,{type:"primary",onClick:N,class:"w-100"},{default:a(()=>e[6]||(e[6]=[M("Làm mới")])),_:1})]),_:1})]),_:1}),e[8]||(e[8]=_("h2",null,"Danh sách màu",-1)),_("div",me,[t(I,{data:w.value,border:"",style:{width:"100%"}},{default:a(()=>[t(h,{type:"index",index:q,label:"STT",width:"80"}),t(h,{prop:"tenMau",label:"Tên màu"}),t(h,{label:"Mã màu"},{default:a(({row:s})=>[_("div",{class:"color-display",style:se({backgroundColor:s.maMau})},null,4),_("span",null,E(s.maMau),1)]),_:1}),t(h,{label:"Thao tác",width:"180"},{default:a(({row:s})=>[_("div",de,[t(r,{size:"small",type:"primary",icon:D(re),circle:"",onClick:J=>H(s)},null,8,["icon","onClick"]),t(r,{size:"small",type:"danger",icon:D(ue),circle:"",onClick:J=>A(s.id)},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])]),_("div",pe,[_("div",fe,[t(K,{background:"",layout:"prev, pager, next","page-size":b,"current-page":m.value,total:x.value,"pager-count":7,"prev-text":"< Trước","next-text":"Sau >",onCurrentChange:L},null,8,["current-page","total"])])]),t(G,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),title:v.value?"Chỉnh sửa màu":"Thêm mới màu",width:"900px","close-on-click-modal":!1,"destroy-on-close":!0},{default:a(()=>[t(Q,{model:n,ref_key:"formRef",ref:T,"label-width":"140px","label-position":"left",class:"hdh-form"},{default:a(()=>[t(f,{gutter:20},{default:a(()=>[t(i,{span:12},{default:a(()=>[t(S,{label:"Tên màu",prop:"tenMau",error:u.tenMau},{default:a(()=>[t(d,{modelValue:n.tenMau,"onUpdate:modelValue":e[1]||(e[1]=s=>n.tenMau=s),placeholder:"Nhập tên màu...",autocomplete:"on"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),t(i,{span:12},{default:a(()=>[t(S,{label:"Mã màu",prop:"maMau",error:u.maMau},{default:a(()=>[t($,{modelValue:n.maMau,"onUpdate:modelValue":e[2]||(e[2]=s=>n.maMau=s),"show-alpha":""},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),t(f,{justify:"end",style:{"margin-top":"30px"}},{default:a(()=>[t(r,{onClick:U,style:{"margin-right":"10px"}},{default:a(()=>e[7]||(e[7]=[M("Hủy")])),_:1}),t(r,{type:"primary",onClick:R},{default:a(()=>[M(E(v.value?"Cập nhật":"Lưu"),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Me=te(he,[["__scopeId","data-v-9b401844"]]);export{Me as default};
