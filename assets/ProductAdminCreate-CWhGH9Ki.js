import{u as Ie,T as G,r as R,w as Ne,a as C,B as U,d as M,i as l,f as t,h as w,R as Y,_ as ze,ar as Ke,as as Je,L as We,at as Qe,au as Ye,l as Ze,av as $e,aw as en,ax as nn,M as an,ay as tn,az as ln,b as D,e as T,k as he,n as on,t as q,F as Q,m as $,y as sn,A as rn,c as Ve,a1 as Be,o as hn,aA as Te,G as ue,V as Ee}from"./index-BFtI-PwE.js";import{p as un,h as cn,i as mn,j as dn,k as gn,m as fn,n as pn,o as Cn}from"./ProductAdminService-Cqy2_DSd.js";import{r as vn,u as bn}from"./xlsx-Ca6gsgWq.js";import{c as yn}from"./index-DUfPS_J0.js";import{a as _n}from"./helpers.dataset-CZNISiCy.js";const Re={__name:"DialogThemMauSac",emits:["saved"],setup(ne,{expose:e,emit:B}){const n=Ie(),x=B,S=G({tenMau:"",maMau:""}),L=R(!1),V=R(null);function j(){L.value=!0}e({open:j});function E(){var p;(p=V.value)==null||p.resetFields(),S.tenMau="",S.maMau="",L.value=!1}async function k(){var p;(p=V.value)==null||p.validate(async m=>{if(m)try{await Y.confirm("Bạn có chắc chắn muốn thêm màu sắc này?","Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Huỷ",type:"warning"});const b=await un({tenMau:S.tenMau,maMau:S.maMau});x("saved",b),L.value=!1,E(),n.success("Thêm màu sắc thành công!")}catch(b){if(b==="cancel"||b==="close"){n.info("Đã hủy thao tác");return}if(console.error("Lỗi khi lưu màu sắc:",b),b.response&&b.response.data){const{message:_,error:f,errors:c}=b.response.data;if(c){const I=Object.values(c).flat().join(`
`);n.error(I)}else if(_&&typeof _=="object"){const I=Object.values(_).join(`
`);n.error(I)}else _?n.error(_):f?n.error(typeof f=="string"?f:JSON.stringify(f)):n.error("Dữ liệu không hợp lệ, vui lòng kiểm tra lại!")}else if(b.response){const _=b.response.status;_===401?n.error("Bạn không có quyền thực hiện hành động này!"):_===403?n.error("Bạn không có quyền truy cập tài nguyên này!"):n.error("Đã xảy ra lỗi, vui lòng thử lại!")}else n.error("Không thể kết nối đến server!")}})}return Ne(()=>S.maMau,p=>{if(p)try{const m=yn(p).hex("rgba");S.maMau=m.toLowerCase(),console.log("11111111111111111111",p)}catch{console.warn("Mã màu không hợp lệ:",p)}}),(p,m)=>{const b=C("el-input"),_=C("el-form-item"),f=C("el-color-picker"),c=C("el-form"),I=C("el-button"),y=C("el-dialog");return M(),U(y,{title:"Thêm màu sắc",modelValue:L.value,"onUpdate:modelValue":m[3]||(m[3]=X=>L.value=X),width:"600px",onClose:E,"destroy-on-close":""},{footer:l(()=>[t(I,{onClick:m[2]||(m[2]=X=>L.value=!1)},{default:l(()=>m[4]||(m[4]=[w("Hủy")])),_:1}),t(I,{type:"primary",onClick:k},{default:l(()=>m[5]||(m[5]=[w("Lưu")])),_:1})]),default:l(()=>[t(c,{model:S,ref_key:"formRef",ref:V,"label-position":"top",rules:p.rules},{default:l(()=>[t(_,{label:"Tên màu sắc",prop:"tenMau"},{default:l(()=>[t(b,{modelValue:S.tenMau,"onUpdate:modelValue":m[0]||(m[0]=X=>S.tenMau=X),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(_,{label:"Mã màu",prop:"maMau"},{default:l(()=>[t(f,{modelValue:S.maMau,"onUpdate:modelValue":m[1]||(m[1]=X=>S.maMau=X),"show-alpha":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}},Fe={__name:"DialogThemRom",emits:["saved"],setup(ne,{expose:e,emit:B}){const n=Ie(),x=B,S=G({dungLuong:""}),L=R(!1),V=R(null);function j(){L.value=!0}e({open:j});function E(){var p;(p=V.value)==null||p.resetFields(),S.dungLuong="",L.value=!1}async function k(){var p;(p=V.value)==null||p.validate(async m=>{if(m)try{await Y.confirm("Bạn có chắc chắn muốn thêm dung lượng rom này?","Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Huỷ",type:"warning"});const b=await cn({dungLuong:S.dungLuong});x("saved",b),L.value=!1,E(),n.success("Thêm dung lượng rom thành công!")}catch(b){if(b==="cancel"||b==="close"){n.info("Đã hủy thao tác");return}if(b.response&&b.response.data){const{message:_,error:f,errors:c}=b.response.data;if(c){const I=Object.values(c).flat().join(`
`);n.error(I)}else if(_&&typeof _=="object"){const I=Object.values(_).join(`
`);n.error(I)}else _?n.error(_):f?n.error(typeof f=="string"?f:JSON.stringify(f)):n.error("Dữ liệu không hợp lệ, vui lòng kiểm tra lại!")}else if(b.response){const _=b.response.status;_===401?n.error("Bạn không có quyền thực hiện hành động này!"):_===403?n.error("Bạn không có quyền truy cập tài nguyên này!"):n.error("Đã xảy ra lỗi, vui lòng thử lại!")}else n.error("Không thể kết nối đến server!")}})}return(p,m)=>{const b=C("el-input"),_=C("el-form-item"),f=C("el-form"),c=C("el-button"),I=C("el-dialog");return M(),U(I,{title:"Thêm dung lượng rom mới",modelValue:L.value,"onUpdate:modelValue":m[2]||(m[2]=y=>L.value=y),width:"600px",onClose:E,"destroy-on-close":""},{footer:l(()=>[t(c,{onClick:m[1]||(m[1]=y=>L.value=!1)},{default:l(()=>m[3]||(m[3]=[w("Hủy")])),_:1}),t(c,{type:"primary",onClick:k},{default:l(()=>m[4]||(m[4]=[w("Lưu")])),_:1})]),default:l(()=>[t(f,{model:S,ref_key:"formRef",ref:V,"label-position":"top"},{default:l(()=>[t(_,{label:"Dung lượng",prop:"dungLuong"},{default:l(()=>[t(b,{modelValue:S.dungLuong,"onUpdate:modelValue":m[0]||(m[0]=y=>S.dungLuong=y),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},Pe=Ie(),Tn={components:{Document:ln,Setting:tn,Picture:an,Money:nn,Upload:en,Check:$e,Delete:Ze,Tickets:Ye,InfoFilled:Qe,Plus:We,Box:Je,DialogThemMauSac:Re,DialogThemRom:Fe,Download:Ke},setup(){const ne=rn(),e=G({tenSanPham:"",thuongHieu:"Apple",idNhaCungCap:"",trangThaiSanPham:"",idModelSanPham:null,sanPhamChiTiets:[],idMau:null}),B=G({generate:!1,submit:!1}),n=R(null),x=R([]),S=R([]),L=R([]),V=R([]),j=R([]),E=R([]),k=R(null),p=G({}),m=G({}),b=R(null),_=R(null),f=G({tenSanPham:"",thuongHieu:"",idNhaCungCap:"",trangThaiSanPham:"",idModelSanPham:"",selectedMaus:"",selectedRoms:"",giaBanChung:"",ngayRaMat:""}),c=G([]),I=G({}),y=R(null),X=a=>{V.value.push({idMau:a.id,tenMau:a.tenMau,maMau:a.maMau}),x.value.push(a.idMau)},ce=a=>{j.value.push({idRom:a.id,dungLuong:a.dungLuong}),S.value.push(a.idRom)},z=G({visible:!1,message:"",type:"success",timeout:null}),ae=[{label:"Đang kinh doanh",value:"ACTIVE"},{label:"Ngừng kinh doanh",value:"DISCONTINUED"}],v=(a,i="success",r=3e3)=>{z.message=a,z.type=i,z.visible=!0,clearTimeout(z.timeout),z.timeout=setTimeout(()=>{z.visible=!1},r)},me=async()=>{const a=Te.service({text:"Đang tải danh mục...",background:"rgba(0, 0, 0, 0.7)"});try{const i=await Promise.all([mn(),dn(),gn(),fn()]);L.value=i[0],V.value=i[1],j.value=i[2],E.value=i[3];const s=[{name:"Nhà cung cấp",list:L.value},{name:"Màu sắc",list:V.value},{name:"ROM",list:j.value},{name:"Model sản phẩm",list:E.value}].filter(g=>!g.list.length);s.length&&v(`Không thể tải danh mục: ${s.map(g=>g.name).join(", ")}`,"error",3e3)}catch(i){v("Lỗi khi tải danh mục: "+i.message,"error",3e3)}finally{a.close()}},te=async()=>{try{await Y.confirm("Bạn có chắc chắn muốn tải template IMEI sản phẩm không?","Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Hủy",type:"warning"});const a=await pn();if(a.status!==200)throw new Error("Không thể tải template");const i=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=i,r.setAttribute("download","ImeiSanPhamTemplate.xlsx"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i),Pe.success("Tải template thành công!")}catch(a){a==="cancel"?Pe.info("Bạn đã hủy tải template"):(console.error("Lỗi khi tải template:",a),Pe.error("Không thể tải template, vui lòng thử lại!"))}},de=()=>{f.idModelSanPham="",f.tenSanPham="";const a=E.value.find(i=>i.idModelSanPham===e.idModelSanPham);a?e.tenSanPham=a.tenModel:e.tenSanPham="",ue(()=>{ie()})},J=()=>{v("Chỉ được tải lên tối đa 5 ảnh cho mỗi màu!","warning",3e3)},ge=async()=>{B.generate=!0;let a=!1;const i=[];if(console.log("Starting generateVariants",{sanPham:e,selectedMaus:x.value,selectedRoms:S.value,hinhAnhTheoMau:p}),x.value.length||(f.selectedMaus="Vui lòng chọn ít nhất một màu sắc",i.push("Chọn ít nhất một màu sắc"),a=!0),S.value.length||(f.selectedRoms="Vui lòng chọn ít nhất một ROM",i.push("Chọn ít nhất một ROM"),a=!0),a){B.generate=!1,await ue(),v(i.join("; "),"error",5e3),ie();return}Object.keys(p).forEach(h=>{x.value.includes(Number(h))||delete p[h]}),Object.keys(I).forEach(h=>{x.value.includes(Number(h))||delete I[h]});const r=new Set,s=[];c.length=0,x.value.forEach(h=>{S.value.forEach(u=>{const P=`${h}-${u}`;if(!r.has(P)){r.add(P);const d=e.sanPhamChiTiets.find(H=>H.idMau===h&&H.idRom===u);s.push({id:(d==null?void 0:d.id)||null,idMau:h,idRom:u,soLuong:(d==null?void 0:d.soLuong)||0,giaBan:y.value||(d==null?void 0:d.giaBan)||null,imeisInput:(d==null?void 0:d.imeisInput)||"",isFileUploaded:(d==null?void 0:d.isFileUploaded)||!1,imeis:(d==null?void 0:d.imeis)||[],hinhAnhs:p[h]||[]}),c.push({giaBan:"",soLuong:"",imeisInput:""})}})});const g=[];for(const h of s)try{const u=new AbortController,P=setTimeout(()=>u.abort(),5e3),d=await Ee.get("/admin/sanPhamChiTiet/check-duplicate-variant",{params:{idSp:e.idModelSanPham,idMau:h.idMau,idRom:h.idRom,idLoai:e.idModelSanPham},signal:u.signal});clearTimeout(P),d.data.exists&&g.push(`${ke(h.idMau)} - ${we(h.idRom)}`)}catch(u){console.error("Lỗi kiểm tra biến thể từ backend:",u),u.name==="AbortError"?v("Yêu cầu kiểm tra biến thể quá thời gian, vui lòng thử lại.","error",3e3):v("Lỗi kiểm tra trùng biến thể từ hệ thống: "+u.message,"error",3e3),B.generate=!1;return}if(g.length>0){v(`Không thể tạo các biến thể đã tồn tại: ${g.join(", ")}`,"error",2e3),B.generate=!1;return}e.sanPhamChiTiets=s,e.sanPhamChiTiets.forEach((h,u)=>{h.giaBan?K[u]=h.giaBan.toLocaleString("vi-VN"):K[u]=""}),e.sanPhamChiTiets.forEach((h,u)=>{o(u,!0)}),k.value=e.sanPhamChiTiets.length>0?0:null,setTimeout(()=>{const h=document.querySelector(".variant-table");h&&h.scrollIntoView({behavior:"smooth"})},100),B.generate=!1,v(`Đã tạo ${e.sanPhamChiTiets.length} biến thể sản phẩm`,"success",3e3)},K=G({}),fe=(a,i)=>{const r=a.replace(/[^\d]/g,"");if(r===""){K[i]="",e.sanPhamChiTiets[i].giaBan=null;return}const s=parseInt(r,10);K[i]=s.toLocaleString("vi-VN"),e.sanPhamChiTiets[i].giaBan=s,c[i]&&(c[i].giaBan="")},Z=R(""),pe=a=>{const i=a.replace(/[^\d]/g,"");if(i===""){Z.value="",y.value=null;return}const r=parseInt(i,10);Z.value=r.toLocaleString("vi-VN"),y.value=r,f.giaBanChung=""},Ce=()=>{y.value&&y.value<1e3?f.giaBanChung="Giá bán phải lớn hơn hoặc bằng 1.000 VND":y.value&&y.value>1e8?f.giaBanChung="Giá bán không được vượt quá 100.000.000 VND":f.giaBanChung=""};Ne(y,a=>{a==null||a===""?Z.value="":Z.value=a.toLocaleString("vi-VN")});const ve=()=>{if(!e.sanPhamChiTiets.length){v("Vui lòng tạo biến thể trước!","error",3e3);return}if(!y.value||y.value<1e3){f.giaBanChung="Giá bán chung phải lớn hơn hoặc bằng 1.000 VND",v("Vui lòng nhập giá bán chung hợp lệ!","error",3e3);return}if(y.value>1e8){f.giaBanChung="Giá bán không được vượt quá 100.000.000 VND",v("Giá bán quá cao!","error",3e3);return}Y.confirm(`Áp dụng giá ${y.value.toLocaleString("vi-VN")} VND cho tất cả biến thể?`,"Xác nhận",{confirmButtonText:"Áp dụng",cancelButtonText:"Hủy",type:"warning"}).then(()=>{be()}).catch(()=>{v("Đã hủy áp dụng giá chung.","info",3e3)})},be=()=>{e.sanPhamChiTiets.forEach((a,i)=>{a.giaBan=y.value,c[i].giaBan="",K[i]=y.value.toLocaleString("vi-VN")}),v("Đã áp dụng giá bán chung!","success",3e3)},o=(a,i=!1)=>{const r=()=>{const s=e.sanPhamChiTiets[a].isFileUploaded?e.sanPhamChiTiets[a].imeis:e.sanPhamChiTiets[a].imeisInput.split(",").map(g=>g.trim()).filter(g=>g);if(e.sanPhamChiTiets[a].soLuong=s.length,i)if(s.length===0)c[a].imeisInput="Phải có ít nhất 1 IMEI",c[a].soLuong="Số lượng phải lớn hơn 0";else{const g=e.sanPhamChiTiets.flatMap((u,P)=>P!==a?u.isFileUploaded?u.imeis:u.imeisInput.split(",").map(d=>d.trim()).filter(d=>d):[]),h=s.filter(u=>g.includes(u));if(h.length>0)c[a].imeisInput=`${h.length} IMEI trùng lặp: ${h.slice(0,3).join(", ")}${h.length>3?"...":""}`,c[a].soLuong="";else{const u=s.filter(P=>!/^\d{15}$/.test(P));u.length>0?(c[a].imeisInput=`${u.length} IMEI không hợp lệ: ${u.slice(0,3).join(", ")}${u.length>3?"...":""}`,c[a].soLuong=""):(c[a].imeisInput="Hợp lệ",c[a].soLuong="")}}else c[a].imeisInput="",c[a].soLuong=""};i?_n(r,150)():r()},F=a=>{e.sanPhamChiTiets[a].isFileUploaded=!1,o(a,!0),m[a]=[]},A=a=>{m[a]=[],ue(()=>{const i=document.querySelector(`.el-upload[ref="upload-${a}"]`);i&&i.__vue__&&i.__vue__.clearFiles()})},O=a=>{Y.confirm("Bạn có chắc muốn xóa toàn bộ IMEI của biến thể này?","Xác nhận",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}).then(()=>{le(a)}).catch(()=>{v("Đã hủy xóa IMEI.","info",3e3)})},le=a=>{e.sanPhamChiTiets[a].imeisInput="",e.sanPhamChiTiets[a].soLuong=0,e.sanPhamChiTiets[a].isFileUploaded=!1,e.sanPhamChiTiets[a].imeis=[],c[a].imeisInput="",c[a].soLuong="",A(a),v("Đã xóa danh sách IMEI!","success",3e3)},W=(a,i,r)=>{m[i]=r,a.raw.size>1024*1024?(v("File quá lớn, vui lòng chọn file dưới 1MB","error",3e3),m[i]=[]):["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(a.raw.type)||(v("Vui lòng chọn file .xlsx hoặc .xls","error",3e3),m[i]=[])},ye=a=>{if(k.value===null||k.value!==a){v("Vui lòng chọn biến thể trước khi tải file IMEI!","error",3e3);return}if(!m[a]||m[a].length===0){v("Vui lòng chọn file trước khi upload!","error",3e3);return}Y.confirm(`Bạn có chắc muốn upload file "${m[a][0].name}" cho biến thể ${a+1}?`,"Xác nhận",{confirmButtonText:"Upload",cancelButtonText:"Hủy",type:"warning"}).then(()=>{Me(a)}).catch(()=>{v("Đã hủy upload file.","info",3e3)})},Me=async a=>{const i=m[a][0],r=Te.service({text:"Đang đọc file Excel...",background:"rgba(0, 0, 0, 0.7)"});try{const s=new FileReader;s.onload=g=>{try{const h=new Uint8Array(g.target.result),u=vn(h,{type:"array"}),P=u.Sheets[u.SheetNames[0]],d=bn.sheet_to_json(P,{header:1}),H=d[0];if(H&&H[0]!=="soImei")throw new Error("Cột đầu tiên phải có tiêu đề 'soImei'. Vui lòng sửa file Excel và thử lại.");const oe=d.slice(1).map(N=>String(N[0]).trim()).filter(N=>N),se=oe.filter(N=>!/^\d{15}$/.test(N));if(se.length>0)throw new Error(`Có ${se.length} giá trị không hợp lệ: ${se.slice(0,3).join(", ")}${se.length>3?"...":""}. IMEI phải là số 15 chữ số. Vui lòng kiểm tra và sửa file.`);const ee=oe.filter(N=>/^\d{15}$/.test(N));if(ee.length===0)throw new Error("Không tìm thấy IMEI hợp lệ trong file. Vui lòng đảm bảo cột 'soImei' chứa số 15 chữ số và không có hàng trống.");const Ge=e.sanPhamChiTiets.flatMap((N,Xe)=>Xe!==a?N.isFileUploaded?N.imeis:N.imeisInput.split(",").map(_e=>_e.trim()).filter(_e=>_e):[]),re=ee.filter(N=>Ge.includes(N));if(re.length>0)throw new Error(`${re.length} IMEI trùng lặp: ${re.slice(0,3).join(", ")}${re.length>3?"...":""}. Vui lòng kiểm tra và loại bỏ IMEI trùng.`);e.sanPhamChiTiets[a].soLuong=ee.length,e.sanPhamChiTiets[a].isFileUploaded=!0,e.sanPhamChiTiets[a].imeis=ee,e.sanPhamChiTiets[a].imeisInput=ee.join(", "),c[a].imeisInput="Hợp lệ",c[a].soLuong="",m[a]=[],v(`Đã nhập ${ee.length} IMEI từ file ${i.name} cho biến thể ${a+1}`,"success",3e3)}catch(h){c[a].imeisInput=h.message,v(`Lỗi khi đọc file Excel: ${h.message} Vui lòng kiểm tra định dạng file (cột 'soImei', số 15 chữ số) và thử lại.`,"error",7e3)}finally{r.close()}},s.onerror=()=>{c[a].imeisInput="Lỗi khi đọc file Excel. Vui lòng chọn file hợp lệ (.xlsx hoặc .xls) và thử lại.",v("Lỗi khi đọc file Excel. Vui lòng chọn file hợp lệ (.xlsx hoặc .xls) và thử lại.","error",3e3),r.close()},s.readAsArrayBuffer(i.raw)}catch(s){c[a].imeisInput="Lỗi khi xử lý file IMEI: "+s.message+". Vui lòng thử lại với file đúng định dạng.",v("Lỗi khi xử lý file IMEI: "+s.message+". Vui lòng thử lại với file đúng định dạng.","error",3e3),r.close()}},De=async(a,i,r)=>{var g,h;const s=Te.service({target:`.el-upload[mau-id="${r}"]`,text:"Đang tải ảnh..."});try{if(!["image/jpeg","image/png","image/webp"].includes(a.raw.type))throw new Error("Chỉ chấp nhận file JPEG, PNG hoặc WEBP");if(a.raw.size>5*1024*1024)throw new Error("Kích thước ảnh không được vượt quá 5MB");const u=new FormData;u.append("file",a.raw);const P=await Ee.post("http://localhost:8080/admin/hinhAnh/upload",u,{headers:{"Content-Type":"multipart/form-data"}});p[r]||(p[r]=[]),p[r]=i.map(d=>({name:d.name,url:d.uid===a.uid?P.data.url:d.url,imagePublicId:d.uid===a.uid?P.data.imagePublicId:d.imagePublicId})),v(`Tải ảnh ${a.name} thành công!`,"success",3e3)}catch(u){I[r]="Lỗi khi tải ảnh: "+(((h=(g=u.response)==null?void 0:g.data)==null?void 0:h.message)||u.message),v(I[r],"error",3e3)}finally{s.close()}},xe=(a,i,r)=>{p[r]=i.map(s=>({name:s.name,url:s.url,imagePublicId:s.imagePublicId})),v(`Đã xóa ảnh ${a.name}`,"success",3e3)},Ue=a=>{Y.confirm("Bạn có chắc muốn xóa biến thể này?","Xác nhận",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"}).then(()=>{Se(a)}).catch(()=>{v("Đã hủy xóa biến thể.","info",3e3)})},Se=a=>{e.sanPhamChiTiets.splice(a,1),c.splice(a,1),delete m[a],k.value===a?k.value=e.sanPhamChiTiets.length>0?0:null:k.value>a&&k.value--,v("Đã xóa biến thể!","success",3e3)},je=(a,i,r)=>{const s=e.sanPhamChiTiets.indexOf(a);k.value=s,c[s]&&(Object.keys(c[s]).forEach(g=>c[s][g]=""),o(s,!0)),e.sanPhamChiTiets[s].isFileUploaded&&e.sanPhamChiTiets[s].imeis?e.sanPhamChiTiets[s].imeisInput=e.sanPhamChiTiets[s].imeis.join(", "):e.sanPhamChiTiets[s].imeisInput||(e.sanPhamChiTiets[s].imeisInput="",e.sanPhamChiTiets[s].isFileUploaded=!1,e.sanPhamChiTiets[s].imeis=[]),m[s]=m[s]||[],e.sanPhamChiTiets[s].isFileUploaded||(m[s]=[]),ue(()=>{A(s)})},ke=a=>(Array.isArray(a)||(a=[a]),a.map(i=>{var r;return((r=V.value.find(s=>String(s.id)===String(i)))==null?void 0:r.tenMau)||"Không xác định"}).join(", ")),we=a=>(Array.isArray(a)||(a=[a]),a.map(i=>{var r;return((r=j.value.find(s=>String(s.id)===String(i)))==null?void 0:r.dungLuong)||"Không xác định"}).join(", ")),ie=()=>{setTimeout(()=>{var i,r;let a=(i=document.querySelector(".el-form-item__error"))==null?void 0:i.closest(".el-form-item");if(!a){const s=Object.keys(I).find(g=>I[g]);s&&(a=(r=document.querySelector(`[mau-id="${s}"]`))==null?void 0:r.closest(".el-form-item"))}if(!a){const s=c.findIndex(g=>Object.values(g).some(h=>h));s!==-1&&(a=document.querySelector(".variant-table"),k.value=s)}a&&a.scrollIntoView({behavior:"smooth",block:"center"})},100)},Ae=()=>{let a=!1;return!e.idModelSanPham||!e.tenSanPham?(f.tenSanPham="Vui lòng chọn model sản phẩm hoặc nhập tên sản phẩm",a=!0):f.tenSanPham="",e.thuongHieu||(f.thuongHieu="Vui lòng nhập thương hiệu",a=!0),e.idNhaCungCap||(f.idNhaCungCap="Vui lòng chọn nhà cung cấp",a=!0),e.trangThaiSanPham||(f.trangThaiSanPham="Vui lòng chọn trạng thái",a=!0),e.idModelSanPham||(f.idModelSanPham="Vui lòng chọn model sản phẩm",a=!0),e.sanPhamChiTiets.forEach((i,r)=>{(!i.giaBan||i.giaBan<1e3)&&(c[r].giaBan="Giá bán phải ≥ 1000 VND",a=!0),i.soLuong||(c[r].soLuong="Số lượng phải lớn hơn 0",a=!0);const s=i.isFileUploaded?i.imeis:i.imeisInput.split(",").map(g=>g.trim()).filter(g=>g);if(s.length===0)c[r].imeisInput="Phải có ít nhất 1 IMEI",a=!0;else{const g=e.sanPhamChiTiets.flatMap((u,P)=>P!==r?u.isFileUploaded?u.imeis:u.imeisInput.split(",").map(d=>d.trim()).filter(d=>d):[]),h=s.filter(u=>g.includes(u));if(h.length>0)c[r].imeisInput=`${h.length} IMEI trùng lặp: ${h.slice(0,3).join(", ")}${h.length>3?"...":""}`,a=!0;else{const u=s.filter(P=>!/^\d{15}$/.test(P));u.length>0&&(c[r].imeisInput=`${u.length} IMEI không hợp lệ: ${u.slice(0,3).join(", ")}${u.length>3?"...":""}`,a=!0)}}}),!a},Oe=async()=>{if(B.submit=!0,!e.sanPhamChiTiets.length){v("Vui lòng tạo ít nhất một biến thể sản phẩm!","error",3e3),B.submit=!1;return}Y.confirm("Bạn có chắc muốn lưu sản phẩm này?","Xác nhận",{confirmButtonText:"Lưu",cancelButtonText:"Hủy",type:"warning"}).then(()=>{Le()}).catch(()=>{B.submit=!1,v("Đã hủy lưu sản phẩm.","info",3e3)})},Le=async()=>{var a;try{if(!Ae()){const r=c.findIndex(s=>Object.values(s).some(g=>g));r!==-1&&(k.value=r),v("Vui lòng nhập đầy đủ thông tin","error",5e3),ie(),B.submit=!1;return}const i={tenSanPham:e.tenSanPham,thuongHieu:e.thuongHieu,idNhaCungCaps:[e.idNhaCungCap],trangThaiSanPham:e.trangThaiSanPham,ngayRaMat:e.ngayRaMat,idModelSanPham:e.idModelSanPham,sanPhamChiTiets:e.sanPhamChiTiets.map(r=>{const s=r.isFileUploaded?r.imeis:r.imeisInput.split(",").map(g=>g.trim()).filter(g=>g);return{idMau:r.idMau,idRom:r.idRom,soLuong:r.soLuong,giaBan:r.giaBan,imeis:s.map(g=>({soImei:g})),hinhAnhs:r.hinhAnhs.map(g=>({url:g.url,imagePublicId:g.imagePublicId}))}})};await Cn(i),v("Sản phẩm đã được lưu thành công!","success",3e3),ne.push({name:"products"})}catch(i){if(console.error("Lỗi khi lưu sản phẩm:",i),((a=i.response)==null?void 0:a.status)===400){const r=i.response.data.message;Object.keys(f).forEach(h=>f[h]=""),c.forEach((h,u)=>{Object.keys(h).forEach(P=>h[P]="")}),Object.keys(I).forEach(h=>I[h]="");let s=[];Array.isArray(r)?r.forEach(h=>{const u=h.field,P=h.error;if(u.startsWith("sanPhamChiTiets[")){const d=u.match(/sanPhamChiTiets\[(\d+)\]\.(.+)/);if(d){const H=parseInt(d[1]),oe=d[2]==="imeis"?"imeisInput":d[2];H<c.length&&(c[H][oe]=P,s.push(`Biến thể ${H+1}: ${P}`))}}else f[u]=P,s.push(P)}):typeof r=="object"?Object.entries(r).forEach(([h,u])=>{if(h.startsWith("sanPhamChiTiets[")){const P=h.match(/sanPhamChiTiets\[(\d+)\]\.(.+)/);if(P){const d=parseInt(P[1]),H=P[2]==="imeis"?"imeisInput":P[2];d<c.length&&(c[d][H]=u,s.push(`Biến thể ${d+1}: ${u}`))}}else f[h]=u,s.push(u)}):s.push(r||"Lỗi xác thực không xác định");const g=c.findIndex(h=>Object.values(h).some(u=>u));g!==-1&&(k.value=g),v(`Lỗi xác thực: ${s.join("; ")}`,"error",5e3),ie()}else v("Lỗi hệ thống: "+(i.message||"Vui lòng thử lại"),"error",3e3)}finally{B.submit=!1}},He=Ve(()=>{const a=Be.state.roles;return Array.isArray(a)&&a.map(i=>typeof i=="string"?i:i.authority).includes("ROLE_ADMIN")}),qe=Ve(()=>{const a=Be.state.roles;return Array.isArray(a)&&a.map(i=>typeof i=="string"?i:i.authority).includes("ROLE_STAFF")});return hn(()=>{me()}),{isAdmin:He,isStaff:qe,sanPham:e,sanPhamForm:n,nhaCungCaps:L,maus:V,roms:j,modelSanPhams:E,selectedChiTiet:k,selectedMaus:x,selectedRoms:S,danhSachTrangThaiSanPham:ae,errors:f,errorsChiTiet:c,errorsMauHinhAnh:I,hinhAnhTheoMau:p,giaBanChung:y,loading:B,DialogThemMauSac:Re,DialogThemRom:Fe,addMauSacDialogRef:b,addRomDialogRef:_,variantPriceFormatted:K,handleVariantPriceInput:fe,giaBanChungFormatted:Z,handlePriceInput:pe,validatePrice:Ce,handleMauSacSaved:X,handleDungLuongRomSaved:ce,generateVariants:ge,confirmApplyGiaBanChung:ve,removeChiTiet:Se,confirmRemoveChiTiet:Ue,selectChiTiet:je,getMauSacLabels:ke,getRomLabels:we,handleMauFileChange:De,handleMauFileRemove:xe,submitForm:Le,confirmSubmitForm:Oe,capNhatSoLuong:o,handleImeiInput:F,onModelChange:de,handleExceed:J,clearImeiInput:le,confirmClearImeiInput:O,clearUploadFiles:A,imeiFileList:m,handleFileSelection:W,uploadImeiFile:Me,confirmUploadImeiFile:ye,router:ne,notification:z,showNotification:v,downloadTemplate:te}}},Pn={class:"page-header"},In={class:"header-container"},Mn={class:"header-left"},Sn={class:"header-icon"},kn={class:"card-header"},wn={class:"card-header"},Ln={style:{display:"flex",gap:"8px",width:"100%"}},Vn={style:{display:"flex",gap:"8px",width:"100%"}},Bn={class:"card-header"},En={class:"card-header"},Rn={class:"card-header"},Fn={key:0},Nn={key:1},Dn={class:"card-header"},xn={class:"imei-upload-container"},Un={key:0,class:"file-name"},jn={key:1,class:"file-placeholder"},An={class:"imei-status"},On={class:"valid-message"},Hn={class:"empty-state"},qn={class:"form-actions"};function Gn(ne,e,B,n,x,S){const L=C("Box"),V=C("el-icon"),j=C("Document"),E=C("el-option"),k=C("el-select"),p=C("el-form-item"),m=C("el-input"),b=C("el-col"),_=C("el-row"),f=C("el-card"),c=C("Setting"),I=C("Plus"),y=C("el-button"),X=C("DialogThemMauSac"),ce=C("DialogThemRom"),z=C("Picture"),ae=C("Upload"),v=C("el-upload"),me=C("Money"),te=C("Check"),de=C("Tickets"),J=C("el-table-column"),ge=C("el-image"),K=C("Delete"),fe=C("el-table"),Z=C("el-input-number"),pe=C("el-tooltip"),Ce=C("InfoFilled"),ve=C("Download"),be=C("el-form");return M(),D(Q,null,[T("div",Pn,[T("div",In,[T("div",Mn,[T("div",Sn,[t(V,{size:"32",color:"#409EFF"},{default:l(()=>[t(L)]),_:1})]),e[25]||(e[25]=T("div",{class:"header-info"},[T("h1",{class:"header-title"},"Quản lý sản phẩm"),T("p",{class:"header-subtitle"},"Thêm sản phẩm mới vào hệ thống")],-1))])])]),n.notification.visible?(M(),D("div",{key:0,class:on(["custom-notification",`notification-${n.notification.type}`])},q(n.notification.message),3)):he("",!0),t(be,{model:n.sanPham,ref:"sanPhamForm","label-width":"140px",class:"product-form"},{default:l(()=>[t(f,{shadow:"hover",class:"section-card"},{header:l(()=>[T("div",kn,[T("span",null,[t(j,{class:"el-icon"}),e[26]||(e[26]=w(" Thông tin sản phẩm "))])])]),default:l(()=>[t(p,{label:"Model sản phẩm",prop:"idModelSanPham",error:n.errors.idModelSanPham},{default:l(()=>[t(k,{modelValue:n.sanPham.idModelSanPham,"onUpdate:modelValue":e[0]||(e[0]=o=>n.sanPham.idModelSanPham=o),placeholder:"Chọn model sản phẩm",clearable:"",filterable:"",onChange:n.onModelChange,style:{width:"100%"}},{default:l(()=>[(M(!0),D(Q,null,$(n.modelSanPhams,o=>(M(),U(E,{key:o.idModelSanPham,label:`${o.tenModel} - ${o.maXuatXu}`,value:o.idModelSanPham},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1},8,["error"]),t(_,{gutter:20},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{label:"Tên sản phẩm",prop:"tenSanPham",error:n.errors.tenSanPham},{default:l(()=>[t(m,{modelValue:n.sanPham.tenSanPham,"onUpdate:modelValue":e[1]||(e[1]=o=>n.sanPham.tenSanPham=o),placeholder:"Nhập tên sản phẩm",clearable:"",onInput:e[2]||(e[2]=o=>n.errors.tenSanPham="")},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{label:"Thương hiệu",prop:"thuongHieu",error:n.errors.thuongHieu},{default:l(()=>[t(m,{modelValue:n.sanPham.thuongHieu,"onUpdate:modelValue":e[3]||(e[3]=o=>n.sanPham.thuongHieu=o),placeholder:"Nhập thương hiệu",clearable:"",onInput:e[4]||(e[4]=o=>n.errors.thuongHieu="")},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),t(_,{gutter:20},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{label:"Nhà cung cấp",prop:"idNhaCungCap",error:n.errors.idNhaCungCap},{default:l(()=>[t(k,{modelValue:n.sanPham.idNhaCungCap,"onUpdate:modelValue":e[5]||(e[5]=o=>n.sanPham.idNhaCungCap=o),placeholder:"Chọn nhà cung cấp",clearable:"",filterable:"",onChange:e[6]||(e[6]=o=>n.errors.idNhaCungCap=""),style:{width:"100%"}},{default:l(()=>[(M(!0),D(Q,null,$(n.nhaCungCaps,o=>(M(),U(E,{key:o.id,label:o.tenNhaCungCap,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"])]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{label:"Trạng thái",prop:"trangThaiSanPham",error:n.errors.trangThaiSanPham},{default:l(()=>[t(k,{modelValue:n.sanPham.trangThaiSanPham,"onUpdate:modelValue":e[7]||(e[7]=o=>n.sanPham.trangThaiSanPham=o),placeholder:"Chọn trạng thái",clearable:"",onChange:e[8]||(e[8]=o=>n.errors.trangThaiSanPham=""),style:{width:"100%"}},{default:l(()=>[(M(!0),D(Q,null,$(n.danhSachTrangThaiSanPham,o=>(M(),U(E,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1})]),_:1}),t(f,{shadow:"hover",class:"section-card"},{header:l(()=>[T("div",wn,[T("span",null,[t(c,{class:"el-icon"}),e[27]||(e[27]=w(" Tạo biến thể sản phẩm "))])])]),default:l(()=>[t(_,{gutter:20},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{label:"Màu sắc",prop:"selectedMaus",error:n.errors.selectedMaus},{default:l(()=>[T("div",Ln,[t(k,{modelValue:n.selectedMaus,"onUpdate:modelValue":e[9]||(e[9]=o=>n.selectedMaus=o),multiple:"",placeholder:"Chọn màu sắc",clearable:"",onChange:e[10]||(e[10]=o=>n.errors.selectedMaus=""),style:{width:"100%"}},{default:l(()=>[(M(!0),D(Q,null,$(n.maus,o=>(M(),U(E,{key:o.id,label:o.tenMau,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(y,{type:"success",circle:"",onClick:e[11]||(e[11]=o=>n.addMauSacDialogRef.open())},{default:l(()=>[t(V,null,{default:l(()=>[t(I)]),_:1})]),_:1})])]),_:1},8,["error"])]),_:1}),t(X,{ref:"addMauSacDialogRef",onSaved:n.handleMauSacSaved},null,8,["onSaved"]),t(b,{span:12},{default:l(()=>[t(p,{label:"ROM",prop:"selectedRoms",error:n.errors.selectedRoms},{default:l(()=>[T("div",Vn,[t(k,{modelValue:n.selectedRoms,"onUpdate:modelValue":e[12]||(e[12]=o=>n.selectedRoms=o),multiple:"",placeholder:"Chọn ROM",clearable:"",onChange:e[13]||(e[13]=o=>n.errors.selectedRoms=""),style:{flex:"1"}},{default:l(()=>[(M(!0),D(Q,null,$(n.roms,o=>(M(),U(E,{key:o.id,label:o.dungLuong,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(y,{type:"success",circle:"",onClick:e[14]||(e[14]=o=>n.addRomDialogRef.open())},{default:l(()=>[t(V,null,{default:l(()=>[t(I)]),_:1})]),_:1})])]),_:1},8,["error"])]),_:1}),t(ce,{ref:"addRomDialogRef",onSaved:n.handleDungLuongRomSaved},null,8,["onSaved"])]),_:1})]),_:1}),t(f,{shadow:"hover",class:"section-card"},{header:l(()=>[T("div",Bn,[T("span",null,[t(z,{class:"el-icon"}),e[28]||(e[28]=w(" Ảnh theo màu sắc "))])])]),default:l(()=>[t(_,{gutter:20},{default:l(()=>[(M(!0),D(Q,null,$(n.selectedMaus,o=>(M(),U(b,{span:24,key:o},{default:l(()=>[t(p,{label:n.getMauSacLabels(o),error:n.errorsMauHinhAnh[o]||""},{default:l(()=>[t(v,{"file-list":n.hinhAnhTheoMau[o]||[],"on-change":(F,A)=>n.handleMauFileChange(F,A,o),"on-remove":(F,A)=>n.handleMauFileRemove(F,A,o),"auto-upload":!1,accept:"image/jpeg,image/png,image/webp","list-type":"picture-card",limit:5,"on-exceed":n.handleExceed},{trigger:l(()=>[t(y,{type:"primary",plain:""},{default:l(()=>[t(ae,{class:"el-icon"}),e[29]||(e[29]=w(" Tải ảnh "))]),_:1})]),tip:l(()=>e[30]||(e[30]=[T("div",{class:"el-upload__tip"}," Tải tối đa 5 ảnh (JPEG, PNG, WEBP, tối đa 5MB mỗi ảnh) ",-1)])),_:2},1032,["file-list","on-change","on-remove","on-exceed"])]),_:2},1032,["label","error"])]),_:2},1024))),128))]),_:1})]),_:1}),t(f,{shadow:"hover",class:"section-card"},{header:l(()=>[T("div",En,[T("span",null,[t(me,{class:"el-icon"}),e[31]||(e[31]=w(" Nhập giá nhanh "))])])]),default:l(()=>[t(_,{gutter:20},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{label:"Giá bán chung",prop:"giaBanChung",error:n.errors.giaBanChung},{default:l(()=>[t(m,{modelValue:n.giaBanChungFormatted,"onUpdate:modelValue":e[15]||(e[15]=o=>n.giaBanChungFormatted=o),placeholder:"Nhập giá bán chung",style:{width:"200px"},onInput:n.handlePriceInput,onChange:e[16]||(e[16]=o=>n.errors.giaBanChung=""),onBlur:n.validatePrice},{suffix:l(()=>e[32]||(e[32]=[T("span",{style:{color:"#909399","font-size":"12px"}},"VND",-1)])),_:1},8,["modelValue","onInput","onBlur"]),t(y,{type:"primary",style:{"margin-left":"10px"},onClick:n.confirmApplyGiaBanChung},{default:l(()=>[t(te,{class:"el-icon"}),e[33]||(e[33]=w(" Áp dụng "))]),_:1},8,["onClick"])]),_:1},8,["error"])]),_:1})]),_:1}),t(y,{type:"primary",loading:n.loading.generate,onClick:n.generateVariants},{default:l(()=>[t(I,{class:"el-icon"}),w(" "+q(n.loading.generate?"Đang tạo...":"Tạo biến thể"),1)]),_:1},8,["loading","onClick"])]),_:1}),t(f,{shadow:"hover",class:"section-card"},{header:l(()=>[T("div",Rn,[T("span",null,[t(de,{class:"el-icon"}),e[34]||(e[34]=w(" Chi tiết sản phẩm "))])])]),default:l(()=>[t(_,{gutter:20},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(fe,{data:n.sanPham.sanPhamChiTiets,style:{"margin-top":"10px"},"highlight-current-row":"",onRowClick:n.selectChiTiet,class:"variant-table"},{default:l(()=>[t(J,{label:"STT",type:"index",width:"60",align:"center"}),t(J,{label:"Màu sắc",width:"120"},{default:l(({row:o})=>[w(q(n.getMauSacLabels(o.idMau)),1)]),_:1}),t(J,{label:"ROM",width:"100"},{default:l(({row:o})=>[w(q(n.getRomLabels(o.idRom)),1)]),_:1}),t(J,{label:"Giá bán",width:"120"},{default:l(({row:o})=>[w(q(o.giaBan?o.giaBan.toLocaleString("vi-VN")+" VND":"Chưa nhập giá"),1)]),_:1}),t(J,{label:"Ảnh",width:"100"},{default:l(({row:o})=>[(M(!0),D(Q,null,$(o.hinhAnhs.slice(0,2),(F,A)=>(M(),U(ge,{key:F.imagePublicId,src:F.url,"preview-src-list":[F.url],style:{width:"30px",height:"30px","margin-right":"3px"},fit:"cover"},null,8,["src","preview-src-list"]))),128)),o.hinhAnhs.length>2?(M(),D("span",Fn,"+"+q(o.hinhAnhs.length-2)+" ảnh",1)):he("",!0),o.hinhAnhs.length?he("",!0):(M(),D("span",Nn,"Chưa có ảnh"))]),_:1}),t(J,{label:"Hành động",width:"80",align:"center",fixed:"right"},{default:l(({$index:o})=>[t(y,{type:"danger",size:"small",onClick:sn(F=>n.confirmRemoveChiTiet(o),["stop"])},{default:l(()=>[t(K,{class:"el-icon"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onRowClick"])]),_:1}),t(b,{span:12},{default:l(()=>[n.selectedChiTiet!==null?(M(),U(f,{key:0,shadow:"hover",class:"variant-detail-card"},{header:l(()=>[T("div",Dn,[T("span",null,"Thông tin biến thể "+q(n.selectedChiTiet+1)+" ("+q(n.getMauSacLabels(n.sanPham.sanPhamChiTiets[n.selectedChiTiet].idMau))+" - "+q(n.getRomLabels(n.sanPham.sanPhamChiTiets[n.selectedChiTiet].idRom))+")",1)])]),default:l(()=>{var o,F,A;return[t(p,{label:"Giá bán",error:((o=n.errorsChiTiet[n.selectedChiTiet])==null?void 0:o.giaBan)||"",class:"error-container"},{default:l(()=>[t(m,{modelValue:n.variantPriceFormatted[n.selectedChiTiet],"onUpdate:modelValue":e[17]||(e[17]=O=>n.variantPriceFormatted[n.selectedChiTiet]=O),placeholder:"Nhập giá bán",style:{width:"100%"},onInput:e[18]||(e[18]=O=>n.handleVariantPriceInput(O,n.selectedChiTiet)),onChange:e[19]||(e[19]=O=>n.errorsChiTiet[n.selectedChiTiet].giaBan="")},{suffix:l(()=>e[35]||(e[35]=[T("span",{style:{color:"#909399","font-size":"12px"}},"VND",-1)])),_:1},8,["modelValue"])]),_:1},8,["error"]),t(p,{label:"Số lượng",error:((F=n.errorsChiTiet[n.selectedChiTiet])==null?void 0:F.soLuong)||"",class:"error-container"},{default:l(()=>[t(Z,{modelValue:n.sanPham.sanPhamChiTiets[n.selectedChiTiet].soLuong,"onUpdate:modelValue":e[20]||(e[20]=O=>n.sanPham.sanPhamChiTiets[n.selectedChiTiet].soLuong=O),min:0,disabled:!0,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["error"]),t(p,{label:"IMEI",error:((A=n.errorsChiTiet[n.selectedChiTiet])==null?void 0:A.imeisInput)||"",class:"error-container"},{default:l(()=>{var O,le;return[t(m,{type:"textarea",modelValue:n.sanPham.sanPhamChiTiets[n.selectedChiTiet].imeisInput,"onUpdate:modelValue":e[21]||(e[21]=W=>n.sanPham.sanPhamChiTiets[n.selectedChiTiet].imeisInput=W),placeholder:"Nhập danh sách IMEI (15 chữ số mỗi IMEI, phân tách bởi dấu phẩy)",rows:4,disabled:n.sanPham.sanPhamChiTiets[n.selectedChiTiet].isFileUploaded,onInput:e[22]||(e[22]=W=>n.handleImeiInput(n.selectedChiTiet))},null,8,["modelValue","disabled"]),T("div",xn,[t(v,{ref:`upload-${n.selectedChiTiet}`,"file-list":n.imeiFileList[n.selectedChiTiet]||[],"auto-upload":!1,"on-change":(W,ye)=>n.handleFileSelection(W,n.selectedChiTiet,ye),accept:".xlsx,.xls,",disabled:((O=n.sanPham.sanPhamChiTiets[n.selectedChiTiet])==null?void 0:O.imeisInput.length)>0,"list-type":"text",class:"custom-upload"},{trigger:l(()=>[t(y,{type:"default",plain:"",class:"choose-file-btn"},{default:l(()=>[t(ae,{class:"el-icon"}),e[36]||(e[36]=w(" Chọn file "))]),_:1})]),default:l(()=>[n.imeiFileList[n.selectedChiTiet]&&n.imeiFileList[n.selectedChiTiet].length>0?(M(),D("span",Un,q(n.imeiFileList[n.selectedChiTiet][0].name),1)):(M(),D("span",jn,"Chưa chọn file"))]),_:1},8,["file-list","on-change","disabled"]),t(y,{type:"primary",disabled:!(n.imeiFileList[n.selectedChiTiet]&&n.imeiFileList[n.selectedChiTiet].length>0),onClick:e[23]||(e[23]=W=>n.confirmUploadImeiFile(n.selectedChiTiet)),class:"upload-btn"},{default:l(()=>[t(ae,{class:"el-icon"}),e[37]||(e[37]=w(" Upload "))]),_:1},8,["disabled"]),t(y,{type:"warning",plain:"",onClick:e[24]||(e[24]=W=>n.confirmClearImeiInput(n.selectedChiTiet)),class:"clear-btn"},{default:l(()=>[t(K,{class:"el-icon"}),e[38]||(e[38]=w(" Xóa IMEI "))]),_:1})]),T("div",An,[T("span",null,"Số lượng IMEI: "+q(n.sanPham.sanPhamChiTiets[n.selectedChiTiet].soLuong),1),((le=n.errorsChiTiet[n.selectedChiTiet])==null?void 0:le.imeisInput)==="Hợp lệ"?(M(),U(pe,{key:0,content:"Danh sách IMEI hợp lệ",placement:"top"},{default:l(()=>[T("span",On,[t(te,{class:"el-icon"}),e[39]||(e[39]=w(" Hợp lệ "))])]),_:1})):he("",!0)])]}),_:1},8,["error"])]}),_:1})):(M(),U(f,{key:1,shadow:"hover"},{default:l(()=>[T("div",Hn,[t(Ce,{class:"el-icon"}),e[40]||(e[40]=w(" Vui lòng chọn hoặc thêm biến thể sản phẩm "))])]),_:1}))]),_:1})]),_:1})]),_:1}),T("div",qn,[t(y,{size:"large",type:"success",loading:n.loading.submit,onClick:n.confirmSubmitForm},{default:l(()=>[t(te,{class:"el-icon"}),e[41]||(e[41]=w(" Lưu sản phẩm "))]),_:1},8,["loading","onClick"]),t(y,{size:"large",type:"info",onClick:n.downloadTemplate},{default:l(()=>[t(V,null,{default:l(()=>[t(ve)]),_:1}),e[42]||(e[42]=w(" Tải Template IMEI "))]),_:1},8,["onClick"])])]),_:1},8,["model"])],64)}const Qn=ze(Tn,[["render",Gn],["__scopeId","data-v-a2a99489"]]);export{Qn as default};
