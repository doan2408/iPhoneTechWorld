import{_ as Ct,r,u as Mt,c as O,a1 as st,w as Ht,o as xt,b as l,d as i,e as t,k as g,B as nt,h as v,t as a,v as A,U as q,X as ot,g as Nt,n as p,F as _,m as y,y as at,S as et}from"./index-BFtI-PwE.js";import{h as Bt,c as Dt,a as Lt,d as At,e as St,b as Vt,f as jt,g as zt,v as Et,i as $t}from"./HoaDonAdminServices-DGan0CW1.js";import{S as w}from"./sweetalert2.esm.all-DGhwgajj.js";import{C as it}from"./ConfirmModal-CTKRHOBX.js";const Ft={class:"dashboard"},It={class:"dashboard-header"},Pt={class:"header-content"},Xt={class:"stats-grid"},Ut={class:"stat-card"},Gt={class:"stat-content"},Kt={class:"stat-number"},Rt={class:"stat-card"},Ot={class:"stat-content"},qt={class:"stat-number"},Qt={class:"stat-card"},Wt={class:"stat-content"},Yt={class:"stat-number"},Jt={class:"stat-card"},Zt={class:"stat-content"},ts={class:"stat-number"},ss={class:"filters-section"},ns={class:"search-container"},os={class:"search-box"},as={class:"filter-controls"},es={class:"filter-date-range"},is={class:"export-actions"},ls={class:"table-section"},rs={class:"table-header"},ds={class:"table-title"},cs={class:"view-controls"},us={class:"view-toggle-buttons"},hs={key:0,class:"table-container"},vs={class:"modern-table"},ps={class:"table-body"},gs={class:"table-td"},ms={class:"invoice-stt"},fs={class:"table-td"},ks={class:"invoice-code"},bs={class:"table-td"},_s={class:"customer-info"},ys={class:"customer-avatar"},ws={class:"customer-name"},Ts={class:"table-td"},Cs={class:"date"},Ms={class:"table-td"},Hs={class:"date"},xs={class:"table-td"},Ns={class:"amount"},Bs={class:"table-td"},Ds={class:"table-td"},Ls={class:"table-td"},As={class:"action-buttons"},Ss=["onClick"],Vs=["onClick"],js=["disabled","onClick"],zs={key:1,class:"grid-container"},Es={class:"card-content"},$s={class:"card-header-row"},Fs={class:"invoice-code"},Is={class:"card-body"},Ps={class:"customer-section"},Xs={class:"customer-avatar"},Us={class:"customer-details"},Gs={class:"customer-name"},Ks={class:"invoice-date"},Rs={class:"card-details"},Os={class:"detail-item"},qs={class:"detail-value amount"},Qs={class:"detail-item"},Ws={class:"card-actions"},Ys=["onClick"],Js={class:"pagination-section"},Zs={class:"pagination-info"},tn={class:"pagination-controls"},sn=["disabled"],nn={class:"page-numbers"},on=["onClick","disabled"],an=["disabled"],en={class:"modal-header"},ln={class:"header-title"},rn={key:0},dn={key:1},cn={key:2},un={class:"modal-body"},hn={key:0,class:"loading-container"},vn={key:1,class:"error-container"},pn={key:2},gn={class:"info-card"},mn={class:"card-content"},fn={class:"info-grid"},kn={class:"info-column"},bn={class:"info-row"},_n={class:"info-value font-semibold"},yn={class:"info-row"},wn={class:"info-value"},Tn={class:"info-row"},Cn={class:"info-value"},Mn={class:"info-row"},Hn={class:"info-value"},xn={class:"info-row"},Nn={class:"info-value"},Bn={class:"info-row"},Dn={class:"info-row"},Ln={class:"info-row"},An={class:"info-value"},Sn={class:"info-row"},Vn={class:"info-value"},jn={class:"info-column"},zn={class:"info-row"},En={class:"info-value"},$n={class:"info-row"},Fn={class:"info-value"},In={key:0,class:"info-row"},Pn={class:"info-row"},Xn={class:"info-value"},Un={class:"info-row"},Gn={class:"info-value"},Kn={class:"info-row"},Rn={class:"info-row"},On={class:"info-value"},qn={class:"info-row"},Qn={class:"info-value"},Wn={class:"info-row"},Yn={class:"info-value discount"},Jn={class:"info-row total-row"},Zn={class:"info-value total-value"},to={class:"info-card"},so={class:"card-content"},no={key:0,class:"table-container"},oo={class:"product-table"},ao={class:"product-name"},eo={class:"text-center"},io={class:"text-right"},lo={key:1,class:"no-products"},ro={class:"invoice-card-actions"},co=["disabled"],uo={key:0},ho={class:"invoice-history-container"},vo={class:"invoice-history-table"},po={class:"product-name"},go={class:"text-center"},mo={class:"text-right"},fo={key:0,class:"history-overlay"},ko={class:"history-modal"},bo={class:"history-title"},_o={class:"history-list"},yo={class:"history-action"},wo={class:"history-time"},To={class:"history-description"},Co={key:0,class:"no-history"},Mo={__name:"HoaDonAdmin",setup(Ho){const f=r([]),u=r(0),T=r(6),C=r(0),S=r(0),M=r("table"),H=r(""),x=r(""),N=r(""),B=r(""),D=r(""),k=r(!1),Q=r(null),V=r(null),j=r(!1),e=r(null),lt=r([]),rt=r(!1),W=r(0),P=r(0),b=Mt(),Y=async o=>{k.value=!0;try{const s=await Vt(o.idHoaDon);e.value=s.data,console.log("Dữ liệu chi tiết hóa đơn:",s.data),j.value=!0}catch(s){console.error("Error fetching invoice details:",s),e.value=o,j.value=!0}finally{k.value=!1}},X=()=>{j.value=!1,e.value=null},dt=O(()=>{const o=[],s=C.value,d=u.value;if(s<=5)for(let n=0;n<s;n++)o.push(n);else{o.push(0),d>3&&o.push(-1);const n=Math.max(1,d-1),c=Math.min(s-2,d+1);for(let h=n;h<=c;h++)o.push(h);d<s-4&&o.push(-1),o.push(s-1)}return o}),z=async()=>{k.value=!0;try{const o=await Bt(u.value,T.value,H.value,x.value,N.value,B.value,D.value),s=await Dt(),d=await Lt(),n=await At();Array.isArray(o.data.content)?(f.value=o.data.content,C.value=o.data.totalPages||0,S.value=s.data||0,P.value=d.data||0,W.value=m(n.data||0)):(f.value=[],C.value=0)}catch(o){console.error("Error loading data:",o),f.value=[],C.value=0}finally{k.value=!1}},ct=()=>{V.value=!0},ut=async()=>{var o,s,d;V.value=!1;try{const c=(await $t()).data;c.hoaDonId&&(localStorage.setItem("selectedInvoiceId",c.hoaDonId),b.success("Tạo hóa đơn thành công!"),et.push("/admin/ban-hang"))}catch(n){console.error("Error:",n);const c=((d=(s=(o=n.response)==null?void 0:o.data)==null?void 0:s.map(h=>h.message))==null?void 0:d.join(" | "))||"Lỗi hệ thống!";b.warning(c)}finally{k.value=!1}},ht=()=>{V.value=!1},vt=async o=>{const s=await w.fire({title:"Xác nhận xóa hóa đơn",text:"Bạn muốn xóa mềm hay xóa cứng hóa đơn này?",icon:"warning",showCancelButton:!0,confirmButtonText:"Xóa mềm",cancelButtonText:"Hủy",showDenyButton:o.trangThaiThanhToan=="Chờ xử lý",denyButtonText:"Xóa cứng"});try{if(o.tongTien>0){w.fire("Thông báo!","Hóa đơn này đã có sản phẩm, không thể xóa.","info");return}if(s.isConfirmed)await jt(o.idHoaDon),w.fire("Thành công!","Hóa đơn đã được xóa mềm.","success");else if(s.isDenied)if((await w.fire({title:"Xác nhận xóa cứng",text:"Hành động này không thể khôi phục! Bạn có chắc chắn muốn xóa cứng?",icon:"error",showCancelButton:!0,confirmButtonText:"Xóa cứng",cancelButtonText:"Hủy"})).isConfirmed)await zt(o.idHoaDon),w.fire("Thành công!","Hóa đơn đã được xóa cứng.","success");else return;else return;z()}catch(d){console.error("Delete Hoa don",d),w.fire("Lỗi!","Đã xảy ra lỗi khi xóa hóa đơn.","error")}},U=o=>{u.value=o,z()},J=o=>{if(!o||typeof o!="string")return"N/A";const s=o.trim().split(/\s+/);if(s.length===1)return s[0][0].toUpperCase();const d=s[0][0],c=s[s.length-1][0];return(d+c).toUpperCase()},L=o=>{if(!o)return"Chưa thanh toán";const s=new Date(o);if(isNaN(s.getTime()))return"Invalid Date";const d=s.getDate().toString().padStart(2,"0"),n=(s.getMonth()+1).toString().padStart(2,"0"),c=s.getFullYear();return`${d}/${n}/${c}`},m=o=>{if(!o||isNaN(o))return"0 ₫";try{return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o)}catch{return`${o} ₫`}},pt=(o,s)=>o===0?"0%":`${Math.round(100*(o-s)/o)}%`,E=o=>o&&{"hoàn tất":"status-completed","chờ xử lý":"status-pending","đã hủy":"status-cancelled","đã hoàn tiền":"status-refunded","đã thanh toán":"status-paid","chờ xử lý":"status-pending","đang giao":"status-shipping","đã giao":"status-delivered","giao thất bại":"status-failed","đã hoàn tiền":"status-returned","đã đóng gói":"status-packed"}[o.toLowerCase()]||"status-default",gt=async o=>{et.push({name:"GiaoHangProcessing",params:{id:o.idHoaDon}})},G=o=>o&&{online:"type-online",offline:"type-offline","trực tuyến":"type-online","tại quầy":"type-offline"}[o.toLowerCase()]||"type-default",mt=O(()=>{const o=st.state.roles;return Array.isArray(o)&&o.map(s=>typeof s=="string"?s:s.authority).includes("ROLE_ADMIN")});O(()=>{const o=st.state.roles;return Array.isArray(o)&&o.map(s=>typeof s=="string"?s:s.authority).includes("ROLE_STAFF")});const K=r([]),$=r(!1),Z=r(),ft=async o=>{$.value=!0,await bt(o)},kt=()=>{$.value=!1},bt=async o=>{try{const s=await Et(o.idHoaDon);Z.value=s.data[0].maHoaDon,K.value=s.data,$.value=!0}catch(s){console.error("Lỗi khi lấy lịch sử hóa đơn:",s),b.error("Không thể tải lịch sử hóa đơn")}};Ht([H,x,N,B,D],()=>{u.value=0,z()}),xt(()=>z());const _t=async()=>{try{const o=await St(),s=new Blob([o.data]),d=window.URL.createObjectURL(s),n=document.createElement("a");n.href=d;const c=o.headers["content-disposition"];let h="hoa_don.xlsx";if(c&&c.includes("filename=")){const I=c.match(/filename="?([^"]+)"?/);I!=null&&I[1]&&(h=I[1])}n.setAttribute("download",h),document.body.appendChild(n),b.info("File Excel đã sẵn sàng, vui lòng chọn nơi lưu"),n.click(),document.body.removeChild(n),setTimeout(()=>{b("Nếu bạn đã lưu file, hãy kiểm tra thư mục tải xuống nhé!")},3e3)}catch(o){b.error("Lỗi khi xuất Excel:",o)}},yt=()=>{u.value=0,T.value=6,H.value="",x.value="",N.value="",B.value="",D.value="",b.success("Làm mới bộ lọc thành công")},F=r(!1),tt=r("");let R=null;function wt(o,s){tt.value=o,R=s,F.value=!0}function Tt(){R&&R(),F.value=!1}return(o,s)=>{var d;return i(),l("div",Ft,[t("div",It,[t("div",Pt,[s[15]||(s[15]=t("div",{class:"title-section"},[t("h1",{class:"dashboard-title"},"Quản lý hóa đơn"),t("p",{class:"dashboard-subtitle"},"Theo dõi và quản lý tất cả hóa đơn")],-1)),t("div",{class:"header-actions"},[t("button",{class:"btn btn-primary",onClick:ct},s[14]||(s[14]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),v(" Tạo hóa đơn mới ")]))]),V.value?(i(),nt(it,{key:0,message:"Bạn có chắc muốn tạo hóa đơn mới không?",onConfirm:ut,onCancel:ht})):g("",!0)])]),t("div",Xt,[t("div",Ut,[s[17]||(s[17]=t("div",{class:"stat-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",Gt,[t("h3",Kt,a(S.value),1),s[16]||(s[16]=t("p",{class:"stat-label"},"Tổng hóa đơn",-1))])]),t("div",Rt,[s[19]||(s[19]=t("div",{class:"stat-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),t("div",Ot,[t("h3",qt,a(W.value),1),s[18]||(s[18]=t("p",{class:"stat-label"},"Doanh thu tháng",-1))])]),t("div",Qt,[s[21]||(s[21]=t("div",{class:"stat-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Wt,[t("h3",Yt,a(P.value),1),s[20]||(s[20]=t("p",{class:"stat-label"},"Chờ xử lý",-1))])]),t("div",Jt,[s[23]||(s[23]=t("div",{class:"stat-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1)),t("div",Zt,[t("h3",ts,a(pt(S.value,P.value)),1),s[22]||(s[22]=t("p",{class:"stat-label"},"Tỷ lệ hoàn thành",-1))])])]),t("div",ss,[t("div",ns,[t("div",os,[s[24]||(s[24]=t("svg",{class:"search-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),A(t("input",{type:"text",placeholder:"Tìm kiếm theo mã hóa đơn, tên khách hàng...",class:"search-input","onUpdate:modelValue":s[0]||(s[0]=n=>H.value=n)},null,512),[[q,H.value]])])]),t("div",as,[A(t("select",{class:"filter-select","onUpdate:modelValue":s[1]||(s[1]=n=>x.value=n)},s[25]||(s[25]=[Nt('<option value="" data-v-839765b0>Tất cả trạng thái</option><option value="COMPLETED" data-v-839765b0>Hoàn tất</option><option value="PENDING" data-v-839765b0>Chờ thanh toán</option><option value="PAID" data-v-839765b0>Đã thanh toán</option><option value="REFUNDED" data-v-839765b0>Đã hoàn tiền</option>',5)]),512),[[ot,x.value]]),A(t("select",{class:"filter-select","onUpdate:modelValue":s[2]||(s[2]=n=>N.value=n)},s[26]||(s[26]=[t("option",{value:""},"Loại hóa đơn",-1),t("option",{value:"ONLINE"},"Trực tuyến",-1),t("option",{value:"POS"},"Tại quầy",-1)]),512),[[ot,N.value]]),t("div",es,[s[27]||(s[27]=t("label",{class:"filter-label"},"Từ ngày",-1)),A(t("input",{type:"date",class:"filter-date","onUpdate:modelValue":s[3]||(s[3]=n=>B.value=n)},null,512),[[q,B.value]]),s[28]||(s[28]=t("label",{class:"filter-label"},"Đến ngày",-1)),A(t("input",{type:"date",class:"filter-date","onUpdate:modelValue":s[4]||(s[4]=n=>D.value=n)},null,512),[[q,D.value]])]),t("div",is,[t("button",{class:"btn btn-outline",onClick:s[5]||(s[5]=n=>wt("Bạn có chắc muốn làm mới bộ lọc?",()=>yt()))},s[29]||(s[29]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Làm mới bộ lọc ")])),t("button",{class:"btn btn-outline",onClick:_t},s[30]||(s[30]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Xuất Excel ")]))]),F.value?(i(),nt(it,{key:0,message:tt.value,onConfirm:Tt,onCancel:s[6]||(s[6]=n=>F.value=!1)},null,8,["message"])):g("",!0)])]),t("div",ls,[t("div",rs,[t("h2",ds,[s[31]||(s[31]=t("svg",{class:"title-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),v(" Danh sách hóa đơn ("+a(f.value.length)+") ",1)]),t("div",cs,[t("div",us,[t("button",{onClick:s[7]||(s[7]=n=>M.value="table"),class:p(["view-toggle-btn",{active:M.value==="table"}]),title:"Xem dạng bảng"},s[32]||(s[32]=[t("svg",{class:"view-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})],-1)]),2),t("button",{onClick:s[8]||(s[8]=n=>M.value="grid"),class:p(["view-toggle-btn",{active:M.value==="grid"}]),title:"Xem dạng lưới"},s[33]||(s[33]=[t("svg",{class:"view-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]),2)])])]),M.value==="table"?(i(),l("div",hs,[t("table",vs,[s[37]||(s[37]=t("thead",{class:"table-header-row"},[t("tr",null,[t("th",{class:"table-th"},"STT"),t("th",{class:"table-th"},"Mã hóa đơn"),t("th",{class:"table-th"},"Người mua"),t("td",{class:"table-th"},"Số điện thoại"),t("th",{class:"table-th"},"Ngày tạo"),t("th",{class:"table-th"},"Tổng tiền"),t("th",{class:"table-th"},"Loại"),t("th",{class:"table-th"},"Trạng thái thanh toán"),t("th",{class:"table-th"},"Hành động")])],-1)),t("tbody",ps,[(i(!0),l(_,null,y(f.value,(n,c)=>(i(),l("tr",{key:n.id,class:"table-row"},[t("td",gs,[t("div",ms,a(u.value*T.value+c+1),1)]),t("td",fs,[t("div",ks,a(n.maHoaDon),1)]),t("td",bs,[t("div",_s,[t("div",ys,a(J(n.tenNguoiMua)),1),t("div",ws,a(n.tenNguoiMua??"Khách vãng lai"),1)])]),t("td",Ts,[t("div",Cs,a(n.sdtNguoiMua??"N/A"),1)]),t("td",Ms,[t("div",Hs,a(L(n.ngayTao)),1)]),t("td",xs,[t("div",Ns,a(m(n.tongTien)),1)]),t("td",Bs,[t("span",{class:p(["type-badge",G(n.loaiHoaDon)])},a(n.loaiHoaDon),3)]),t("td",Ds,[t("span",{class:p(["status-badge",E(n.trangThaiThanhToan)])},a(n.trangThaiThanhToan!="Chờ xử lý"?n.trangThaiThanhToan:"Chưa thanh toán"),3)]),t("td",Ls,[t("div",As,[t("button",{class:"action-btn view-btn",title:"Xem chi tiết",onClick:h=>Y(n)},s[34]||(s[34]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,Ss),t("button",{class:"action-btn edit-btn",title:"Xem lịch sử",onClick:h=>ft(n)},s[35]||(s[35]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-9-9 9 9 0 019 9z"})],-1)]),8,Vs),mt.value?(i(),l("button",{key:0,class:"action-btn delete-btn",title:"Xóa",disabled:n.trangThaiThanhToan==="Hoàn tất"||n.trangThaiThanhToan==="Đã thanh toán"||n.trangThaiThanhToan==="Đã hoàn tiền",onClick:h=>vt(n)},s[36]||(s[36]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,js)):g("",!0)])])]))),128))])])])):(i(),l("div",zs,[(i(!0),l(_,null,y(f.value,n=>(i(),l("div",{key:n.id,class:"invoice-card"},[s[41]||(s[41]=t("div",{class:"card-checkbox"},[t("input",{type:"checkbox",class:"invoice-checkbox"})],-1)),t("div",Es,[t("div",$s,[t("div",Fs,a(n.maHoaDon),1),t("span",{class:p(["status-badge",E(n.trangThaiThanhToan)])},a(n.trangThaiThanhToan),3)]),t("div",Is,[t("div",Ps,[t("div",Xs,a(J(n.tenKhachHang)),1),t("div",Us,[t("div",Gs,a(n.tenKhachHang),1),t("div",Ks,a(L(n.ngayTao)),1)])]),t("div",Rs,[t("div",Os,[s[38]||(s[38]=t("span",{class:"detail-label"},"Tổng tiền:",-1)),t("span",qs,a(m(n.tongTien)),1)]),t("div",Qs,[s[39]||(s[39]=t("span",{class:"detail-label"},"Loại:",-1)),t("span",{class:p(["type-badge",G(n.loaiHoaDon)])},a(n.loaiHoaDon),3)])])]),t("div",Ws,[t("button",{class:"card-btn primary",onClick:c=>Y(n)}," Xem chi tiết ",8,Ys),s[40]||(s[40]=t("button",{class:"card-btn secondary"},"Chỉnh sửa",-1))])])]))),128))])),t("div",Js,[t("div",Zs," Hiển thị "+a(u.value*T.value+1)+" - "+a(u.value*T.value+f.value.length)+" trong tổng số "+a(S.value)+" hóa đơn ",1),t("div",tn,[t("button",{class:"pagination-btn",disabled:u.value===0,onClick:s[9]||(s[9]=n=>U(u.value-1))},s[42]||(s[42]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),v(" Trước ")]),8,sn),t("div",nn,[(i(!0),l(_,null,y(dt.value,n=>(i(),l("button",{key:n,class:p(["page-btn",{active:n===u.value}]),onClick:c=>n!==-1&&U(n),disabled:n===-1},a(n===-1?"...":n+1),11,on))),128))]),t("button",{class:"pagination-btn",disabled:u.value===C.value-1,onClick:s[10]||(s[10]=n=>U(u.value+1))},s[43]||(s[43]=[v(" Sau "),t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,an)])]),j.value?(i(),l("div",{key:2,class:"modal-overlay",onClick:at(X,["self"])},[t("div",{class:"modal-content",onClick:s[13]||(s[13]=at(()=>{},["stop"]))},[t("div",en,[t("div",ln,[s[44]||(s[44]=t("svg",{class:"header-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("h3",null,[k.value?(i(),l("span",rn,"Đang tải...")):e.value?(i(),l("span",dn,"Chi tiết hóa đơn "+a(e.value.maHoaDon),1)):(i(),l("span",cn,"Chi tiết hóa đơn"))])]),t("button",{class:"modal-close",onClick:X},s[45]||(s[45]=[t("svg",{class:"close-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",un,[k.value?(i(),l("div",hn,s[46]||(s[46]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Đang tải thông tin hóa đơn...",-1)]))):Q.value?(i(),l("div",vn,[s[48]||(s[48]=t("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s[49]||(s[49]=t("h4",null,"Có lỗi xảy ra",-1)),t("p",null,a(Q.value),1),t("button",{class:"retry-btn",onClick:s[11]||(s[11]=(...n)=>o.retryFetch&&o.retryFetch(...n))},s[47]||(s[47]=[t("svg",{class:"retry-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),v(" Thử lại ")]))])):e.value?(i(),l("div",pn,[t("div",gn,[s[70]||(s[70]=t("div",{class:"card-header"},[t("svg",{class:"card-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})]),t("h4",null,"Thông tin hóa đơn")],-1)),t("div",mn,[t("div",fn,[t("div",kn,[t("div",bn,[s[50]||(s[50]=t("span",{class:"info-label"},"Mã hóa đơn:",-1)),t("span",_n,a(e.value.maHoaDon),1)]),t("div",yn,[s[51]||(s[51]=t("span",{class:"info-label"},"Mã tài khoản mua",-1)),t("span",wn,a(e.value.maKhachHang||"N/A"),1)]),t("div",Tn,[s[52]||(s[52]=t("span",{class:"info-label"},"Tên người mua",-1)),t("span",Cn,a(e.value.tenNguoiMua||"N/A"),1)]),t("div",Mn,[s[53]||(s[53]=t("span",{class:"info-label"},"SĐT người mua:",-1)),t("span",Hn,a(e.value.sdtNguoiMua||"N/A"),1)]),t("div",xn,[s[54]||(s[54]=t("span",{class:"info-label"},"Ngày tạo:",-1)),t("span",Nn,a(L(e.value.ngayTao)),1)]),t("div",Bn,[s[55]||(s[55]=t("span",{class:"info-label"},"Loại hóa đơn:",-1)),t("span",{class:p(["badge",G(e.value.loaiHoaDon)])},a(e.value.loaiHoaDon||"N/A"),3)]),t("div",Dn,[s[56]||(s[56]=t("span",{class:"info-label"},"Trạng thái:",-1)),t("span",{class:p(["badge",E(e.value.trangThaiThanhToan)])},a(e.value.trangThaiThanhToan||"N/A"),3)]),t("div",Ln,[s[57]||(s[57]=t("span",{class:"info-label"},"Ngày thanh toán:",-1)),t("span",An,a(L(e.value.ngayThanhToan)||"Chưa thanh toán"),1)]),t("div",Sn,[s[58]||(s[58]=t("span",{class:"info-label"},"Mã giảm giá:",-1)),t("span",Vn,a(e.value.maPhieuGiamGia||"Không áp dụng mã giảm gía"),1)])]),t("div",jn,[t("div",zn,[s[59]||(s[59]=t("span",{class:"info-label"},"Tên người nhận:",-1)),t("span",En,a(e.value.tenNguoiNhan||"N/A"),1)]),t("div",$n,[s[60]||(s[60]=t("span",{class:"info-label"}," SDT Người nhận:",-1)),t("span",Fn,a(e.value.sdtNguoiNhan||"N/A"),1)]),e.value.maKhachHang!=null?(i(),l("div",In,s[61]||(s[61]=[t("span",{class:"info-label"},[t("mark",null,[v("⚠️Lưu ý: "),t("br"),v(" Tên người mua là tên tại thời điểm giao dịch "),t("br"),v(" Tên tài khoản mua là tên hiện tại của tài khoản")])],-1)]))):g("",!0),t("div",Pn,[s[62]||(s[62]=t("span",{class:"info-label"}," Địa chỉ giao hàng:",-1)),t("span",Xn,a(e.value.diaChiGiaoHang||"N/A"),1)]),t("div",Un,[s[63]||(s[63]=t("span",{class:"info-label"}," Ngày đặt hàng:",-1)),t("span",Gn,a(e.value.ngayDatHang||"N/A"),1)]),t("div",Kn,[s[64]||(s[64]=t("span",{class:"info-label"}," Trạng thái đơn hàng:",-1)),t("span",{class:p(["badge",E(e.value.trangThaiDonHang)])},a(e.value.trangThaiDonHang||"N/A"),3)]),s[69]||(s[69]=t("div",{class:"separator"},null,-1)),t("div",Rn,[s[65]||(s[65]=t("span",{class:"info-label"},"Tổng tiền:",-1)),t("span",On,a(m(e.value.tongTien)),1)]),t("div",qn,[s[66]||(s[66]=t("span",{class:"info-label"},"Phí ship:",-1)),t("span",Qn,a(m(e.value.phiShip)),1)]),t("div",Wn,[s[67]||(s[67]=t("span",{class:"info-label"},"Số tiền giảm:",-1)),t("span",Yn,"-"+a(m(e.value.soTienGiam)),1)]),t("div",Jn,[s[68]||(s[68]=t("span",{class:"info-label total-label"},"Thành tiền:",-1)),t("span",Zn,a(m(e.value.thanhTien)),1)])])])])]),t("div",to,[s[73]||(s[73]=t("div",{class:"card-header"},[t("svg",{class:"card-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})]),t("h4",null,"Chi tiết sản phẩm")],-1)),t("div",so,[e.value.chiTietHoaDonAdminResponseList&&e.value.chiTietHoaDonAdminResponseList.length?(i(),l("div",no,[t("table",oo,[s[71]||(s[71]=t("thead",null,[t("tr",null,[t("th",null,"Sản phẩm"),t("th",{class:"text-center"},"Số lượng"),t("th",{class:"text-right"},"Đơn giá")])],-1)),t("tbody",null,[(i(!0),l(_,null,y(e.value.chiTietHoaDonAdminResponseList,n=>(i(),l("tr",{key:n.idChiTietHoaDon,class:"product-row"},[t("td",ao,a(n.tenSanPham||"N/A"),1),t("td",eo,a(n.soLuong||"N/A"),1),t("td",io,a(m(n.donGia)),1)]))),128))])])])):(i(),l("div",lo,s[72]||(s[72]=[t("svg",{class:"no-products-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),t("p",null,"Không có chi tiết sản phẩm.",-1)])))])]),t("div",ro,[t("button",{class:"invoice-action-button invoice-process-button",onClick:s[12]||(s[12]=n=>gt(e.value)),disabled:!((d=e.value)!=null&&d.isShipping)},s[74]||(s[74]=[t("svg",{class:"invoice-btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),t("span",null,"Xử lý đơn hàng",-1)]),8,co)]),rt.value?(i(),l("div",uo,[s[76]||(s[76]=t("div",{class:"invoice-history-header"},[t("svg",{class:"invoice-history-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h3",null,"Lịch sử hóa đơn")],-1)),t("div",ho,[t("table",vo,[s[75]||(s[75]=t("thead",null,[t("tr",null,[t("th",null,"Người thao tác"),t("th",null,"Ngày thao tác"),t("th",null,"Hành động")])],-1)),t("tbody",null,[(i(!0),l(_,null,y(lt.value,n=>(i(),l("tr",{key:n.idLichSuHoaDon,class:"product-row"},[t("td",po,a(n.maNhanVien)+" - "+a(n.tenNhanVien),1),t("td",go,a(n.thoiGianThayDoi),1),t("td",mo,a(n.hanhDong),1)]))),128))])])])])):g("",!0)])):g("",!0)]),t("div",{class:"modal-footer"},[t("button",{class:"modal-btn",onClick:X},s[77]||(s[77]=[t("svg",{class:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),v(" Đóng ")]))])])])):g("",!0)]),$.value?(i(),l("div",fo,[t("div",ko,[t("h3",bo,"Lịch sử hóa đơn #"+a(Z.value),1),t("div",_o,[(i(!0),l(_,null,y(K.value,n=>(i(),l("div",{key:n.idLichSuHoaDon,class:"history-item"},[t("div",yo,a(n.hanhDong),1),t("div",wo,a(L(n.thoiGianThayDoi)),1),t("div",To,a(n.moTa),1)]))),128)),K.value.length?g("",!0):(i(),l("div",Co," Không có lịch sử nào để hiển thị "))]),t("div",{class:"history-actions"},[t("button",{class:"history-btn cancel",onClick:kt},"Đóng")])])])):g("",!0)])}}},Lo=Ct(Mo,[["__scopeId","data-v-839765b0"]]);export{Lo as default};
