import{_ as Qe,u as Ye,r,H as Ze,I as Ve,z as es,A as ss,T as ts,w as de,o as as,J as ns,a as te,b as l,d as o,e as s,k as p,F as M,m as D,n as P,t as n,h as w,y as $e,f as L,i as T,B as ae,j as q,C as os,a4 as Ee,P as ls,a5 as is,G as ne,E as B}from"./index-BFtI-PwE.js";import{_ as cs}from"./bannerTichDiem-MSSQEbfp.js";import{d as rs,b as us,c as ds,e as hs}from"./ProductClientService-BX6QUyHF.js";import{d as vs,a as ps,c as gs}from"./WishListService-DdnSnyDf.js";import{c as he}from"./GioHangClientService-DnoTnJBO.js";import{D as ve}from"./DanhGiaSanPhamClientService-DHhPE4UI.js";import{P as ms}from"./PhanHoiDanhGiaClientService-iDK6Xo3n.js";import{n as fs}from"./KhuyenMaiSanPhamService-DWIIZEWi.js";const ys={class:"product-detail"},_s={class:"product-container"},bs={class:"product-image"},ks=["src"],Ss={key:0,class:"thumbnail-list"},ws=["src","onClick"],Ts={key:1,class:"featured-specs"},Cs={class:"featured-specs-grid"},Ls={class:"spec-item"},Ms={class:"spec-value"},Ds={class:"spec-item"},Ps={class:"spec-value"},Bs={class:"spec-item"},Hs={class:"spec-value"},xs={class:"product-right"},Vs={class:"product-info"},$s=["title"],Es={key:0},Ks={key:1},Gs={class:"options"},As={class:"option-list"},Ns={class:"options"},Rs={class:"option-list"},Us={key:0,class:"options"},Is={class:"price"},js={key:0,class:"old-price"},Fs={class:"current-price"},Os={key:1,class:"discount-badge"},Xs={class:"banner-tichDiem"},zs={class:"diemTichLuy"},qs={class:"button-group"},Ws={class:"spec-modal-header"},Js={class:"spec-tabs-wrapper"},Qs={class:"spec-details"},Ys={class:"spec-section","data-section":"thong-tin-hang-hoa"},Zs={class:"spec-row"},et={class:"spec-value"},st={class:"spec-row"},tt={class:"spec-value"},at={class:"spec-section","data-section":"thiet-ke-trong-luong"},nt={class:"spec-row"},ot={class:"spec-value"},lt={class:"spec-row"},it={class:"spec-value"},ct={class:"spec-section","data-section":"bo-xu-ly"},rt={class:"spec-row"},ut={class:"spec-value"},dt={class:"spec-section","data-section":"ram"},ht={class:"spec-row"},vt={class:"spec-value"},pt={class:"spec-row"},gt={class:"spec-value"},mt={class:"spec-section","data-section":"man-hinh"},ft={class:"spec-row"},yt={class:"spec-value"},_t={class:"spec-row"},bt={class:"spec-value"},kt={class:"spec-row"},St={class:"spec-value"},wt={class:"spec-row"},Tt={class:"spec-value"},Ct={class:"spec-row"},Lt={class:"spec-value"},Mt={class:"spec-section","data-section":"camera"},Dt={class:"spec-row"},Pt={class:"spec-value"},Bt={class:"spec-row"},Ht={class:"spec-value"},xt={class:"spec-section","data-section":"pin-sac"},Vt={class:"spec-row"},$t={class:"spec-value"},Et={class:"spec-row"},Kt={class:"spec-value"},Gt={class:"spec-row"},At={class:"spec-value"},Nt={class:"spec-row"},Rt={class:"spec-value"},Ut={class:"rating-summary"},It={class:"star-distribution"},jt={class:"progress-bar"},Ft={class:"review-filters"},Ot={class:"reviews-list"},Xt={class:"review-header"},zt={class:"review-user"},qt={key:0,class:"pending-label"},Wt={key:1,class:"purchased-label"},Jt={class:"review-date"},Qt={class:"review-comment"},Yt={key:0,class:"review-media"},Zt={key:0,class:"review-images"},ea=["src","onError"],sa=["src","onError"],ta={class:"review-responses"},aa={key:1},na={class:"response-content"},oa={class:"response-date"},la={key:2,class:"no-response"},ia={key:0,class:"loading"},ca={key:0,class:"load-more"};(function(){var A=document.createElement("script"),N=document.getElementsByTagName("script")[0];A.async=!0,A.src="https://embed.tawk.to/68836581db7610192eeaacd6/1j10k90i5",A.charset="UTF-8",A.setAttribute("crossorigin","*"),N.parentNode.insertBefore(A,N)})();const ra={__name:"DetailProduct",setup(A){const N=Ye(),pe=r(0),j=Ze();j.hasModule("headerState")||j.registerModule("headerState",Ve);const Ke=()=>{j.commit("headerState/setCartItemCount",pe.value)},H=JSON.parse(localStorage.getItem("user")),x=es().params.id,Ge=ss(),b=r("thong-tin-hang-hoa"),_=r(null),W=r(null);(()=>{j.hasModule("headerState")||j.registerModule("headerState",Ve)})();const ge=t=>t?new Intl.NumberFormat("vi-VN").format(t)+"₫":"0₫",Ae=t=>{if(!t)return 0;const e=t*.01;return new Intl.NumberFormat("vi-VN").format(Math.floor(e))},R=r(null),U=r(null),g=r(null),m=r(null),i=r(null),c=r(null),V=r(1);r(0),r(""),r([]);const I=r([]),F=r(0),O=ts({}),$=r(1),oe=r(10),C=r(0),J=r(0),Q=r(!1),X=r(!1),Y=r({}),Z=r(!1),me=()=>{Z.value=!0},fe=()=>{Z.value=!1},le=t=>{if(W.value){const e=W.value.querySelector(`[data-tab="${t}"]`);if(e){const f=W.value,u=e.offsetLeft-20;f.scrollTo({left:Math.max(0,u),behavior:"smooth"}),console.log("Tab scrolled to left:",t,u)}}},E=t=>{b.value=t,le(t),_.value&&ne(()=>{const e=_.value.querySelector(`[data-section="${t}"]`);if(e){const f=_.value,u=81,v=49,d=e.offsetTop,k=d-u-v-10;console.log("Section ID:",t),console.log("Section top:",d),console.log("Scroll to:",k),f.scrollTo({top:Math.max(0,k),behavior:"smooth"})}else console.warn(`Section with data-section="${t}" not found`)})},ye=()=>{if(!_.value)return;const t=_.value.scrollTop,e=81,f=49,u=50,v=_.value.querySelectorAll(".spec-section[data-section]");let d="thong-tin-hang-hoa";v.forEach(k=>{const G=k.offsetTop-e-f,S=G+k.offsetHeight;t>=G-u&&t<S-u&&(d=k.getAttribute("data-section"))}),b.value!==d&&(b.value=d,le(d))},_e=async t=>{try{const e=await ms.layPhanHoiTheoDanhGia(t);Y.value[t]=e}catch(e){console.error(`Lỗi khi lấy phản hồi cho đánh giá ${t}:`,e),B.error("Không thể tải phản hồi!")}},Ne=async()=>{var t;try{const e=await rs(x);U.value=e,e.rom.length>0&&(g.value=e.rom[0].id),e.mau.length>0&&(m.value=e.mau[0].id),((t=e.hinhAnh)==null?void 0:t.length)>0&&(R.value=e.hinhAnh[0]),await ce()}catch(e){console.error("Lỗi khi tải chi tiết sản phẩm:",e)}},Re=async()=>{if(g.value)try{const t=await hs(x,g.value);c.value=t}catch(t){c.value=null,console.error("Không lấy được thông số:",t)}},ie=async()=>{var t;if(!(!g.value||!m.value))try{const e=await us(x,m.value,g.value,H.id);console.log("hehe",e),i.value=e,((t=e.hinhAnh)==null?void 0:t.length)>0&&(R.value=e.hinhAnh[0]),await z(),await je(),await Se()}catch(e){i.value={soLuong:0},console.error("Không lấy được biến thể:",e)}},Ue=async()=>{if(!m.value||!x)return;const t=await ds(x,m.value);t.length>0&&i.value&&(i.value.hinhAnh=t,R.value=t[0]),await Se()},be=async t=>{var e,f;try{if(!(V!=null&&V.value)||V.value<=0){V.value=1,B.error("Số lượng phải lớn hơn 0!");return}const u=i.value.soLuong;if(u<0){B.error("Dữ liệu tồn kho không hợp lệ!");return}const v=await he.getCart(H.id);let d=0;if(v&&v.items){const S=v.items.find(se=>se.idSanPhamChiTiet===i.value.idSpct);S&&(d=S.soLuong)}const k=d+V.value,G=u<2?u:2;if(k>G){d<2?B.error(`Số lượng vượt quá tồn kho. Đã có ${d} sản phẩm trong giỏ.`):B.error("Giới hạn số lượng mua là 2. Đã có 2 sản phẩm trong giỏ.");return}if(await he.addToCart({idKhachHang:H.id,idSanPhamChiTiet:i.value.idSpct,soLuong:V.value}),t)try{await Ge.push({path:"/client/shopping-cart",query:{selected:i.value.idSpct}})}catch(S){console.error("Lỗi chuyển hướng:",S),B.error("Không thể chuyển hướng đến giỏ hàng!")}else B.success("Sản phẩm đã được thêm vào giỏ hàng!");try{pe.value=await he.cartCount(H.id)}catch(S){console.error("Lỗi khi tải giỏ hàng:",S)}Ke()}catch(u){console.error("Lỗi khi thêm sản phẩm vào giỏ hàng:",u),B.error(((f=(e=u.response)==null?void 0:e.data)==null?void 0:f.message)||"Lỗi khi thêm sản phẩm vào giỏ hàng!")}},ke=r(null),Ie=async()=>{var t;await ne(),(t=ke.value)==null||t.scrollIntoView({behavior:"smooth"})},z=async()=>{try{X.value=!0;const t=await ve.layDanhGiaTheoSanPham(i.value.idSpct,$.value-1,oe.value,J.value===0?null:J.value,Q.value?!0:null,H==null?void 0:H.id);console.log("Đánh giá111:",t),I.value=$.value===1?t.content||t:[...I.value,...t.content||t],C.value=t.totalElements||t.length;for(const e of I.value)await _e(e.idDanhGia)}catch(t){console.error("Lỗi khi lấy đánh giá:",t),B.error("Không thể tải đánh giá!")}finally{X.value=!1}},je=async()=>{try{const t=await ve.tinhDiemTrungBinhSanPhamSpct(i.value.idSpct);F.value=t||0}catch(t){console.error("Lỗi khi lấy điểm trung bình:",t)}},Se=async()=>{var t;if((t=i.value)!=null&&t.idSpct)try{const e=await ve.thongKeSoSaoSanPham(i.value.idSpct);Object.keys(O).forEach(u=>delete O[u]),Object.entries(e).forEach(([u,v])=>{O[u]=v}),C.value=Object.values(e).reduce((u,v)=>u+v,0);const f=Object.entries(e).reduce((u,[v,d])=>u+v*d,0);F.value=C.value?f/C.value:0}catch(e){console.error("❌ Lỗi khi lấy thống kê sao:",e)}},Fe=async t=>{J.value=t,$.value=1,await z()},Oe=async()=>{$.value=1,await z()},we=async()=>{$.value++,await z()},Xe=()=>{const t=new IntersectionObserver(e=>{e[0].isIntersecting&&I.value.length<C.value&&!X.value&&we()},{threshold:.1});ne(()=>{const e=document.querySelector(".reviews-list");e&&t.observe(e)})},ze=t=>{$.value=t,z()};de([m],()=>{ie(),Ue(),ce()}),de([g],()=>{ie(),Re(),ce()});let ee=null;const qe=async()=>{try{const t=await fs();return Math.max(1e3,t.delay||6e4)}catch(t){return t.name!=="AbortError"&&(console.error("Không thể lấy thời gian cập nhật:",t),N.error("Không thể lấy thời gian cập nhật")),6e4}};as(async()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),Ne(),Xe();const t=await qe();ee=setInterval(async()=>{await ie()},t)}),ns(()=>{ee&&(clearInterval(ee),ee=null)}),de(Z,t=>{t?ne(()=>{_.value&&(_.value.scrollTop=0,_.value.addEventListener("scroll",ye,{passive:!0}),b.value="thong-tin-hang-hoa",le("thong-tin-hang-hoa"))}):_.value&&_.value.removeEventListener("scroll",ye)});const K=r(!1),ce=async()=>{try{const t=await gs(x,g.value,m.value);K.value=t.data}catch(t){console.error("Lỗi kiểm tra wishlist:",t)}},We=async()=>{try{K.value?(await vs(x,g.value,m.value,null),N.success("Bỏ yêu thích thành công")):(await ps(x,g.value,m.value,null),N.success("Thêm thành công vào yêu thích")),K.value=!K.value}catch(t){console.error("Lỗi toggle wishlist:",t)}};return(t,e)=>{var k,G,S,se,Te,Ce,Le,Me,De,Pe,Be,He;const f=te("el-radio-button"),u=te("el-radio-group"),v=te("router-link"),d=te("el-button");return o(),l("section",ys,[s("div",_s,[s("div",bs,[s("img",{src:R.value||((G=(k=i.value)==null?void 0:k.hinhAnh)==null?void 0:G[0])||"/img/no-image.png",alt:"Hình ảnh sản phẩm",class:"main-image"},null,8,ks),((se=(S=i.value)==null?void 0:S.hinhAnh)==null?void 0:se.length)>0?(o(),l("div",Ss,[(o(!0),l(M,null,D(i.value.hinhAnh,(a,y)=>(o(),l("img",{key:y,src:a,class:P(["thumbnail",{active:a===R.value}]),onClick:re=>R.value=a},null,10,ws))),128))])):p("",!0),c.value?(o(),l("div",Ts,[s("div",{class:"featured-specs-header"},[e[14]||(e[14]=s("h3",{class:"featured-title"},"Thông số nổi bật",-1)),s("button",{onClick:me,class:"view-specs-btn"}," Xem thông số ")]),s("div",Cs,[s("div",Ls,[e[15]||(e[15]=s("i",{class:"fas fa-microchip spec-icon"},null,-1)),e[16]||(e[16]=s("div",{class:"spec-label"},"Chip",-1)),s("div",Ms,n(c.value.cpu),1)]),s("div",Ds,[e[17]||(e[17]=s("i",{class:"fas fa-tv spec-icon"},null,-1)),e[18]||(e[18]=s("div",{class:"spec-label"},"Màn hình",-1)),s("div",Ps,n(c.value.kichThuoc),1)]),s("div",Bs,[e[19]||(e[19]=s("i",{class:"fas fa-battery-full spec-icon"},null,-1)),e[20]||(e[20]=s("div",{class:"spec-label"},"Thời lượng pin",-1)),s("div",Hs,n(c.value.thoiGianSuDung),1)])])])):p("",!0)]),s("div",xs,[s("div",Vs,[s("h1",null,n((Te=U.value)==null?void 0:Te.tenSanPham)+" - "+n((Ce=U.value)==null?void 0:Ce.maXuatXu),1),s("a",{href:"#",class:"danhGia",onClick:$e(Ie,["prevent"])},"Đánh giá"),e[27]||(e[27]=w(" | ")),s("button",{onClick:me,class:"thong-so-btn"}," Xem thông số "),e[28]||(e[28]=w(" | ")),s("button",{onClick:We,class:P(["wishlist-btn",K.value?"active":""]),title:K.value?"Bỏ khỏi yêu thích":"Thêm vào yêu thích"},[K.value?(o(),l("span",Es,"❤️ Bỏ khỏi yêu thích")):(o(),l("span",Ks,"🤍 Thêm vào yêu thích"))],10,$s),s("div",Gs,[e[21]||(e[21]=s("h3",null,"Chọn màu:",-1)),s("div",As,[L(u,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a)},{default:T(()=>{var a;return[(o(!0),l(M,null,D((a=U.value)==null?void 0:a.mau,y=>(o(),ae(f,{key:y.id,label:y.id},{default:T(()=>[w(n(y.ten),1)]),_:2},1032,["label"]))),128))]}),_:1},8,["modelValue"])])]),s("div",Ns,[e[22]||(e[22]=s("h3",null,"Chọn ROM:",-1)),s("div",Rs,[L(u,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a)},{default:T(()=>{var a;return[(o(!0),l(M,null,D((a=U.value)==null?void 0:a.rom,y=>(o(),ae(f,{key:y.id,label:y.id},{default:T(()=>[w(n(y.ten),1)]),_:2},1032,["label"]))),128))]}),_:1},8,["modelValue"])])]),i.value?(o(),l("div",Us,[s("h3",null,"Số lượng còn: "+n(i.value.soLuong??0),1)])):p("",!0),s("p",Is,[(Le=i.value)!=null&&Le.giaTruocKhuyenMai&&i.value.giaTruocKhuyenMai!==i.value.giaBan?(o(),l("span",js,n(ge(i.value.giaTruocKhuyenMai)),1)):p("",!0),s("span",Fs,n(ge((Me=i.value)==null?void 0:Me.giaBan)),1),(De=i.value)!=null&&De.giaTruocKhuyenMai&&i.value.giaTruocKhuyenMai>i.value.giaBan?(o(),l("span",Os," -"+n(Math.round((i.value.giaTruocKhuyenMai-i.value.giaBan)/i.value.giaTruocKhuyenMai*100))+"% ",1)):p("",!0)]),s("div",Xs,[L(v,{to:"/client/doiDiem"},{default:T(()=>e[23]||(e[23]=[s("img",{src:cs,alt:"Banner tích điểm",class:"tich-diem-img"},null,-1)])),_:1})]),s("div",zs,[e[24]||(e[24]=s("i",{class:"fas fa-coins xu-icon"},null,-1)),w(" + "+n(Ae((Pe=i.value)==null?void 0:Pe.giaBan))+" điểm thưởng ",1)]),s("div",qs,[L(d,{type:"primary",disabled:!g.value||!m.value||((Be=i.value)==null?void 0:Be.soLuong)<=0,class:"buy-btn",onClick:e[2]||(e[2]=a=>be(!0))},{default:T(()=>e[25]||(e[25]=[w(" Mua ngay ")])),_:1},8,["disabled"]),L(d,{type:"success",icon:q(os),disabled:!g.value||!m.value||((He=i.value)==null?void 0:He.soLuong)<=0,class:"cart-btn",onClick:e[3]||(e[3]=a=>be(!1))},{default:T(()=>e[26]||(e[26]=[w(" Thêm vào giỏ hàng ")])),_:1},8,["icon","disabled"])])])])]),Z.value?(o(),l("div",{key:0,class:"spec-modal-overlay",onClick:fe},[s("div",{class:"spec-modal",onClick:e[11]||(e[11]=$e(()=>{},["stop"]))},[s("div",Ws,[e[29]||(e[29]=s("h2",null,"Thông số sản phẩm",-1)),e[30]||(e[30]=s("br",null,null,-1)),s("h6",null,n(U.value.tenSanPham)+" "+n(c.value.rom),1),s("button",{onClick:fe,class:"close-btn"},"×")]),c.value?(o(),l("div",{key:0,class:"spec-modal-content",ref_key:"specModalContent",ref:_},[s("div",Js,[s("div",{class:"spec-tabs",ref_key:"specTabsContainer",ref:W},[s("div",{class:P(["tab-item",{active:b.value==="thong-tin-hang-hoa"}]),onClick:e[4]||(e[4]=a=>E("thong-tin-hang-hoa")),"data-tab":"thong-tin-hang-hoa"}," Thông tin hàng hóa ",2),s("div",{class:P(["tab-item",{active:b.value==="thiet-ke-trong-luong"}]),onClick:e[5]||(e[5]=a=>E("thiet-ke-trong-luong")),"data-tab":"thiet-ke-trong-luong"}," Thiết kế & Trọng lượng ",2),s("div",{class:P(["tab-item",{active:b.value==="bo-xu-ly"}]),onClick:e[6]||(e[6]=a=>E("bo-xu-ly")),"data-tab":"bo-xu-ly"}," Bộ xử lý ",2),s("div",{class:P(["tab-item",{active:b.value==="ram"}]),onClick:e[7]||(e[7]=a=>E("ram")),"data-tab":"ram"}," Lưu trữ ",2),s("div",{class:P(["tab-item",{active:b.value==="man-hinh"}]),onClick:e[8]||(e[8]=a=>E("man-hinh")),"data-tab":"man-hinh"}," Màn hình ",2),s("div",{class:P(["tab-item",{active:b.value==="camera"}]),onClick:e[9]||(e[9]=a=>E("camera")),"data-tab":"camera"}," Camera ",2),s("div",{class:P(["tab-item",{active:b.value==="pin-sac"}]),onClick:e[10]||(e[10]=a=>E("pin-sac")),"data-tab":"pin-sac"}," Pin & Sạc ",2)],512)]),s("div",Qs,[s("div",Ys,[e[33]||(e[33]=s("h3",null,"Thông tin hàng hóa",-1)),s("div",Zs,[e[31]||(e[31]=s("span",{class:"spec-label"},"Xuất xứ",-1)),s("span",et,n(c.value.xuatXu),1)]),s("div",st,[e[32]||(e[32]=s("span",{class:"spec-label"},"Hệ điều hành",-1)),s("span",tt,n(c.value.heDieuHanh),1)])]),s("div",at,[e[36]||(e[36]=s("h3",null,"Thiết kế & Trọng lượng",-1)),s("div",nt,[e[34]||(e[34]=s("span",{class:"spec-label"},"Kích thước",-1)),s("span",ot,n(c.value.kichThuoc),1)]),s("div",lt,[e[35]||(e[35]=s("span",{class:"spec-label"},"Chất liệu kính",-1)),s("span",it,n(c.value.chatLieuKinh),1)])]),s("div",ct,[e[38]||(e[38]=s("h3",null,"Bộ xử lý",-1)),s("div",rt,[e[37]||(e[37]=s("span",{class:"spec-label"},"CPU",-1)),s("span",ut,n(c.value.cpu),1)])]),s("div",dt,[e[41]||(e[41]=s("h3",null,"Lưu trữ",-1)),s("div",ht,[e[39]||(e[39]=s("span",{class:"spec-label"},"RAM",-1)),s("span",vt,n(c.value.ram),1)]),s("div",pt,[e[40]||(e[40]=s("span",{class:"spec-label"},"ROM",-1)),s("span",gt,n(c.value.rom),1)])]),s("div",mt,[e[47]||(e[47]=s("h3",null,"Màn hình",-1)),s("div",ft,[e[42]||(e[42]=s("span",{class:"spec-label"},"Tên màn hình",-1)),s("span",yt,n(c.value.tenManHinh),1)]),s("div",_t,[e[43]||(e[43]=s("span",{class:"spec-label"},"Loại màn hình",-1)),s("span",bt,n(c.value.loaiManHinh),1)]),s("div",kt,[e[44]||(e[44]=s("span",{class:"spec-label"},"Độ phân giải",-1)),s("span",St,n(c.value.doPhanGiai),1)]),s("div",wt,[e[45]||(e[45]=s("span",{class:"spec-label"},"Tần số quét",-1)),s("span",Tt,n(c.value.tanSoQuet),1)]),s("div",Ct,[e[46]||(e[46]=s("span",{class:"spec-label"},"Độ sáng",-1)),s("span",Lt,n(c.value.doSang),1)])]),s("div",Mt,[e[50]||(e[50]=s("h3",null,"Camera",-1)),s("div",Dt,[e[48]||(e[48]=s("span",{class:"spec-label"},"Camera sau",-1)),s("span",Pt,n(c.value.cameraSau),1)]),s("div",Bt,[e[49]||(e[49]=s("span",{class:"spec-label"},"Camera trước",-1)),s("span",Ht,n(c.value.cameraTruoc),1)])]),s("div",xt,[e[55]||(e[55]=s("h3",null,"Pin & Sạc",-1)),s("div",Vt,[e[51]||(e[51]=s("span",{class:"spec-label"},"Pin",-1)),s("span",$t,n(c.value.phienBanPin),1)]),s("div",Et,[e[52]||(e[52]=s("span",{class:"spec-label"},"Công suất sạc",-1)),s("span",Kt,n(c.value.congXuatSac),1)]),s("div",Gt,[e[53]||(e[53]=s("span",{class:"spec-label"},"Thời gian sử dụng",-1)),s("span",At,n(c.value.thoiGianSuDung),1)]),s("div",Nt,[e[54]||(e[54]=s("span",{class:"spec-label"},"Số lần sạc tối đa",-1)),s("span",Rt,n(c.value.soLanSacToiDa),1)])])])],512)):p("",!0)])])):p("",!0),s("div",{class:"product-reviews",ref_key:"reviewsSection",ref:ke},[e[60]||(e[60]=s("h2",null,"Đánh giá sản phẩm",-1)),s("div",Ut,[s("h3",null,"Điểm trung bình: "+n(F.value.toFixed(1))+" / 5",1),L(q(Ee),{modelValue:F.value,"onUpdate:modelValue":e[12]||(e[12]=a=>F.value=a),disabled:"","allow-half":""},null,8,["modelValue"]),s("div",It,[(o(),l(M,null,D([5,4,3,2,1],a=>s("div",{key:a,class:"star-bar"},[s("span",null,n(a)+" sao:",1),s("div",jt,[s("div",{class:"progress",style:ls({width:C.value===0?"100%":(O[a]||0)/C.value*100+"%"})},null,4)]),s("span",null,n(O[a]||0)+" đánh giá",1)])),64))])]),s("div",Ft,[(o(),l(M,null,D([0,5,4,3,2,1],a=>L(d,{key:a,onClick:y=>Fe(a),type:J.value===a?"primary":"default"},{default:T(()=>[w(n(a===0?"Tất cả":`${a} sao`),1)]),_:2},1032,["onClick","type"])),64)),L(d,{onClick:e[13]||(e[13]=a=>{Q.value=!Q.value,Oe()}),type:Q.value?"primary":"default"},{default:T(()=>e[56]||(e[56]=[w(" Có hình ảnh/video ")])),_:1},8,["type"])]),s("div",Ot,[(o(!0),l(M,null,D(I.value,a=>{var y,re,xe;return o(),l("div",{class:"review-item",key:a.idDanhGia},[s("div",Xt,[s("span",zt,n(a.anonymous?"Người mua":a.tenKhachHang),1),a.trangThaiDanhGia==="PENDING"&&a.idKhachHang===q(H).id?(o(),l("span",qt," Chờ duyệt ")):p("",!0),a.idChiTietHoaDon?(o(),l("span",Wt,"Đã mua hàng")):p("",!0),L(q(Ee),{modelValue:a.soSao,"onUpdate:modelValue":h=>a.soSao=h,disabled:""},null,8,["modelValue","onUpdate:modelValue"]),s("span",Jt,n(new Date(a.ngayDanhGia).toLocaleDateString("vi-VN")),1)]),s("p",Qt,n(a.noiDung),1),(y=a.mediaUrls)!=null&&y.length?(o(),l("div",Yt,[(re=a.mediaUrls)!=null&&re.filter(h=>h.match(/\.(png|jpg|jpeg|gif)$/i)).length?(o(),l("div",Zt,[(o(!0),l(M,null,D(a.mediaUrls.filter(h=>h.match(/\.(png|jpg|jpeg|gif)$/i)),(h,ue)=>(o(),l("img",{key:ue,src:h,alt:"Hình ảnh đánh giá",class:"review-image",onError:Je=>console.log("Lỗi tải ảnh:",h)},null,40,ea))),128))])):p("",!0),(o(!0),l(M,null,D(a.mediaUrls.filter(h=>h.match(/\.(mp4|mov|avi|webm)$/i)),(h,ue)=>(o(),l("video",{key:"video-"+ue,src:h,controls:"",class:"review-video",onError:Je=>console.log("Lỗi tải video:",h)},null,40,sa))),128))])):p("",!0),s("div",ta,[Y.value[a.idDanhGia]?(xe=Y.value[a.idDanhGia])!=null&&xe.length?(o(),l("div",aa,[e[58]||(e[58]=s("h4",null,"Phản hồi từ cửa hàng:",-1)),(o(!0),l(M,null,D(Y.value[a.idDanhGia],h=>(o(),l("div",{key:h.idPhanHoi,class:"response-item"},[s("p",na,n(h.noiDungPhanHoi),1),s("span",oa,n(new Date(h.ngayPhanHoi).toLocaleDateString("vi-VN")),1)]))),128))])):(o(),l("div",la," Chưa có phản hồi từ cửa hàng. ")):(o(),ae(d,{key:0,onClick:h=>_e(a.idDanhGia),size:"small"},{default:T(()=>e[57]||(e[57]=[w(" Tải phản hồi ")])),_:2},1032,["onClick"]))])])}),128)),X.value?(o(),l("div",ia,"Đang tải thêm...")):p("",!0)]),I.value.length<C.value&&!X.value?(o(),l("div",ca,[L(d,{type:"primary",onClick:we},{default:T(()=>e[59]||(e[59]=[w("Xem thêm")])),_:1})])):p("",!0),C.value>oe.value?(o(),ae(q(is),{key:1,"current-page":$.value,"page-size":oe.value,total:C.value,layout:"prev, pager, next",onCurrentChange:ze},null,8,["current-page","page-size","total"])):p("",!0)],512)])}}},ba=Qe(ra,[["__scopeId","data-v-c1e697e2"]]);export{ba as default};
