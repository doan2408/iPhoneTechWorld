import{O as $,P as J,Q as W,R as Y}from"./ProductAdminService-BjtVeFMT.js";import{_ as Z,u as ee,r as f,T as B,c as j,o as te,w as T,a as m,b as ae,d as ne,f as e,e as X,i as n,h as y,j as D,a6 as le,l as oe,t as se,R as M}from"./index-I05jmhuU.js";const ue={class:"container mt-4"},re={class:"table-responsive mb-4",style:{"margin-top":"20px"}},ce={class:"action-buttons-horizontal"},ie={class:"pagination-fixed"},me={class:"d-flex justify-content-center align-items-center gap-3"},b=5,de={__name:"XuatXuAdmin",setup(pe){const o=ee(),Q=f([]),d=f(1),E=f(1),k=f(0),v=f(""),g=f(!1),_=f(!1),V=f(null),s=B({id:null,maXuatXu:"",tenQuocGia:""}),C=()=>{s.id=null,s.maXuatXu="",s.tenQuocGia="",u.maXuatXu="",u.tenQuocGia=""},P=()=>{u.maXuatXu="",u.tenQuocGia=""},u=B({maXuatXu:"",tenQuocGia:""}),w=async()=>{try{const a=await $(d.value-1,b,v.value.trim());Q.value=a.content,E.value=a.totalPages,k.value=a.totalElements}catch(a){console.error("Không thể load dữ liệu:",a)}},S=async()=>{var a,t;if(V.value)try{const l=_.value?"Bạn có chắc chắn muốn cập nhật xuất xứ này không?":"Bạn có chắc chắn muốn thêm mới xuất xứ này không?";await M.confirm(l,"Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Hủy",type:"warning"}),_.value?(await W(s.id,s),o.success("Cập nhật xuất xứ thành công!")):(await Y(s),o.success("Thêm mới xuất xứ thành công!")),C(),g.value=!1,w()}catch(l){if(l==="cancel"||l==="close"){o.info("Đã hủy thao tác");return}if(u.maXuatXu=((a=l.message)==null?void 0:a.maXuatXu)||"",u.tenQuocGia=((t=l.message)==null?void 0:t.tenQuocGia)||"",l.response){const c=l.response.status,r=l.response.data;if(c===400){const p=r.message;if(typeof p=="string")o.error(p);else if(typeof p=="object"){Object.keys(u).forEach(x=>{u[x]=p[x]||""});const h=Object.values(u).filter(x=>x);h.length>0?o.error(h.join(`
`)):o.error("Dữ liệu không hợp lệ!")}else o.error("Dữ liệu không hợp lệ!")}else c===409?o.error(r.message||"Dữ liệu đã tồn tại"):c>=500?o.error("Server lỗi, vui lòng thử lại sau"):o.error(r.message||"Đã xảy ra lỗi không xác định")}else l.request?o.error("Không nhận được phản hồi từ server"):o.error("Lỗi gửi request: "+l.message)}},q=async a=>{try{await M.confirm("Bạn có chắc chắn muốn xoá xuất xứ này không?","Xác nhận xoá",{confirmButtonText:"Xoá",cancelButtonText:"Huỷ",type:"warning"}),await J(a),o.success("Xoá thành công!"),w()}catch(t){if(t==="cancel"||t==="close"){o.info("Đã hủy thao tác");return}}};j(()=>k.value===0?0:(d.value-1)*b+1),j(()=>Math.min(d.value*b,k.value)),te(()=>{w()}),T([d,v],()=>{w()}),T(()=>s.maXuatXu,a=>{a&&(u.maXuatXu="")}),T(()=>s.tenQuocGia,a=>{a&&(u.tenQuocGia="")});const z=()=>{d.value=1},N=()=>{v.value="",d.value=1},R=()=>{C(),g.value=!0,_.value=!1},O=()=>{g.value=!1,C()},U=a=>{_.value=!0,Object.assign(s,a),g.value=!0,P()},A=a=>(d.value-1)*b+a+1,H=a=>{d.value=a};return(a,t)=>{const l=m("el-input"),c=m("el-col"),r=m("el-button"),p=m("el-row"),h=m("el-table-column"),x=m("el-table"),L=m("el-pagination"),G=m("el-form-item"),F=m("el-form"),I=m("el-dialog");return ne(),ae("div",ue,[e(p,{gutter:20,class:"mb-4 justify-content-center"},{default:n(()=>[e(c,{span:6},{default:n(()=>[e(l,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=i=>v.value=i),placeholder:"Tìm kiếm",clearable:""},null,8,["modelValue"])]),_:1}),e(c,{span:3},{default:n(()=>[e(r,{type:"primary",onClick:z,class:"w-100"},{default:n(()=>t[4]||(t[4]=[y("Tìm kiếm")])),_:1})]),_:1})]),_:1}),e(p,{gutter:20,class:"mb-2",justify:"end"},{default:n(()=>[e(c,{span:3},{default:n(()=>[e(r,{type:"primary",onClick:R,class:"w-100"},{default:n(()=>t[5]||(t[5]=[y("Tạo mới")])),_:1})]),_:1}),e(c,{span:3},{default:n(()=>[e(r,{type:"primary",onClick:N,class:"w-100"},{default:n(()=>t[6]||(t[6]=[y("Làm mới")])),_:1})]),_:1})]),_:1}),t[8]||(t[8]=X("h2",null,"Danh sách xuất xứ",-1)),X("div",re,[e(x,{data:Q.value,border:"",style:{width:"100%"}},{default:n(()=>[e(h,{type:"index",index:A,label:"STT",width:"80"}),e(h,{prop:"maXuatXu",label:"Mã xuất xứ"}),e(h,{prop:"tenQuocGia",label:"Tên quốc gia"}),e(h,{label:"Thao tác",width:"180"},{default:n(({row:i})=>[X("div",ce,[e(r,{size:"small",type:"primary",icon:D(le),circle:"",onClick:K=>U(i)},null,8,["icon","onClick"]),e(r,{size:"small",type:"danger",icon:D(oe),circle:"",onClick:K=>q(i.id)},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])]),X("div",ie,[X("div",me,[e(L,{background:"",layout:"prev, pager, next","page-size":b,"current-page":d.value,total:k.value,"pager-count":7,"prev-text":"< Trước","next-text":"Sau >",onCurrentChange:H},null,8,["current-page","total"])])]),e(I,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=i=>g.value=i),title:_.value?"Chỉnh sửa xuất xứ":"Thêm mới xuất xứ",width:"900px","close-on-click-modal":!1,"destroy-on-close":!0},{default:n(()=>[e(F,{model:s,ref_key:"formRef",ref:V,"label-width":"140px","label-position":"left",class:"hdh-form"},{default:n(()=>[e(p,{gutter:20},{default:n(()=>[e(c,{span:12},{default:n(()=>[e(G,{label:"Mã xuất xứ",prop:"maXuatXu",error:u.maXuatXu},{default:n(()=>[e(l,{modelValue:s.maXuatXu,"onUpdate:modelValue":t[1]||(t[1]=i=>s.maXuatXu=i),placeholder:"Nhập mã xuất xứ...",autocomplete:"on"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(c,{span:12},{default:n(()=>[e(G,{label:"Tên quốc gia",prop:"tenQuocGia",error:u.tenQuocGia},{default:n(()=>[e(l,{modelValue:s.tenQuocGia,"onUpdate:modelValue":t[2]||(t[2]=i=>s.tenQuocGia=i),placeholder:"Nhập tên quốc gia..."},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(p,{justify:"end",style:{"margin-top":"30px"}},{default:n(()=>[e(r,{onClick:O,style:{"margin-right":"10px"}},{default:n(()=>t[7]||(t[7]=[y("Hủy")])),_:1}),e(r,{type:"primary",onClick:S},{default:n(()=>[y(se(_.value?"Cập nhật":"Lưu"),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ge=Z(de,[["__scopeId","data-v-6ebe3b8b"]]);export{ge as default};
