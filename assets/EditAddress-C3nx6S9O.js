import{_ as x,r as v,z as A,A as k,T as U,o as E,a as d,b as N,d as _,f as n,i as s,y as H,e as i,k as q,h as V,E as c}from"./index-BFtI-PwE.js";import{g as D,u as M}from"./DiaChiServices-RoJFDHKy.js";const S={class:"edit-address-view"},B={class:"switch-container"},I={key:0,class:"note"},R={class:"form-actions"},$={__name:"EditAddress",setup(j){const a=v({id:"",tenNguoiNhan:"",sdtNguoiNhan:"",soNha:"",tenDuong:"",xaPhuong:"",quanHuyen:"",tinhThanhPho:"",diaChiChinh:!1}),u=A(),p=k(),o=U({}),m=v(!1),b=async()=>{Object.keys(o).forEach(t=>delete o[t]);try{const t=u.params.idAddress,e=await D(t);a.value=e,m.value=e.diaChiChinh}catch(t){o.general=t.message||"fail to get address"}};function w(t){m.value===!0&&a.value.diaChiChinh===!1&&(a.value.diaChiChinh=!0,c.error("Không thể bỏ trạng thái địa chỉ chính. Mỗi khách hàng phải có ít nhất một địa chỉ chính."))}const g=async()=>{try{const t=u.params.idAddress,e=await M(t,a.value);console.log(e),c.success("Cập nhật địa chỉ thành công"),setTimeout(()=>{p.push(`/admin/client/addresses/${u.params.idClient}`)},1e3)}catch(t){Array.isArray(t)?t.forEach(({field:e,message:r})=>{o[e]=r}):c.error("Cập nhật địa chỉ thất bại")}},C=()=>{p.push(`/admin/client/addresses/${u.params.idClient}`)};return E(()=>{b()}),(t,e)=>{const r=d("el-input"),h=d("el-form-item"),y=d("el-switch"),f=d("el-button"),P=d("el-form"),T=d("el-card");return _(),N("div",S,[n(T,{shadow:"always"},{header:s(()=>e[8]||(e[8]=[i("div",{class:"card-header"},[i("h2",null,"Chỉnh sửa địa chỉ")],-1)])),default:s(()=>[n(P,{model:a.value,"label-position":"top",onSubmit:H(g,["prevent"]),class:"address-form"},{default:s(()=>[n(h,{label:"Tên người nhận",error:o.tenNguoiNhan,"show-message":!!o.tenNguoiNhan},{default:s(()=>[n(r,{modelValue:a.value.tenNguoiNhan,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.tenNguoiNhan=l),placeholder:"Nhập tên người nhận",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Số điện thoại người nhận",error:o.sdtNguoiNhan,"show-message":!!o.sdtNguoiNhan},{default:s(()=>[n(r,{modelValue:a.value.sdtNguoiNhan,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.sdtNguoiNhan=l),placeholder:"Nhập số điện thoại người nhận",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Số nhà",error:o.soNha,"show-message":!!o.soNha},{default:s(()=>[n(r,{modelValue:a.value.soNha,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.soNha=l),placeholder:"Nhập số nhà",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Tên đường",error:o.tenDuong,"show-message":!!o.tenDuong},{default:s(()=>[n(r,{modelValue:a.value.tenDuong,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.tenDuong=l),placeholder:"Nhập tên đường",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Xã/Phường",error:o.xaPhuong,"show-message":!!o.xaPhuong},{default:s(()=>[n(r,{modelValue:a.value.xaPhuong,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.xaPhuong=l),placeholder:"Nhập xã/phường",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Quận/Huyện",error:o.quanHuyen,"show-message":!!o.quanHuyen},{default:s(()=>[n(r,{modelValue:a.value.quanHuyen,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.quanHuyen=l),placeholder:"Nhập quận/huyện",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Tỉnh/Thành phố",error:o.tinhThanhPho,"show-message":!!o.tinhThanhPho},{default:s(()=>[n(r,{modelValue:a.value.tinhThanhPho,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.tinhThanhPho=l),placeholder:"Nhập tỉnh/thành phố",clearable:""},null,8,["modelValue"])]),_:1},8,["error","show-message"]),n(h,{label:"Địa chỉ chính"},{default:s(()=>[i("div",B,[n(y,{modelValue:a.value.diaChiChinh,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.diaChiChinh=l),onChange:w,"active-color":"#13ce66","inactive-color":"#ff4949"},null,8,["modelValue"]),m.value?(_(),N("span",I," (Địa chỉ chính không thể bỏ chọn) ")):q("",!0)])]),_:1}),n(h,null,{default:s(()=>[i("div",R,[n(f,{type:"primary",onClick:g},{default:s(()=>e[9]||(e[9]=[V(" Lưu ")])),_:1}),n(f,{type:"danger",onClick:C},{default:s(()=>e[10]||(e[10]=[V("Hủy")])),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})])}}},L=x($,[["__scopeId","data-v-59456c0c"]]);export{L as default};
