import{W as $,X as Q,Y as W,Z}from"./ProductAdminService-Cqy2_DSd.js";import{_ as J,u as ee,r as f,T as C,c as T,o as te,w as ae,a as d,b as oe,d as le,f as e,e as D,i as a,h as x,j as L,a6 as ne,l as re,t as se,R as S}from"./index-BFtI-PwE.js";const ue={class:"container mt-4"},ie={class:"table-responsive mb-4",style:{"margin-top":"20px"}},ce={class:"action-buttons-horizontal"},de={class:"pagination-fixed"},me={class:"d-flex justify-content-center align-items-center gap-3"},V=5,pe={__name:"RomAdmin",setup(he){const s=ee(),M=f([]),p=f(1),X=f(1),R=f(0),y=f(""),g=f(!1),_=f(!1),k=f(null),o=C({id:null,dungLuong:"",loai:"",tocDoDocGhi:"",nhaSanXuat:"",namRaMat:null}),l=C({dungLuong:"",loai:"",tocDoDocGhi:"",nhaSanXuat:"",namRaMat:null}),v=async()=>{try{const n=await $(p.value-1,V,y.value.trim());M.value=n.content,X.value=n.totalPages,R.value=n.totalElements}catch(n){console.error("Không thể load dữ liệu:",n)}},w=()=>{o.id=null,o.dungLuong="",o.loai="",o.tocDoDocGhi="",o.nhaSanXuat="Apple",o.namRaMat="",l.dungLuong="",l.loai="",l.tocDoDocGhi="",l.nhaSanXuat="",l.namRaMat=""},B=()=>{l.dungLuong="",l.loai="",l.tocDoDocGhi="",l.nhaSanXuat="",l.namRaMat=""},N=async()=>{if(!k.value)return;const n=_.value?"Bạn có chắc chắn muốn cập nhật ROM này?":"Bạn có chắc chắn muốn thêm mới ROM này?";try{await S.confirm(n,"Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Hủy",type:"warning"}),_.value?(await W(o.id,o),s.success("Cập nhật ROM thành công!")):(await Z(o),s.success("Thêm mới ROM thành công!")),w(),g.value=!1,v()}catch(t){if(t&&t==="cancel"){s.info("Đã hủy thao tác");return}if(Object.keys(l).forEach(c=>l[c]=""),t.response){const{status:c,data:u}=t.response;if(c===400){const i=u.message;if(typeof i=="string")s.error(i);else if(typeof i=="object"){Object.keys(l).forEach(m=>{l[m]=i[m]||""});const h=Object.values(l).filter(Boolean);s.error(h.length?h.join(`
`):"Dữ liệu không hợp lệ!")}else s.error("Dữ liệu không hợp lệ!")}else c===409?s.error(u.message||"Dữ liệu đã tồn tại"):c>=500?s.error("Server lỗi, vui lòng thử lại sau"):s.error(u.message||"Đã xảy ra lỗi không xác định")}else t.request?s.error("Không nhận được phản hồi từ server"):s.error("Lỗi gửi request: "+t.message);console.error("Lỗi submitForm:",t)}},j=async n=>{try{await S.confirm("Bạn có chắc chắn muốn xoá rom này không?","Xác nhận xoá",{confirmButtonText:"Xoá",cancelButtonText:"Huỷ",type:"warning"}),await Q(n),s.success("Xoá thành công!"),v()}catch(t){t!=="cancel"&&s.error("Xoá thất bại! Vui lòng thử lại.")}};T(()=>R.value===0?0:(p.value-1)*V+1),T(()=>Math.min(p.value*V,R.value));const G=n=>{p.value=n},E=()=>{p.value=1,v()},O=()=>{y.value="",p.value=1,v()},U=()=>{w(),g.value=!0,_.value=!1},z=()=>{g.value=!1},A=n=>{_.value=!0,Object.assign(o,n),g.value=!0,B()},P=n=>(p.value-1)*V+n+1;return te(()=>{v()}),ae([p,y],()=>{v()}),(n,t)=>{const c=d("el-input"),u=d("el-col"),i=d("el-button"),h=d("el-row"),m=d("el-table-column"),Y=d("el-table"),F=d("el-pagination"),b=d("el-form-item"),H=d("el-date-picker"),q=d("el-form"),I=d("el-dialog");return le(),oe("div",ue,[e(h,{gutter:20,class:"mb-4 justify-content-center"},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(c,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=r=>y.value=r),placeholder:"Tìm kiếm",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{span:3},{default:a(()=>[e(i,{type:"primary",onClick:E,class:"w-100"},{default:a(()=>t[7]||(t[7]=[x("Tìm kiếm")])),_:1})]),_:1})]),_:1}),e(h,{gutter:20,class:"mb-2",justify:"end"},{default:a(()=>[e(u,{span:3},{default:a(()=>[e(i,{type:"primary",onClick:U,class:"w-100"},{default:a(()=>t[8]||(t[8]=[x("Tạo mới")])),_:1})]),_:1}),e(u,{span:3},{default:a(()=>[e(i,{type:"primary",onClick:O,class:"w-100"},{default:a(()=>t[9]||(t[9]=[x("Làm mới")])),_:1})]),_:1})]),_:1}),t[11]||(t[11]=D("h2",null,"Danh sách rom",-1)),D("div",ie,[e(Y,{data:M.value,border:"",style:{width:"100%"}},{default:a(()=>[e(m,{type:"index",index:P,label:"STT",width:"80"}),e(m,{prop:"dungLuong",label:"Dung lượng",width:"180"}),e(m,{prop:"loai",label:"Loại"}),e(m,{prop:"tocDoDocGhi",label:"Tốc độ đọc ghi"}),e(m,{prop:"nhaSanXuat",label:"Nhà sản xuất"}),e(m,{prop:"namRaMat",label:"Năm ra mắt"}),e(m,{label:"Thao tác",width:"180"},{default:a(({row:r})=>[D("div",ce,[e(i,{size:"small",type:"primary",icon:L(ne),circle:"",onClick:K=>A(r)},null,8,["icon","onClick"]),e(i,{size:"small",type:"danger",icon:L(re),circle:"",onClick:K=>j(r.id)},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])]),D("div",de,[D("div",me,[e(F,{background:"",layout:"prev, pager, next","page-size":V,"current-page":p.value,total:R.value,"pager-count":7,"prev-text":"< Trước","next-text":"Sau >",onCurrentChange:G},null,8,["current-page","total"])])]),e(I,{modelValue:g.value,"onUpdate:modelValue":t[6]||(t[6]=r=>g.value=r),title:_.value?"Chỉnh sửa rom":"Thêm mới rom",width:"900px","close-on-click-modal":!1,"destroy-on-close":!0},{default:a(()=>[e(q,{model:o,ref_key:"formRef",ref:k,"label-width":"140px","label-position":"left",class:"hdh-form"},{default:a(()=>[e(h,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(b,{label:"Dung lượng",prop:"dungLuong",error:l.dungLuong},{default:a(()=>[e(c,{modelValue:o.dungLuong,"onUpdate:modelValue":t[1]||(t[1]=r=>o.dungLuong=r),placeholder:"Nhập dung lượng (ví dụ: 128GB)",autocomplete:"on"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(u,{span:12},{default:a(()=>[e(b,{label:"Loại",prop:"loai",error:l.loai},{default:a(()=>[e(c,{modelValue:o.loai,"onUpdate:modelValue":t[2]||(t[2]=r=>o.loai=r),placeholder:"Nhập loại bộ nhớ (ví dụ: NVMe)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(h,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(b,{label:"Nhà sản xuất",prop:"nhaSanXuat",error:l.nhaSanXuat},{default:a(()=>[e(c,{modelValue:o.nhaSanXuat,"onUpdate:modelValue":t[3]||(t[3]=r=>o.nhaSanXuat=r),placeholder:"Nhập tên nhà sản xuất (ví dụ: Apple)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(u,{span:12},{default:a(()=>[e(b,{label:"Năm ra mắt",prop:"namRaMat",error:l.namRaMat},{default:a(()=>[e(H,{modelValue:o.namRaMat,"onUpdate:modelValue":t[4]||(t[4]=r=>o.namRaMat=r),type:"date","value-format":"YYYY-MM-DD",placeholder:"Chọn ngày ra mắt",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(h,{gutter:20},{default:a(()=>[e(u,null,{default:a(()=>[e(b,{label:"Tốc độ đọc ghi",prop:"tocDoDocGhi",error:l.tocDoDocGhi},{default:a(()=>[e(c,{modelValue:o.tocDoDocGhi,"onUpdate:modelValue":t[5]||(t[5]=r=>o.tocDoDocGhi=r),placeholder:"Nhập tốc độ đọc/ghi (ví dụ: 3500MB/s)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(h,{justify:"end",style:{"margin-top":"30px"}},{default:a(()=>[e(i,{onClick:z,style:{"margin-right":"10px"}},{default:a(()=>t[10]||(t[10]=[x("Hủy")])),_:1}),e(i,{type:"primary",onClick:N},{default:a(()=>[x(se(_.value?"Cập nhật":"Lưu"),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},_e=J(pe,[["__scopeId","data-v-2dd98960"]]);export{_e as default};
