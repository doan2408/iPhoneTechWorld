import{aa as J,ab as W,ac as Y,ad as Z}from"./ProductAdminService-Cqy2_DSd.js";import{_ as ee,u as ae,r as h,T as j,c as D,o as te,w as v,a as d,b as le,d as ne,f as e,e as y,i as l,h as b,j as S,a6 as oe,l as se,t as re,R as M,E as P}from"./index-BFtI-PwE.js";const ie={class:"container mt-4"},ue={class:"table-responsive mb-4",style:{"margin-top":"20px"}},ce={class:"action-buttons-horizontal"},de={class:"pagination-fixed"},pe={class:"d-flex justify-content-center align-items-center gap-3"},x=5,me={__name:"NhaCungCapAdmin",setup(he){const i=ae(),B=h([]),p=h(1),U=h(1),N=h(0),_=h(""),g=h(!1),f=h(!1),k=h(null),n=j({id:null,tenNhaCungCap:"",diaChi:"",sdt:"",email:""}),o=j({tenNhaCungCap:"",diaChi:"",sdt:"",email:""});D(()=>N.value===0?0:(p.value-1)*x+1),D(()=>Math.min(p.value*x,N.value));const V=async()=>{try{const t=await J(p.value-1,x,_.value);B.value=t.content,U.value=t.totalPages,N.value=t.totalElements}catch(t){console.error("Không thể load dữ liệu:",t)}},T=()=>{n.id=null,n.tenNhaCungCap="",n.diaChi="",n.sdt="",n.email=""},E=()=>{o.tenNhaCungCap="",o.diaChi="",o.sdt="",o.email=""},z=()=>{p.value=1},L=()=>{_.value="",p.value=1},X=async()=>{if(k.value)try{await M.confirm("Bạn có chắc chắn muốn thêm dung lượng rom này?","Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Huỷ",type:"warning"}),await k.value.validate(),f.value?(await Y(n.id,n),i.success("Cập nhật nhà cung cấp thành công!")):(await Z(n),i.success("Thêm mới nhà cung cấp thành công!")),T(),g.value=!1,V()}catch(t){if(t==="cancel"||t==="close"){i.info("Đã hủy thao tác");return}if(o.tenNhaCungCap=t.message.tenNhaCungCap||"",o.diaChi=t.message.diaChi||"",o.sdt=t.message.sdt||"",o.email=t.message.email||"",t.response){const a=t.response.status,m=t.response.data;if(a===400){const r=m.message;if(typeof r=="string")i.error(r);else if(typeof r=="object"){Object.keys(o).forEach(c=>{o[c]=r[c]||""});const u=Object.values(o).filter(c=>c);i.error(u.length?u.join(`
`):"Dữ liệu không hợp lệ!")}else i.error("Dữ liệu không hợp lệ!")}else a===409?i.error(m.message||"Dữ liệu đã tồn tại"):a>=500?i.error("Server lỗi, vui lòng thử lại sau"):i.error(m.message||"Đã xảy ra lỗi không xác định")}else t.request?i.error("Không nhận được phản hồi từ server"):i.error("Lỗi gửi request: "+t.message)}},A=t=>{f.value=!0,Object.assign(n,t),g.value=!0,E()},H=()=>{T(),f.value=!1,g.value=!0},R=()=>{g.value=!1,f.value=!1,T(),E()},O=async t=>{try{await M.confirm("Bạn có chắc chắn muốn xoá nhà cung cấp này không?","Xác nhận xoá",{confirmButtonText:"Xoá",cancelButtonText:"Huỷ",type:"warning"}),await W(t),P.success("Xoá thành công!"),V()}catch(a){a!=="cancel"&&P.error("Xoá thất bại! Vui lòng thử lại.")}},q=t=>(p.value-1)*x+t+1,F=t=>{p.value=t};return te(()=>{V()}),v([p,_],()=>{V()}),v(()=>n.tenNhaCungCap,()=>{o.tenNhaCungCap=""}),v(()=>n.diaChi,()=>{o.diaChi=""}),v(()=>n.sdt,()=>{o.sdt=""}),v(()=>n.email,()=>{o.email=""}),(t,a)=>{const m=d("el-input"),r=d("el-col"),u=d("el-button"),c=d("el-row"),C=d("el-table-column"),I=d("el-table"),K=d("el-pagination"),w=d("el-form-item"),Q=d("el-form"),$=d("el-dialog");return ne(),le("div",ie,[e(c,{gutter:20,class:"mb-4 justify-content-center"},{default:l(()=>[e(r,{span:6},{default:l(()=>[e(m,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=s=>_.value=s),placeholder:"Tìm kiếm",clearable:""},null,8,["modelValue"])]),_:1}),e(r,{span:3},{default:l(()=>[e(u,{type:"primary",onClick:z,class:"w-100"},{default:l(()=>a[6]||(a[6]=[b("Tìm kiếm")])),_:1})]),_:1})]),_:1}),e(c,{gutter:20,class:"mb-2",justify:"end"},{default:l(()=>[e(r,{span:3},{default:l(()=>[e(u,{type:"primary",onClick:H,class:"w-100"},{default:l(()=>a[7]||(a[7]=[b("Tạo mới")])),_:1})]),_:1}),e(r,{span:3},{default:l(()=>[e(u,{type:"primary",onClick:L,class:"w-100"},{default:l(()=>a[8]||(a[8]=[b("Làm mới")])),_:1})]),_:1})]),_:1}),a[10]||(a[10]=y("h2",null,"Danh nhà cung cấp",-1)),y("div",ue,[e(I,{data:B.value,border:"",style:{width:"100%"}},{default:l(()=>[e(C,{type:"index",index:q,label:"STT",width:"80"}),e(C,{prop:"tenNhaCungCap",label:"Tên nhà cung cấp"}),e(C,{prop:"diaChi",label:"Địa chỉ"}),e(C,{prop:"sdt",label:"Số điện thoại"}),e(C,{prop:"email",label:"Email"}),e(C,{label:"Thao tác",width:"180"},{default:l(({row:s})=>[y("div",ce,[e(u,{size:"small",type:"primary",icon:S(oe),onClick:G=>A(s),circle:""},null,8,["icon","onClick"]),e(u,{size:"small",type:"danger",icon:S(se),circle:"",onClick:G=>O(s.id)},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])]),y("div",de,[y("div",pe,[e(K,{background:"",layout:"prev, pager, next","page-size":x,"current-page":p.value,total:N.value,"pager-count":7,"prev-text":"< Trước","next-text":"Sau >",onCurrentChange:F},null,8,["current-page","total"])])]),e($,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=s=>g.value=s),title:f.value?"Chỉnh sửa nhà cung cấp":"Thêm mới nhà cung cấp",width:"900px","close-on-click-modal":!1,"destroy-on-close":!0},{default:l(()=>[e(Q,{model:n,ref_key:"formRef",ref:k,"label-width":"140px","label-position":"left",class:"hdh-form"},{default:l(()=>[e(c,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(w,{label:"Tên nhà cung cấp",prop:"tenNhaCungCap",error:o.tenNhaCungCap},{default:l(()=>[e(m,{modelValue:n.tenNhaCungCap,"onUpdate:modelValue":a[1]||(a[1]=s=>n.tenNhaCungCap=s),placeholder:"Nhập tên nhà cung cấp (ví dụ: Công ty ABC)",autocomplete:"on"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(r,{span:12},{default:l(()=>[e(w,{label:"Địa chỉ",prop:"diaChi",error:o.diaChi},{default:l(()=>[e(m,{modelValue:n.diaChi,"onUpdate:modelValue":a[2]||(a[2]=s=>n.diaChi=s),placeholder:"Nhập địa chỉ (ví dụ: 123 Lê Lợi, Q.1, TP.HCM)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(c,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(w,{label:"Số điện thoại",prop:"sdt",error:o.sdt},{default:l(()=>[e(m,{modelValue:n.sdt,"onUpdate:modelValue":a[3]||(a[3]=s=>n.sdt=s),placeholder:"Nhập số điện thoại (ví dụ: 0901234567)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(r,{span:12},{default:l(()=>[e(w,{label:"Email",prop:"email",error:o.email},{default:l(()=>[e(m,{modelValue:n.email,"onUpdate:modelValue":a[4]||(a[4]=s=>n.email=s),placeholder:"Nhập email (ví dụ: example@gmail.com)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(c,{justify:"end",style:{"margin-top":"30px"}},{default:l(()=>[e(u,{onClick:R,style:{"margin-right":"10px"}},{default:l(()=>a[9]||(a[9]=[b("Hủy")])),_:1}),e(u,{type:"primary",onClick:X},{default:l(()=>[b(re(f.value?"Cập nhật":"Lưu"),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ce=ee(me,[["__scopeId","data-v-216c0747"]]);export{Ce as default};
