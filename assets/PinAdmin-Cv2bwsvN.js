import{S as K,T as Q,U as J,V as Y}from"./ProductAdminService-BjtVeFMT.js";import{_ as Z,u as ee,r as g,T as B,c as C,o as ne,w as ae,a as d,b as te,d as oe,f as e,e as y,i as a,h as b,j as P,a6 as le,l as se,t as ie,E as L,R as j}from"./index-I05jmhuU.js";const re={class:"container mt-4"},ue={class:"table-responsive mb-4",style:{"margin-top":"20px"}},ce={class:"action-buttons-horizontal"},de={class:"pagination-fixed"},pe={class:"d-flex justify-content-center align-items-center gap-3"},D=5,me={__name:"PinAdmin",setup(he){const i=ee(),k=g([]),p=g(1),G=g(1),T=g(0),f=g(""),_=g(!1),S=g(!1),V=g(null),t=B({id:null,phienBan:"",congSuatSac:"",thoiGianSuDung:"",soLanSacToiDa:""}),l=B({phienBan:"",congSuatSac:"",thoiGianSuDung:"",soLanSacToiDa:""}),v=async()=>{try{const o=await K(p.value-1,D,f.value);k.value=o.content,G.value=o.totalPages,T.value=o.totalElements}catch{L.error("Lỗi khi tải dữ liệu")}},E=async()=>{if(!V.value)return;const o=S.value?"Bạn có chắc chắn muốn cập nhật Pin này?":"Bạn có chắc chắn muốn thêm mới Pin này?";try{await j.confirm(o,"Xác nhận",{confirmButtonText:"Đồng ý",cancelButtonText:"Hủy",type:"warning"}),await V.value.validate(),S.value?(await J(t.id,t),i.success("Cập nhật pin thành công!")):(await Y(t),i.success("Thêm mới pin thành công!")),w(),_.value=!1,v()}catch(n){if(!n.response&&!n.request){i.info("Đã hủy thao tác");return}if(l.phienBan="",l.congSuatSac="",l.thoiGianSuDung="",l.soLanSacToiDa="",n.response){const m=n.response.status,r=n.response.data;if(m===400){const u=r.message;if(typeof u=="string")L.error(u);else if(typeof u=="object"){Object.keys(l).forEach(c=>{l[c]=u[c]||""});const h=Object.values(l).filter(c=>c);i.error(h.length?h.join(`
`):"Dữ liệu không hợp lệ!")}else i.error("Dữ liệu không hợp lệ!")}else m===409?i.error(r.message||"Dữ liệu đã tồn tại"):m>=500?i.error("Server lỗi, vui lòng thử lại sau"):i.error(r.message||"Đã xảy ra lỗi không xác định")}else n.request?i.error("Không nhận được phản hồi từ server"):i.error("Lỗi gửi request: "+n.message);console.error("Lỗi submitForm:",n)}},M=async o=>{try{await j.confirm("Bạn có chắc chắn muốn xoá pin này không?","Xác nhận xoá",{confirmButtonText:"Xoá",cancelButtonText:"Huỷ",type:"warning"}),await Q(o),i.success("Xoá thành công!"),v()}catch(n){if(!n.response&&!n.request){i.info("Đã hủy thao tác");return}}};C(()=>T.value===0?0:(p.value-1)*D+1),C(()=>Math.min(p.value*D,T.value));const w=()=>{t.id=null,t.congSuatSac="",t.phienBan="",t.thoiGianSuDung="",t.soLanSacToiDa=""},N=()=>{l.congSuatSac="",l.phienBan="",l.thoiGianSuDung="",l.soLanSacToiDa=""},U=()=>{f.value="",p.value=1,v()},z=()=>{w(),_.value=!0},q=()=>{_.value=!1},R=o=>{S.value=!0,Object.assign(t,o),_.value=!0,N()},X=()=>{f.value="",p.value=1,v()},A=o=>(p.value-1)*D+o+1,F=o=>{p.value=o};return ne(()=>{v()}),ae([p,f],()=>{v()}),(o,n)=>{const m=d("el-input"),r=d("el-col"),u=d("el-button"),h=d("el-row"),c=d("el-table-column"),H=d("el-table"),O=d("el-pagination"),x=d("el-form-item"),I=d("el-form"),W=d("el-dialog");return oe(),te("div",re,[e(h,{gutter:20,class:"mb-4 justify-content-center"},{default:a(()=>[e(r,{span:6},{default:a(()=>[e(m,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=s=>f.value=s),placeholder:"Tìm kiếm",clearable:""},null,8,["modelValue"])]),_:1}),e(r,{span:3},{default:a(()=>[e(u,{type:"primary",onClick:U,class:"w-100"},{default:a(()=>n[6]||(n[6]=[b("Tìm kiếm")])),_:1})]),_:1})]),_:1}),e(h,{gutter:20,class:"mb-2",justify:"end"},{default:a(()=>[e(r,{span:3},{default:a(()=>[e(u,{type:"primary",onClick:z,class:"w-100"},{default:a(()=>n[7]||(n[7]=[b("Tạo mới")])),_:1})]),_:1}),e(r,{span:3},{default:a(()=>[e(u,{type:"primary",onClick:X,class:"w-100"},{default:a(()=>n[8]||(n[8]=[b("Làm mới")])),_:1})]),_:1})]),_:1}),n[10]||(n[10]=y("h2",null,"Danh sách pin",-1)),y("div",ue,[e(H,{data:k.value,border:"",style:{width:"100%"}},{default:a(()=>[e(c,{type:"index",index:A,label:"STT",width:"80"}),e(c,{prop:"phienBan",label:"Phiên bản"}),e(c,{prop:"congSuatSac",label:"Công suất"}),e(c,{prop:"thoiGianSuDung",label:"Thời gian sử dụng"}),e(c,{prop:"soLanSacToiDa",label:"Số lần sạc tối đa"}),e(c,{label:"Thao tác",width:"180"},{default:a(({row:s})=>[y("div",ce,[e(u,{size:"small",type:"primary",icon:P(le),onClick:$=>R(s),circle:""},null,8,["icon","onClick"]),e(u,{size:"small",type:"danger",icon:P(se),circle:"",onClick:$=>M(s.id)},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])]),y("div",de,[y("div",pe,[e(O,{background:"",layout:"prev, pager, next","page-size":D,"current-page":p.value,total:T.value,"pager-count":7,"prev-text":"< Trước","next-text":"Sau >",onCurrentChange:F},null,8,["current-page","total"])])]),e(W,{modelValue:_.value,"onUpdate:modelValue":n[5]||(n[5]=s=>_.value=s),title:S.value?"Chỉnh sửa pin":"Thêm mới pin",width:"900px","close-on-click-modal":!1,"destroy-on-close":!0},{default:a(()=>[e(I,{model:t,ref_key:"formRef",ref:V,rules:o.rules,"label-width":"140px","label-position":"left",class:"hdh-form"},{default:a(()=>[e(h,{gutter:20},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(x,{label:"Phiên bản",prop:"phienBan",error:l.phienBan},{default:a(()=>[e(m,{modelValue:t.phienBan,"onUpdate:modelValue":n[1]||(n[1]=s=>t.phienBan=s),placeholder:"Nhập tên phiên bản (ví dụ: Pro, Pro Max)",autocomplete:"on"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(r,{span:12},{default:a(()=>[e(x,{label:"Công suất sạc",prop:"congSuatSac",error:l.congSuatSac},{default:a(()=>[e(m,{modelValue:t.congSuatSac,"onUpdate:modelValue":n[2]||(n[2]=s=>t.congSuatSac=s),placeholder:"Nhập công suất sạc (ví dụ: 67W, 120W)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(h,{gutter:20},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(x,{label:"Thời gian sử dụng",prop:"thoiGianSuDung",error:l.thoiGianSuDung},{default:a(()=>[e(m,{modelValue:t.thoiGianSuDung,"onUpdate:modelValue":n[3]||(n[3]=s=>t.thoiGianSuDung=s),placeholder:"Nhập thời gian sử dụng (ví dụ: 12 giờ, 1 ngày)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(r,{span:12},{default:a(()=>[e(x,{label:"Số lần sạc tối đa",prop:"soLanSacToiDa",error:l.soLanSacToiDa},{default:a(()=>[e(m,{modelValue:t.soLanSacToiDa,"onUpdate:modelValue":n[4]||(n[4]=s=>t.soLanSacToiDa=s),placeholder:"Nhập số lần sạc tối đa (ví dụ: 1000 lần)"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(h,{justify:"end",style:{"margin-top":"30px"}},{default:a(()=>[e(u,{onClick:q,style:{"margin-right":"10px"}},{default:a(()=>n[9]||(n[9]=[b("Hủy")])),_:1}),e(u,{type:"primary",onClick:E},{default:a(()=>[b(ie(S.value?"Cập nhật":"Lưu"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},_e=Z(me,[["__scopeId","data-v-d40916bc"]]);export{_e as default};
