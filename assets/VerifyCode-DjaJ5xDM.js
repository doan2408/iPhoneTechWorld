import{_ as x,A as b,z as k,r as s,o as V,J as M,b as m,d as v,e as t,k as h,h as f,t as u,j as N,n as w,v as C,U as I,y as T}from"./index-BFtI-PwE.js";import{v as q}from"./ForgotPass-Df9Bt09P.js";const B={class:"verify-code-container"},U=["disabled"],z={key:0,class:"error"},D={key:1,class:"success"},E={__name:"VerifyCode",setup(R){const y=b(),i=k().query.email||"",l=s(""),n=s(!1),a=s(""),p=s(!1),c=s(60),o=s(!1);let r=null;V(()=>{r=setInterval(()=>{c.value>0?c.value-=1:(o.value=!0,clearInterval(r))},1e3)});const g=async()=>{if(o.value){a.value="Mã xác thực đã hết hạn. Vui lòng yêu cầu mã mới.";return}a.value="",n.value=!0;try{const d=await q(i,l.value);p.value=!0,setTimeout(()=>{y.push({path:"/reset-password",query:{email:i,code:l.value}})},1e3)}catch(d){a.value=d.message||"Mã không đúng hoặc đã hết hạn."}finally{n.value=!1}};return M(()=>{r&&clearInterval(r)}),(d,e)=>(v(),m("div",B,[e[3]||(e[3]=t("h2",null,"Xác minh mã xác thực",-1)),t("p",null,[e[2]||(e[2]=f(" Nhập mã gồm 6 chữ số đã gửi đến email: ")),t("b",null,[f(u(N(i))+" ",1),e[1]||(e[1]=t("i",{class:"bi bi-person-check-fill"},null,-1))])]),t("p",{class:w(["timer",{expired:o.value}])},u(o.value?"Mã đã hết hạn":`Thời gian còn lại: ${c.value} giây`),3),t("form",{onSubmit:T(g,["prevent"])},[C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=_=>l.value=_),type:"text",maxlength:"6",placeholder:"Nhập mã xác thực",required:""},null,512),[[I,l.value]]),t("button",{type:"submit",disabled:n.value},u(n.value?"Đang kiểm tra...":"Xác minh"),9,U)],32),a.value?(v(),m("p",z,u(a.value),1)):h("",!0),p.value?(v(),m("p",D,"✅ Mã hợp lệ! Đang chuyển hướng...")):h("",!0)]))}},A=x(E,[["__scopeId","data-v-6f8269f4"]]);export{A as default};
