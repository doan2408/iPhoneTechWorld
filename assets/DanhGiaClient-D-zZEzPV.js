import{_ as De,u as fe,r as y,c as Q,o as oe,a as Z,b as u,d,e as o,f as O,k as T,v as Ce,j as ee,U as Pe,n as $,F as b,m as G,t as P,h as F,B as Se,i as he}from"./index-BFtI-PwE.js";import{p as _e,e as ne}from"./MyOrderClient-P-Z6Ygnv.js";import{S as we,R as ke,M as A}from"./DialogDanhGiaSao-ChBSq0JL.js";import{D as M}from"./DanhGiaSanPhamClientService-DHhPE4UI.js";import{P as He}from"./PhanHoiDanhGiaClientService-iDK6Xo3n.js";import{l as be}from"./lodash-BgakiGRg.js";import"./createLucideIcon-Bz9RgSCD.js";const Ge={class:"page-container"},$e={class:"main-content"},Le={class:"header"},Ae={class:"header-right"},Me={class:"search-container"},Re={class:"tabs-container"},Ie={class:"tabs-list"},Ne={key:0,class:"loading-state"},xe={key:1,class:"empty-state"},Ee={key:2,class:"order-list"},Ve={class:"order-products"},je=["src","alt"],Ke={class:"product-details"},Oe={class:"product-name"},Fe={class:"product-variant"},Be={class:"product-quantity"},ze={key:0,class:"remaining-time"},Ue={key:1,class:"review-details"},qe={class:"review-section"},We={class:"star-rating-section"},Je={class:"star-rating"},Ye={key:0,class:"review-content"},Xe={key:1,class:"review-media"},Qe={class:"media-container"},Ze={class:"image-error"},en=["src"],nn={key:2,class:"remaining-time"},an={key:2,class:"review-details"},tn={class:"review-section"},sn={class:"star-rating-section"},on={class:"star-rating"},hn={key:0,class:"review-content"},rn={key:1,class:"review-media"},ln={class:"media-container"},cn=["src","alt"],dn=["src"],un={key:2,class:"seller-response"},gn={class:"product-prices"},mn={class:"discounted-price"},vn={class:"order-footer"},pn={class:"order-total"},yn={class:"total-amount"},Tn={class:"order-actions"},Dn=["onClick"],fn=["onClick"],Cn={key:3,class:"pagination-controls"},Pn=["disabled"],Sn=["onClick"],_n=["disabled"],wn={__name:"DanhGiaClient",setup(kn){const c=fe(),B=y([]),L=y([]),R=y(5);y(0),y(0);const f=y(0),z=y(""),w=y("Chưa đánh giá"),I=y(!1),U=y(null),S=y([]),N=y([]),k=y(JSON.parse(localStorage.getItem("user"))||null),q=y(!1),x=y(!1),E=y([]),V=s=>{if(!s)return!1;const n=new Date(s);return isNaN(n)?!1:(new Date-n)/(1e3*3600*24)<=7},W=s=>{if(console.log("isWithin24Hours called with reviews:",s),!s||typeof s!="object")return!1;const n=Object.values(s)[0];if(!(n!=null&&n.ngayDanhGia))return!1;const g=new Date(n.ngayDanhGia);return isNaN(g)?!1:(new Date-g)/(1e3*3600)<=24},re=s=>{if(!s)return"Hết hạn";const n=new Date(s);if(isNaN(n))return"Hết hạn";const g=new Date;n.setHours(0,0,0,0),g.setHours(0,0,0,0);const e=7-(g-n)/(1e3*3600*24);return e>0?`Còn ${e} ngày để đánh giá`:"Hết hạn"},le=s=>{if(!s||typeof s!="object")return"Hết hạn sửa";const n=Object.values(s)[0];if(!(n!=null&&n.ngayDanhGia))return"Hết hạn sửa";const g=new Date(n.ngayDanhGia);if(isNaN(g))return"Hết hạn sửa";const i=24-(new Date-g)/(1e3*3600);return i>0?`Còn ${Math.ceil(i)} giờ để sửa đánh giá`:"Hết hạn sửa"},J=Q(()=>Math.ceil(L.value.length/R.value)),ce=Q(()=>{const s=f.value*R.value;return L.value.slice(s,s+R.value)}),de=Q(()=>{const n=Math.max(1,f.value-Math.floor(2.5)),g=Math.min(J.value,n+5-1);return Array.from({length:g-n+1},(v,r)=>n+r)});oe(()=>{window.Tawk_API=window.Tawk_API||{},window.Tawk_LoadStart=new Date;const s=document.createElement("script"),n=document.getElementsByTagName("script")[0];s.async=!0,s.src="https://embed.tawk.to/68836581db7610192eeaacd6/1j10k90i5",s.charset="UTF-8",s.setAttribute("crossorigin","*"),n.parentNode.insertBefore(s,n)});const ie=be.debounce(()=>{f.value=0,j()},500),ae=s=>new Intl.NumberFormat("vi-VN").format(s),j=async()=>{var s;try{if(!((s=k.value)!=null&&s.id)){c.error("Vui lòng đăng nhập để xem đơn hàng!");return}q.value=!0;const n=await _e(0,1e3,k.value.id,z.value),g=Array.isArray(n.data.content)?n.data.content:[];console.log("Orders fetched:",g);const v=await Promise.all(g.map(async r=>{try{const e=await M.checkDanhGiaVaDaPhanHoi(r.idHoaDon,k.value.id);let i={};if(e.da_danh_gia){const a=await M.layDanhGiaTheoHoaDon(r.idHoaDon);console.log(`layDanhGiaTheoHoaDon for order ${r.idHoaDon}:`,a),Array.isArray(a.data)&&(i=await Promise.all(a.data.map(async l=>{const _=Array.isArray(l.reviewClientResponsesList)?l.reviewClientResponsesList:[];let p="",C=!1,K="";if(l.idDanhGia)try{const t=await He.layPhanHoiTheoDanhGia(l.idDanhGia);Array.isArray(t)&&t.length>0&&(p=t[0].noiDungPhanHoi||"",C=!0,K=t[0].ngayPhanHoi||""),console.log(`phanHoi set for review ${l.idDanhGia}:`,p)}catch(t){console.error(`Lỗi khi lấy phản hồi cho đánh giá ${l.idDanhGia}:`,t)}return{[l.idSanPhamChiTiet]:{soSao:l.soSao,noiDung:l.noiDung||"",media:_.map(t=>({id:t.idMedia,url:t.urlMedia,type:t.loaiMedia.toLowerCase()})),phanHoi:p,coPhanHoi:C,ngayPhanHoi:K,idDanhGia:l.idDanhGia,ngayDanhGia:l.ngayDanhGia||null}}})).then(l=>l.reduce((p,C)=>({...p,...C}),{})))}return{...r,daDanhGia:e.da_danh_gia??!1,coPhanHoi:e.co_phan_hoi??!1,reviews:i}}catch{return{...r,daDanhGia:!1,coPhanHoi:!1,reviews:{}}}}));B.value=v,L.value=v.filter(r=>{const e=V(r.ngayThanhToan);return w.value==="Chưa đánh giá"?!r.daDanhGia&&r.trangThaiThanhToan==="Hoàn tất"&&e:w.value==="Đã đánh giá"?r.daDanhGia&&r.trangThaiThanhToan==="Hoàn tất":w.value==="Đánh giá có phản hồi"?r.daDanhGia&&r.coPhanHoi&&r.trangThaiThanhToan==="Hoàn tất":!0})}catch{c.error("Không thể tải danh sách đơn hàng. Vui lòng thử lại.")}finally{q.value=!1}},ue=s=>{f.value=s},ge=()=>{f.value>0&&f.value--},me=()=>{f.value<J.value-1&&f.value++},Y=s=>{w.value=s,f.value=0,j()},ve=()=>{var s;(s=window.Tawk_API)!=null&&s.toggle?window.Tawk_API.toggle():(window.Tawk_API.onLoad=()=>window.Tawk_API.toggle(),setTimeout(()=>{var n;(n=window.Tawk_API)!=null&&n.toggle||c.error("Không thể mở chat. Vui lòng thử lại sau.")},5e3))},pe=async(s,n)=>{var v,r;if(!((v=k.value)!=null&&v.id)){c.error("Vui lòng đăng nhập để đánh giá!");return}const g=B.value.find(e=>e.idHoaDon===s);if(!g){c.error("Không tìm thấy đơn hàng!");return}if(!V(g.ngayThanhToan)){c.error("Đơn hàng đã quá 7 ngày kể từ ngày thanh toán, không thể đánh giá!");return}U.value=s,S.value=Array.from(n),x.value=!1,E.value=[];try{const e=await ne(s);if(!Array.isArray(e.data)){c.error("Dữ liệu chi tiết hóa đơn không hợp lệ!");return}if(N.value=e.data.map(i=>{var a;return{idSanPhamChiTiet:i.idSanPhamChiTiet,idChiTietHoaDon:i.idChiTietHoaDon,tenSanPham:((a=n.find(l=>l.idSanPhamChiTiet===i.idSanPhamChiTiet))==null?void 0:a.tenSanPham)||"Unknown"}}),S.value=S.value.map(i=>{var a;return{...i,idChiTietHoaDon:((a=e.data.find(l=>l.idSanPhamChiTiet===i.idSanPhamChiTiet))==null?void 0:a.idChiTietHoaDon)||null}}),S.value.some(i=>!i.idSanPhamChiTiet||!i.idChiTietHoaDon)){c.error("Dữ liệu sản phẩm không hợp lệ!");return}I.value=!0}catch(e){console.error("Lỗi trong openEditRateDialog:",e);let i="Lỗi không xác định";if(e.response){const a=e.response.status,l=((r=e.response.data)==null?void 0:r.message)||"Lỗi từ server";a===400?i=`Yêu cầu không hợp lệ: ${l}`:a===404?i=`Không tìm thấy tài nguyên: ${l}`:a===500?i=`Lỗi máy chủ: ${l}`:i=`Gửi/cập nhật đánh giá thất bại: ${l}`}else i=`Lỗi kết nối hoặc client: ${e.message}`;c.error(i)}},ye=async(s,n)=>{var v,r;if(console.log("openEditRateDialog called with:",{orderId:s,products:n}),!((v=k.value)!=null&&v.id)){console.warn("User not logged in"),c.error("Vui lòng đăng nhập để sửa đánh giá!");return}const g=B.value.find(e=>e.idHoaDon===s);if(!g){c.error("Không tìm thấy đơn hàng!");return}if(!W(g.reviews)){c.error("Đã quá 24 giờ kể từ khi đánh giá, không thể sửa!");return}U.value=s,S.value=Array.from(n),x.value=!0;try{const e=await ne(s);if(console.log("Chi tiết hóa đơn response:",e),!Array.isArray(e.data)){console.error("Invalid chiTietList data:",e),c.error("Dữ liệu chi tiết hóa đơn không hợp lệ!");return}if(N.value=e.data.map(a=>{var l;return{idSanPhamChiTiet:a.idSanPhamChiTiet,idChiTietHoaDon:a.idChiTietHoaDon,tenSanPham:((l=n.find(_=>_.idSanPhamChiTiet===a.idSanPhamChiTiet))==null?void 0:l.tenSanPham)||"Unknown"}}),console.log("idSanPhamChiTietList:",N.value),S.value=S.value.map(a=>{var l;return{...a,idChiTietHoaDon:((l=e.data.find(_=>_.idSanPhamChiTiet===a.idSanPhamChiTiet))==null?void 0:l.idChiTietHoaDon)||null}}),console.log("selectedOrderProducts:",S.value),S.value.some(a=>!a.idSanPhamChiTiet||!a.idChiTietHoaDon)){console.error("Invalid product data:",S.value),c.error("Dữ liệu sản phẩm không hợp lệ!");return}const i=await M.layDanhGiaTheoHoaDon(s);if(console.log("DanhGia response:",i),!Array.isArray(i.data)||i.data.length===0){console.error("No review data found:",i),c.error("Không tìm thấy dữ liệu đánh giá!");return}E.value=i.data.map(a=>{const _=(Array.isArray(a.reviewClientResponsesList)?a.reviewClientResponsesList:[]).map(p=>({id:p.idMedia,url:p.urlMedia,type:p.loaiMedia.toLowerCase()}));return{idSanPhamChiTiet:a.idSanPhamChiTiet,idChiTietHoaDon:a.idChiTietHoaDon,soSao:a.soSao,noiDung:a.noiDung||"",media:_,idDanhGia:a.idDanhGia,ngayDanhGia:a.ngayDanhGia||null}}),console.log("existingRatingData:",E.value),setTimeout(()=>{I.value=!0,console.log("Dialog opened after timeout")},100)}catch(e){console.error("Lỗi trong openEditRateDialog:",e);let i="Lỗi không xác định";if(e.response){const a=e.response.status,l=((r=e.response.data)==null?void 0:r.message)||"Lỗi từ server";a===400?i=`Yêu cầu không hợp lệ: ${l}`:a===404?i=`Không tìm thấy tài nguyên: ${l}`:a===500?i=`Lỗi máy chủ: ${l}`:i=`Gửi/cập nhật đánh giá thất bại: ${l}`}else i=`Lỗi kết nối hoặc client: ${e.message}`;c.error(i)}},te=()=>{I.value=!1},Te=async({payload:s})=>{var n,g,v;console.log("submitRating nhận payload:",JSON.stringify(s,null,2)),console.log("isEditing trong parent:",x.value);try{if(!((n=k.value)!=null&&n.id)){c.error("Vui lòng đăng nhập để đánh giá!");return}const{idHoaDon:r,ratings:e,trangThaiDanhGia:i}=s;console.log("Đang lấy chiTietList cho idHoaDon:",r);const a=await ne(r);if(!Array.isArray(a.data)||a.data.length===0){console.error("Dữ liệu chiTietList không hợp lệ:",a),c.error("Không tìm thấy chi tiết hóa đơn!");return}if(a.data.length!==e.length){console.error("Số lượng đánh giá không khớp với chiTietList:",{ratingsCount:e.length,chiTietListCount:a.data.length}),c.error("Số lượng đánh giá không khớp với sản phẩm trong hóa đơn!");return}if(!e.every(p=>a.data.some(C=>C.idSanPhamChiTiet===p.idSanPhamChiTiet))){console.error("Dữ liệu đánh giá không hợp lệ:",e),c.error("Một hoặc nhiều sản phẩm đánh giá không thuộc hóa đơn này!");return}const _=e.some(p=>p.idDanhGia);if(console.log("Chế độ xử lý:",_?"Cập nhật":"Tạo mới"),_){console.log("Đang xử lý cập nhật cho ratings:",e);const p=e.map(async t=>{if(!t.idDanhGia)return console.error(`Thiếu idDanhGia cho sản phẩm ${t.idSanPhamChiTiet}`),c.error(`Không thể cập nhật đánh giá cho sản phẩm ${t.idSanPhamChiTiet}!`),{status:"rejected",reason:"Thiếu idDanhGia"};const X={idHoaDon:r,idSanPhamChiTiet:t.idSanPhamChiTiet,idChiTietHoaDon:t.idChiTietHoaDon,idKhachHang:k.value.id,soSao:t.soSao,noiDung:t.noiDung,trangThaiDanhGia:i};try{console.log(`Đang cập nhật đánh giá cho sản phẩm ${t.idSanPhamChiTiet} với idDanhGia ${t.idDanhGia}`);const D=await M.capNhatDanhGia(t.idDanhGia,X);if(console.log(`Cập nhật thành công cho sản phẩm ${t.idSanPhamChiTiet}:`,D),t.deletedMediaIds&&Array.isArray(t.deletedMediaIds)&&t.deletedMediaIds.length>0){console.log(`Đang xóa media cho sản phẩm ${t.idSanPhamChiTiet}:`,t.deletedMediaIds);const h=t.deletedMediaIds.map(async m=>{try{return await A.deleteByIdMedia(m),console.log(`Xóa media ${m} thành công`),{status:"fulfilled",value:m}}catch(se){return console.error(`Lỗi khi xóa media ${m} cho sản phẩm ${t.idSanPhamChiTiet}:`,se),c.error(`Không thể xóa media ${m}`),{status:"rejected",reason:se}}});await Promise.allSettled(h)}const H=[];return Array.isArray(t.imageFiles)&&t.imageFiles.forEach(h=>{h&&h.name&&h.size&&h.type&&H.push(A.uploadMedia(h,t.idDanhGia).then(m=>(console.log(`Tải lên ảnh ${h.name} thành công`),{status:"fulfilled",value:m})).catch(m=>(console.error(`Lỗi khi tải lên ảnh ${h.name} cho sản phẩm ${t.idSanPhamChiTiet}:`,m),c.error(`Không thể tải lên ảnh ${h.name}`),{status:"rejected",reason:m})))}),Array.isArray(t.videoFiles)&&t.videoFiles.forEach(h=>{h&&h.name&&h.size&&h.type&&H.push(A.uploadMedia(h,t.idDanhGia).then(m=>(console.log(`Tải lên video ${h.name} thành công`),{status:"fulfilled",value:m})).catch(m=>(console.error(`Lỗi khi tải lên video ${h.name} cho sản phẩm ${t.idSanPhamChiTiet}:`,m),c.error(`Không thể tải lên video ${h.name}`),{status:"rejected",reason:m})))}),await Promise.allSettled(H),{status:"fulfilled",value:D}}catch(D){return console.error(`Lỗi khi cập nhật đánh giá cho sản phẩm ${t.idSanPhamChiTiet}:`,D),c.error(`Cập nhật đánh giá cho sản phẩm ${t.idSanPhamChiTiet} thất bại`),{status:"rejected",reason:D}}}),C=await Promise.allSettled(p);if(C.some(t=>t.status==="rejected")){console.error("Lỗi cập nhật:",C.filter(t=>t.status==="rejected")),c.error("Cập nhật một số đánh giá thất bại!");return}c.success("Cập nhật đánh giá thành công!")}else{console.log("Đang xử lý tạo mới cho ratings:",e);const p=e.map(async t=>{const X={idHoaDon:r,idSanPhamChiTiet:t.idSanPhamChiTiet,idChiTietHoaDon:t.idChiTietHoaDon,idKhachHang:k.value.id,soSao:t.soSao,noiDung:t.noiDung,trangThaiDanhGia:i};try{const D=await M.taoMoiDanhGia(X);console.log(`Tạo đánh giá cho sản phẩm ${t.idSanPhamChiTiet}:`,D);const H=[];return Array.isArray(t.imageFiles)&&t.imageFiles.forEach(h=>{h&&h.name&&h.size&&h.type&&H.push(A.uploadMedia(h,D.idDanhGia).then(m=>(console.log(`Tải lên ảnh ${h.name} thành công`),{status:"fulfilled",value:m})).catch(m=>(console.error(`Lỗi khi tải lên ảnh ${h.name} cho sản phẩm ${t.idSanPhamChiTiet}:`,m),c.error(`Không thể tải lên ảnh ${h.name}`),{status:"rejected",reason:m})))}),Array.isArray(t.videoFiles)&&t.videoFiles.forEach(h=>{h&&h.name&&h.size&&h.type&&H.push(A.uploadMedia(h,D.idDanhGia).then(m=>(console.log(`Tải lên video ${h.name} thành công`),{status:"fulfilled",value:m})).catch(m=>(console.error(`Lỗi khi tải lên video ${h.name} cho sản phẩm ${t.idSanPhamChiTiet}:`,m),c.error(`Không thể tải lên video ${h.name}`),{status:"rejected",reason:m})))}),await Promise.allSettled(H),{status:"fulfilled",value:D}}catch(D){return console.error(`Lỗi khi tạo đánh giá cho sản phẩm ${t.idSanPhamChiTiet}:`,D),c.error(`Tạo đánh giá cho sản phẩm ${t.idSanPhamChiTiet} thất bại`),{status:"rejected",reason:D}}}),C=await Promise.allSettled(p);if(C.some(t=>t.status==="rejected")){console.error("Lỗi tạo đánh giá:",C.filter(t=>t.status==="rejected")),c.error("Tạo một số đánh giá thất bại!");return}c.success("Gửi đánh giá thành công!")}console.log("Đang làm mới danh sách đơn hàng và đóng dialog"),await j(),te()}catch(r){console.error("Lỗi trong submitRating:",r),c.error(`Gửi/cập nhật đánh giá thất bại: ${((v=(g=r.response)==null?void 0:g.data)==null?void 0:v.message)||"Lỗi không xác định"}`)}};return oe(async()=>{await j()}),(s,n)=>{const g=Z("Picture"),v=Z("el-icon"),r=Z("el-image");return d(),u("div",Ge,[o("main",$e,[o("header",Le,[o("div",Ae,[o("div",Me,[O(ee(we),{class:"search-icon"}),Ce(o("input",{type:"search",placeholder:"Tìm kiếm theo ID đơn hàng hoặc Tên sản phẩm",class:"search-input","onUpdate:modelValue":n[0]||(n[0]=e=>z.value=e),onInput:n[1]||(n[1]=(...e)=>ee(ie)&&ee(ie)(...e))},null,544),[[Pe,z.value]])])])]),o("div",Re,[o("div",Ie,[o("button",{class:$(["tab-trigger",{active:w.value==="Chưa đánh giá"}]),onClick:n[2]||(n[2]=e=>Y("Chưa đánh giá"))}," Chưa đánh giá ",2),o("button",{class:$(["tab-trigger",{active:w.value==="Đã đánh giá"}]),onClick:n[3]||(n[3]=e=>Y("Đã đánh giá"))}," Đã đánh giá ",2),o("button",{class:$(["tab-trigger",{active:w.value==="Đánh giá có phản hồi"}]),onClick:n[4]||(n[4]=e=>Y("Đánh giá có phản hồi"))}," Đánh giá có phản hồi ",2)])]),q.value?(d(),u("div",Ne," Đang tải đơn hàng... ")):L.value.length===0?(d(),u("div",xe," Không tìm thấy đơn hàng nào phù hợp. ")):(d(),u("div",Ee,[(d(!0),u(b,null,G(ce.value,e=>(d(),u("div",{key:e.idHoaDon,class:"order-card"},[o("div",Ve,[(d(!0),u(b,null,G(e.myOrderClientResponseList,i=>(d(),u("div",{key:i.idSanPhamChiTiet,class:"product-item"},[o("img",{src:i.urlImage,alt:i.tenSanPham,class:"product-image"},null,8,je),o("div",Ke,[o("div",Oe,P(i.tenSanPham),1),o("div",Fe," Phân loại: "+P(i.colorName)+" "+P(i.dungLuongRom),1),o("div",Be,"x"+P(i.soLuong),1),w.value==="Chưa đánh giá"&&!e.daDanhGia&&V(e==null?void 0:e.ngayNhanhang)?(d(),u("div",ze,P(re(e==null?void 0:e.ngayNhanhang)),1)):T("",!0),w.value==="Đã đánh giá"&&e.reviews&&e.reviews[i.idSanPhamChiTiet]?(d(),u("div",Ue,[o("div",qe,[n[9]||(n[9]=o("h3",{class:"section-title"},"Đánh giá sản phẩm",-1)),o("div",We,[n[5]||(n[5]=o("h4",{class:"subsection-title"},"Số sao:",-1)),o("div",Je,[(d(),u(b,null,G(5,a=>o("span",{key:a,class:$(["star",{filled:a<=e.reviews[i.idSanPhamChiTiet].soSao}])}," ★ ",2)),64))])]),e.reviews[i.idSanPhamChiTiet].noiDung?(d(),u("div",Ye,[n[6]||(n[6]=o("h4",{class:"subsection-title"},"Nội dung đánh giá:",-1)),n[7]||(n[7]=o("span",{class:"review-label"},"Đánh giá của bạn:",-1)),F(" "+P(e.reviews[i.idSanPhamChiTiet].noiDung),1)])):T("",!0),e.reviews[i.idSanPhamChiTiet].media&&e.reviews[i.idSanPhamChiTiet].media.length?(d(),u("div",Xe,[n[8]||(n[8]=o("h4",{class:"subsection-title"},"Hình ảnh/Video:",-1)),o("div",Qe,[(d(!0),u(b,null,G(e.reviews[i.idSanPhamChiTiet].media,a=>(d(),u("div",{key:a.id,class:"media-item"},[a.type==="image"?(d(),Se(r,{key:0,src:a.url,alt:"Hình ảnh đánh giá "+i.tenSanPham,class:"review-image",fit:"cover","preview-src-list":[a.url],"preview-teleported":""},{error:he(()=>[o("div",Ze,[O(v,null,{default:he(()=>[O(g)]),_:1})])]),_:2},1032,["src","alt","preview-src-list"])):a.type==="video"?(d(),u("video",{key:1,src:a.url,controls:"",class:"review-video"},null,8,en)):T("",!0)]))),128))])])):T("",!0),W(e.reviews)?(d(),u("div",nn,P(le(e.reviews)),1)):T("",!0)])])):T("",!0),w.value==="Đánh giá có phản hồi"&&e.reviews&&e.reviews[i.idSanPhamChiTiet]?(d(),u("div",an,[o("div",tn,[n[16]||(n[16]=o("h3",{class:"section-title"},"Đánh giá sản phẩm",-1)),o("div",sn,[n[10]||(n[10]=o("h4",{class:"subsection-title"},"Số sao:",-1)),o("div",on,[(d(),u(b,null,G(5,a=>o("span",{key:a,class:$(["star",{filled:a<=e.reviews[i.idSanPhamChiTiet].soSao}])}," ★ ",2)),64))])]),e.reviews[i.idSanPhamChiTiet].noiDung?(d(),u("div",hn,[n[11]||(n[11]=o("h4",{class:"subsection-title"},"Nội dung đánh giá:",-1)),n[12]||(n[12]=o("span",{class:"review-label"},"Đánh giá của bạn:",-1)),F(" "+P(e.reviews[i.idSanPhamChiTiet].noiDung),1)])):T("",!0),e.reviews[i.idSanPhamChiTiet].media&&e.reviews[i.idSanPhamChiTiet].media.length?(d(),u("div",rn,[n[13]||(n[13]=o("h4",{class:"subsection-title"},"Hình ảnh/Video:",-1)),o("div",ln,[(d(!0),u(b,null,G(e.reviews[i.idSanPhamChiTiet].media,a=>(d(),u("div",{key:a.id,class:"media-item"},[a.type==="image"?(d(),u("img",{key:0,src:a.url,alt:"Hình ảnh đánh giá "+i.tenSanPham,class:"review-image"},null,8,cn)):a.type==="video"?(d(),u("video",{key:1,src:a.url,controls:"",class:"review-video"},null,8,dn)):T("",!0)]))),128))])])):T("",!0),e.reviews[i.idSanPhamChiTiet].coPhanHoi?(d(),u("div",un,[n[14]||(n[14]=o("h4",{class:"subsection-title"},"Phản hồi từ người bán:",-1)),n[15]||(n[15]=o("span",{class:"response-label"},"Phản hồi:",-1)),F(" "+P(e.reviews[i.idSanPhamChiTiet].phanHoi||"Không có nội dung phản hồi."),1)])):T("",!0)])])):T("",!0)]),o("div",gn,[o("span",mn,P(ae(i.giaSanPham))+" VNĐ",1)])]))),128))]),o("div",vn,[o("div",pn,[n[17]||(n[17]=F(" Thành tiền: ")),o("span",yn,P(ae(e.thanhTien))+" VNĐ",1)]),o("div",Tn,[o("button",{class:"action-button contact-seller-button",onClick:ve}," Liên hệ người bán "),!e.daDanhGia&&V(e==null?void 0:e.ngayNhanhang)?(d(),u("button",{key:0,class:"action-button rate-button",onClick:i=>pe(e.idHoaDon,e.myOrderClientResponseList)}," Đánh giá ",8,Dn)):T("",!0),e.daDanhGia&&!e.coPhanHoi&&W(e.reviews)?(d(),u("button",{key:1,class:"action-button edit-rate-button",onClick:i=>ye(e.idHoaDon,e.myOrderClientResponseList)}," Sửa đánh giá ",8,fn)):T("",!0)])])]))),128))])),L.value.length>R.value?(d(),u("div",Cn,[o("button",{class:"pagination-button",disabled:f.value===0,onClick:ge}," Trước ",8,Pn),(d(!0),u(b,null,G(de.value,e=>(d(),u("button",{key:e,class:$(["pagination-button",{active:f.value===e-1}]),onClick:i=>ue(e-1)},P(e),11,Sn))),128)),o("button",{class:"pagination-button",disabled:f.value===J.value-1,onClick:me}," Sau ",8,_n)])):T("",!0)]),O(ke,{"is-open":I.value,"order-id":U.value,"order-products":S.value,"id-san-pham-chi-tiet-list":N.value,"is-editing":x.value,"existing-rating-data":E.value,onClose:te,onSubmit:Te},null,8,["is-open","order-id","order-products","id-san-pham-chi-tiet-list","is-editing","existing-rating-data"])])}}},Rn=De(wn,[["__scopeId","data-v-7f689b09"]]);export{Rn as default};
