import{_ as ve,r,T as he,w as H,o as me,a as u,b as p,d,e as v,f as e,k as V,i as a,h,j as P,L as ce,ad as Q,t as x,B as pe,a6 as fe,y as _e,E as B}from"./index-BFtI-PwE.js";import{g as ge,d as be,u as ye,a as Ve}from"./NhanVienServices-WPOe5WOD.js";const we={class:"staff-container"},ke={class:"search-section"},Ce={class:"search-container"},Ne={class:"search-input-group"},Te={class:"search-input-wrapper"},Se={key:0,class:"search-status"},Ee={key:0,class:"text-center"},xe={class:"filter-section mb-3"},Me={class:"d-flex gap-2 align-items-center justify-content-between"},Ae={class:"d-flex gap-2 align-items-center"},Ke={key:0,class:"result-count"},Le={key:0},Ue={key:1,class:"error-state"},Be={key:2,class:"search-result-info"},De={key:3,class:"no-data"},Fe={key:0},Ye={key:1},ze={key:4},Pe={style:{"white-space":"normal","word-break":"break-word"}},je={key:0,class:"pagination-fixed"},Ie={class:"d-flex justify-content-center align-items-center gap-3",style:{"margin-top":"30px"}},Ge={class:"dialog-footer"},$e={__name:"StaffAdmin",setup(qe){const M=r([]),f=r(!1),s=r(0),K=r(0),G=r(0),i=r(""),j=r(null),T=r(""),A=r(!1),D=r(!1),S=r(!1),F=r(null),o=r({tenNhanVien:"",taiKhoan:"",matKhau:"",email:"",sdt:"",diaChi:"",trangThai:"ENABLE",chucVu:"STAFF",gioiTinh:!0,namSinh:""}),_=he({}),w=r(null),k=r(null),C=async(n=0,l=null)=>{try{f.value=!0,T.value="";const m=await ge({page:n,keyword:l||i.value||null,gioiTinh:w.value,trangThai:k.value});M.value=m.content||[],s.value=n,K.value=m.totalPages||0,G.value=m.totalElements}catch(m){console.error("Error loading staff:",m),T.value=m.message||"Có lỗi xảy ra khi tải danh sách nhân viên",B.error(T.value),M.value=[]}finally{f.value=!1}},R=()=>{j.value&&clearTimeout(j.value),j.value=setTimeout(()=>{var n;s.value=0,C(0,((n=i.value)==null?void 0:n.trim())||null)},500)},J=()=>{i.value="",s.value=0,C(0,null)};H(i,(n,l)=>{n!==l&&R()}),H([w,k],()=>{var n;s.value=0,C(0,((n=i.value)==null?void 0:n.trim())||null)});const W=()=>{var n;s.value=0,C(s.value,((n=i.value)==null?void 0:n.trim())||null)},Z=()=>{var n;s.value=K.value-1,C(s.value,((n=i.value)==null?void 0:n.trim())||null)},Y=()=>{w.value=null,k.value=null,i.value="",s.value=0,C(0,null)},ee=()=>{A.value=!0,S.value=!1,F.value=null,$(),z()},le=async n=>{A.value=!0,S.value=!0,F.value=n,z();try{f.value=!0;const l=await be(n);Object.assign(o.value,l)}catch(l){console.error("Error loading staff details:",l),B.error(l.message||"Lỗi khi tải thông tin nhân viên"),A.value=!1}finally{f.value=!1}},I=()=>{A.value=!1,$(),z(),S.value=!1,F.value=null},$=()=>{o.value={tenNhanVien:"",taiKhoan:"",matKhau:"",email:"",sdt:"",diaChi:"",trangThai:"ENABLE",chucVu:"STAFF",gioiTinh:!0,namSinh:""}},z=()=>{Object.keys(_).forEach(n=>delete _[n])},q=async()=>{var n;z(),D.value=!0;try{S.value?(await ye(F.value,o.value),B.success("Cập nhật nhân viên thành công")):(await Ve(o.value),B.success("Thêm nhân viên thành công")),I(),C(s.value,((n=i.value)==null?void 0:n.trim())||null)}catch(l){console.error("Error submitting staff:",l),Array.isArray(l)?l.forEach(({field:m,message:g})=>{_[m]=g}):B.error(S.value?"Cập nhật nhân viên thất bại":"Thêm nhân viên thất bại")}finally{D.value=!1}},ae=async n=>{var l;s.value=n-1,await C(s.value,((l=i.value)==null?void 0:l.trim())||null)};return me(()=>{C()}),(n,l)=>{const m=u("el-icon"),g=u("el-button"),te=u("el-divider"),E=u("el-input"),N=u("el-option"),L=u("el-select"),ne=u("el-text"),O=u("el-alert"),oe=u("el-empty"),c=u("el-table-column"),X=u("el-tag"),ue=u("el-table"),ie=u("el-pagination"),b=u("el-form-item"),y=u("el-col"),U=u("el-row"),se=u("el-date-picker"),re=u("el-form"),de=u("el-dialog");return d(),p("div",we,[v("div",null,[e(g,{type:"primary",onClick:ee,class:"add-staff-btn"},{default:a(()=>[e(m,null,{default:a(()=>[e(P(ce))]),_:1}),l[14]||(l[14]=h(" Thêm nhân viên "))]),_:1})]),e(te),v("div",ke,[v("div",Ce,[v("div",Ne,[v("div",Te,[e(E,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value=t),placeholder:"Tìm kiếm theo tên, email, số điện thoại...","prefix-icon":"Search",clearable:"",onClear:J,class:"search-input"},null,8,["modelValue"])]),f.value?(d(),p("div",Se,[e(m,{class:"is-loading"},{default:a(()=>[e(P(Q))]),_:1}),l[15]||(l[15]=h(" Đang tìm kiếm... "))])):V("",!0)])])]),f.value?(d(),p("div",Ee,[e(m,{icon:P(Q)},null,8,["icon"]),l[16]||(l[16]=v("p",null,"Đang tải dữ liệu...",-1))])):V("",!0),v("div",xe,[v("div",Me,[v("div",Ae,[e(L,{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=t=>w.value=t),placeholder:"Lọc theo giới tính",clearable:"",size:"small",onClear:Y,style:{width:"150px"}},{default:a(()=>[e(N,{label:"Nam",value:!0}),e(N,{label:"Nữ",value:!1})]),_:1},8,["modelValue"]),e(L,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=t=>k.value=t),placeholder:"Lọc theo trạng thái",clearable:"",size:"small",onClear:Y,style:{width:"150px"}},{default:a(()=>[e(N,{label:"Đang làm",value:"ENABLE"}),e(N,{label:"Nghỉ",value:"DISABLE"})]),_:1},8,["modelValue"]),e(g,{size:"small",onClick:Y,disabled:!w.value&&!k.value&&!i.value},{default:a(()=>l[17]||(l[17]=[h(" Xóa bộ lọc ")])),_:1},8,["disabled"])]),f.value?V("",!0):(d(),p("div",Ke,[e(ne,{size:"small",type:"info"},{default:a(()=>[h(" Tổng: "+x(G.value)+" nhân viên ",1),i.value||w.value!==null||k.value!==null?(d(),p("span",Le," (đã lọc) ")):V("",!0)]),_:1})]))])]),T.value&&!f.value?(d(),p("div",Ue,[e(O,{title:T.value,type:"error","show-icon":"",closable:!1},null,8,["title"])])):V("",!0),i.value&&!f.value&&!T.value?(d(),p("div",Be,[e(O,{title:`Kết quả tìm kiếm cho: '${i.value}' (${M.value.length} nhân viên)`,type:"info",closable:!1,"show-icon":""},null,8,["title"])])):V("",!0),!f.value&&!T.value&&M.value.length===0?(d(),p("div",De,[e(oe,null,{description:a(()=>[i.value||w.value!==null||k.value!==null?(d(),p("span",Fe," Không tìm thấy nhân viên nào phù hợp với bộ lọc ")):(d(),p("span",Ye,"Chưa có nhân viên nào"))]),default:a(()=>[i.value||w.value!==null||k.value!==null?(d(),pe(g,{key:0,type:"primary",onClick:Y},{default:a(()=>l[18]||(l[18]=[h(" Xóa bộ lọc ")])),_:1})):V("",!0)]),_:1})])):V("",!0),!f.value&&!T.value&&M.value.length>0?(d(),p("div",ze,[l[21]||(l[21]=v("h2",null,"Danh sách nhân viên",-1)),e(ue,{data:M.value,style:{width:"100%"},stripe:""},{default:a(()=>[e(c,{type:"index",label:"STT",width:"60",index:t=>t+1+s.value*10},null,8,["index"]),e(c,{prop:"maNhanVien",label:"Mã nhân viên",width:"120"}),e(c,{prop:"tenNhanVien",label:"Tên nhân viên",width:"150"}),e(c,{prop:"taiKhoan",label:"Tên đăng nhập",width:"130"}),e(c,{prop:"email",label:"Email",width:"180"}),e(c,{prop:"sdt",label:"Số điện thoại",width:"120"}),e(c,{prop:"diaChi",label:"Địa chỉ",width:"150"},{default:a(t=>[v("span",Pe,x(t.row.diaChi||"Không có"),1)]),_:1}),e(c,{label:"Trạng thái",width:"100"},{default:a(t=>[e(X,{type:t.row.trangThai==="ENABLE"?"success":"danger",size:"small"},{default:a(()=>[h(x(t.row.trangThai==="ENABLE"?"Đang làm":"Nghỉ"),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"Chức vụ",width:"100"},{default:a(t=>[e(X,{type:t.row.chucVu==="ADMIN"?"primary":"info",size:"small"},{default:a(()=>[h(x(t.row.chucVu==="ADMIN"?"Quản lý":"Nhân viên"),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"Giới tính",width:"80"},{default:a(t=>[h(x(t.row.gioiTinh?"Nam":"Nữ"),1)]),_:1}),e(c,{label:"Năm sinh",width:"100"},{default:a(t=>[h(x(new Date(t.row.namSinh).getFullYear()),1)]),_:1}),e(c,{label:"Thao tác",width:"100",fixed:"right"},{default:a(t=>[e(g,{type:"primary",size:"small",icon:P(fe),onClick:Oe=>le(t.row.id),title:"Chỉnh sửa"},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"]),K.value>1?(d(),p("div",je,[v("div",Ie,[e(g,{disabled:s.value===0,onClick:W,type:"default"},{default:a(()=>l[19]||(l[19]=[h(" « ")])),_:1},8,["disabled"]),e(ie,{background:"",layout:"prev, pager, next","page-size":10,"current-page":s.value+1,total:K.value*10,"pager-count":7,"prev-text":"‹","next-text":"›",onCurrentChange:ae},null,8,["current-page","total"]),e(g,{disabled:s.value===K.value-1,onClick:Z,type:"default"},{default:a(()=>l[20]||(l[20]=[h(" » ")])),_:1},8,["disabled"])])])):V("",!0)])):V("",!0),e(de,{modelValue:A.value,"onUpdate:modelValue":l[13]||(l[13]=t=>A.value=t),title:S.value?"Cập nhật thông tin nhân viên":"Thêm nhân viên mới",width:"800px","before-close":I},{footer:a(()=>[v("div",Ge,[e(g,{onClick:I,disabled:D.value},{default:a(()=>l[22]||(l[22]=[h(" Hủy ")])),_:1},8,["disabled"]),e(g,{type:"primary",onClick:q,loading:D.value},{default:a(()=>[h(x(S.value?"Cập nhật":"Thêm nhân viên"),1)]),_:1},8,["loading"])])]),default:a(()=>[e(re,{model:o.value,"label-width":"140px","label-position":"left",onSubmit:_e(q,["prevent"])},{default:a(()=>[e(U,{gutter:20},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(b,{label:"Tên nhân viên",error:_.tenNhanVien},{default:a(()=>[e(E,{modelValue:o.value.tenNhanVien,"onUpdate:modelValue":l[3]||(l[3]=t=>o.value.tenNhanVien=t),placeholder:"Nhập tên nhân viên"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(y,{span:12},{default:a(()=>[e(b,{label:"Tên đăng nhập",error:_.taiKhoan},{default:a(()=>[e(E,{modelValue:o.value.taiKhoan,"onUpdate:modelValue":l[4]||(l[4]=t=>o.value.taiKhoan=t),modelModifiers:{trim:!0},placeholder:"Nhập tên đăng nhập"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(b,{label:"Mật khẩu",error:_.matKhau},{default:a(()=>[e(E,{modelValue:o.value.matKhau,"onUpdate:modelValue":l[5]||(l[5]=t=>o.value.matKhau=t),modelModifiers:{trim:!0},type:"password",placeholder:S.value?"Chỉ đổi khi nhân viên nghỉ":"Nhập mật khẩu","show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["error"])]),_:1}),e(y,{span:12},{default:a(()=>[e(b,{label:"Email",error:_.email},{default:a(()=>[e(E,{modelValue:o.value.email,"onUpdate:modelValue":l[6]||(l[6]=t=>o.value.email=t),modelModifiers:{trim:!0},placeholder:"Nhập email"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(b,{label:"Số điện thoại",error:_.sdt},{default:a(()=>[e(E,{modelValue:o.value.sdt,"onUpdate:modelValue":l[7]||(l[7]=t=>o.value.sdt=t),modelModifiers:{trim:!0},placeholder:"Nhập số điện thoại"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),e(y,{span:12},{default:a(()=>[e(b,{label:"Địa chỉ",error:_.diaChi},{default:a(()=>[e(E,{modelValue:o.value.diaChi,"onUpdate:modelValue":l[8]||(l[8]=t=>o.value.diaChi=t),placeholder:"Nhập địa chỉ"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(b,{label:"Trạng thái"},{default:a(()=>[e(L,{modelValue:o.value.trangThai,"onUpdate:modelValue":l[9]||(l[9]=t=>o.value.trangThai=t),placeholder:"Chọn trạng thái"},{default:a(()=>[e(N,{label:"Đang làm",value:"ENABLE"}),e(N,{label:"Nghỉ",value:"DISABLE"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:a(()=>[e(b,{label:"Chức vụ"},{default:a(()=>[e(L,{modelValue:o.value.chucVu,"onUpdate:modelValue":l[10]||(l[10]=t=>o.value.chucVu=t),placeholder:"Chọn chức vụ"},{default:a(()=>[e(N,{label:"Nhân viên",value:"STAFF"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(y,{span:12},{default:a(()=>[e(b,{label:"Giới tính"},{default:a(()=>[e(L,{modelValue:o.value.gioiTinh,"onUpdate:modelValue":l[11]||(l[11]=t=>o.value.gioiTinh=t),placeholder:"Chọn giới tính"},{default:a(()=>[e(N,{label:"Nam",value:!0}),e(N,{label:"Nữ",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:a(()=>[e(b,{label:"Năm sinh",error:_.namSinh},{default:a(()=>[e(se,{modelValue:o.value.namSinh,"onUpdate:modelValue":l[12]||(l[12]=t=>o.value.namSinh=t),type:"date",placeholder:"Chọn năm sinh",format:"DD/MM/YYYY","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Qe=ve($e,[["__scopeId","data-v-fb9ed17e"]]);export{Qe as default};
