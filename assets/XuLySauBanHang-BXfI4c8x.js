import{_ as Q,r as c,u as j,c as X,w as J,o as W,b as e,d as l,g as Z,e as t,t as o,v as Y,U as tt,X as st,k as i,B as nt,F as g,m as y,n as I,S as at}from"./index-BFtI-PwE.js";import{g as lt,b as et,d as ot,e as it}from"./ActionAfterCaseServices-ZTgTmkBw.js";import{C as ct}from"./ConfirmModal-CTKRHOBX.js";const ut={class:"after-sales-container"},dt={class:"stats-section"},ht={class:"stats-grid"},rt={class:"stat-card urgent"},vt={class:"stat-number"},_t={class:"stat-card warning"},gt={class:"stat-number"},yt={class:"stat-card info"},pt={class:"stat-number"},bt={class:"stat-card success"},mt={class:"stat-number"},ft={class:"filter-section"},kt={class:"filter-controls"},Ct={class:"search-box"},Dt={class:"tabs-section"},wt={class:"tab-navigation"},Vt=["onClick"],Ht={class:"tab-content"},xt={key:0,class:"table-container"},Lt={class:"orders-table"},St={class:"order-id-cell"},Nt={class:"customer-cell"},Tt={class:"customer-info"},Bt={class:"phone"},Xt={class:"status-cell"},It={class:"date-cell"},Et={class:"amount-cell"},Gt={class:"status-cell"},Mt={class:"actions-cell"},$t={key:0,class:"order-actions"},Kt=["onClick"],Pt={key:1,class:"order-actions"},Ot=["onClick"],At={key:1,class:"table-container"},Yt={class:"orders-table"},zt={class:"order-id-cell"},Ft={class:"customer-cell"},Ut={class:"customer-info"},Rt={class:"address"},qt={class:"failure-cell"},Qt={class:"failure-reason"},jt={class:"retry-cell"},Jt={class:"amount-cell"},Wt={class:"actions-cell"},Zt={key:0,class:"order-actions"},ts=["onClick"],ss={key:1,class:"order-actions"},ns=["onClick"],as={key:2,class:"table-container"},ls={class:"orders-table"},es={class:"order-id-cell"},os={class:"customer-cell"},is={class:"customer-info"},cs={class:"return-type"},us={class:"return-cell"},ds={class:"return-reason"},hs={class:"date-cell"},rs={class:"amount-cell"},vs={class:"actions-cell"},_s={key:0,class:"order-actions"},gs=["onClick"],ys={key:1,class:"order-actions"},ps=["onClick"],bs={key:0,class:"tw-modal-overlay"},ms={class:"tw-modal-content"},fs={class:"tw-product-table"},ks=["src","onClick"],Cs={key:1,style:{color:"gray","font-size":"14px"}},Ds={class:"tw-modal-content",style:{"max-width":"80%","max-height":"80%",padding:"0",background:"transparent","box-shadow":"none"}},ws=["src"],Vs=["src"],Hs={key:1,style:{color:"gray","font-size":"14px"}},xs={controls:"",autoplay:"",style:{"max-width":"80%","max-height":"80%"}},Ls=["src"],Ss={key:2,class:"order-actions"},Ns=["onClick"],Ts=["onClick"],Bs=["onClick"],Xs={class:"pagination-controls"},Is=["disabled"],Es=["disabled"],Gs={__name:"XuLySauBanHang",setup(Ms){const d=c("all"),p=c(""),b=c("desc"),m=c(null),D=c(!1),w=c(!1),E=c([]);function V(a){w.value=!0,G(a)}async function G(a){const n=await ot(a);E.value=n.data}function M(){w.value=!1}function z(){D.value=!0}function F(){D.value=!1}const H=["PENDING","HOLD","CANCEL"],f=j(),v=c({total:0,failed:0,returns:0,resolved:0}),$=async()=>{try{const a=await et();console.log("Káº¿t quáº£:",a.data),v.value=a.data}catch(a){console.error("Lá»—i khi láº¥y dá»¯ liá»‡u:",a)}},K=c([{id:"all",label:"Táº¥t cáº£"},{id:"failed_delivery",label:"Giao hÃ ng tháº¥t báº¡i"},{id:"return",label:"YÃªu cáº§u tráº£ hÃ ng"}]);X(()=>K.value.find(a=>a.id===d.value));const r=c([]),h=c(0),P=c(5),k=c(1),_=async()=>{const a=d.value==="all"?null:d.value.toUpperCase(),n=await lt(h.value,P.value,p.value,a,b.value);k.value=n.data.totalPages,r.value=n.data.content},x=async(a,n,s)=>{await it(a,n,s),s==="HOLD"?f.success("Báº¡n Ä‘Ã£ cháº¥p nháº­n yÃªu cáº§u!"):s==="CANCEL"?f.success("Báº¡n Ä‘Ã£ tá»« chá»‘i yÃªu cáº§u!"):s==="RECEIVED"&&f.success("ÄÃ£ nháº­n Ä‘Æ°á»£c hÃ ng"),$(),_(),G(a)},U=async()=>{h.value+1<k.value&&(h.value++,await _())},R=async()=>{h.value>0&&(h.value--,await _())},C=c(!1),O=c("");let L=null;function S(a,n){O.value=a,L=n,C.value=!0}function q(){L&&L(),C.value=!1}J([h,P,p,d,b],()=>{_(),console.log("order value:",r.value,"status",d.value)},{immediate:!0});const N=a=>{at.push("/admin/handle-detail/"+a),f.success("Chuyá»ƒn thÃ nh cÃ´ng qua trang xá»­ lÃ½")};X(()=>r.value.filter(a=>a.status==="failed")),X(()=>r.value.filter(a=>a.status==="return"));const A=a=>({failed:"Giao hÃ ng tháº¥t báº¡i",return:"YÃªu cáº§u tráº£ hÃ ng",processing:"Äang xá»­ lÃ½"})[a]||a;function T(a){return a?new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(a)):""}const B=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a);return W(()=>{_(),$()}),(a,n)=>(l(),e("div",ut,[n[17]||(n[17]=Z('<header class="page-header" data-v-01ddb0e5><div class="header-content" data-v-01ddb0e5><h1 class="page-title" data-v-01ddb0e5>Xá»­ LÃ½ Sau BÃ¡n HÃ ng</h1><div class="policy-section" data-v-01ddb0e5><h3 data-v-01ddb0e5>ChÃ­nh SÃ¡ch Cá»­a HÃ ng</h3><div class="policy-items" data-v-01ddb0e5><span class="policy-item" data-v-01ddb0e5>ğŸ”„ Äá»•i tráº£ trong 7 ngÃ y</span><span class="policy-item" data-v-01ddb0e5>ğŸ“¦ Miá»…n phÃ­ váº­n chuyá»ƒn Ä‘á»•i tráº£</span><span class="policy-item" data-v-01ddb0e5>ğŸ’° HoÃ n tiá»n 100% náº¿u lá»—i tá»« shop</span><span class="policy-item" data-v-01ddb0e5>â° Xá»­ lÃ½ trong 24h</span></div></div></div></header>',1)),t("section",dt,[t("div",ht,[t("div",rt,[t("div",vt,o(v.value.total),1),n[4]||(n[4]=t("div",{class:"stat-label"},"Tá»•ng Ä‘Æ¡n cáº§n phÃª duyá»‡t",-1))]),t("div",_t,[t("div",gt,o(v.value.failed),1),n[5]||(n[5]=t("div",{class:"stat-label"},"Giao hÃ ng tháº¥t báº¡i",-1))]),t("div",yt,[t("div",pt,o(v.value.returns),1),n[6]||(n[6]=t("div",{class:"stat-label"},"YÃªu cáº§u tráº£ hÃ ng",-1))]),t("div",bt,[t("div",mt,o(v.value.resolved),1),n[7]||(n[7]=t("div",{class:"stat-label"},"ÄÃ£ xá»­ lÃ½ hÃ´m nay",-1))])])]),t("section",ft,[t("div",kt,[t("div",Ct,[Y(t("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=s=>p.value=s),placeholder:"TÃ¬m kiáº¿m theo mÃ£ Ä‘Æ¡n, tÃªn khÃ¡ch hÃ ng...",class:"search-input"},null,512),[[tt,p.value]]),n[8]||(n[8]=t("button",{class:"search-btn"},"ğŸ”",-1))]),Y(t("select",{"onUpdate:modelValue":n[1]||(n[1]=s=>b.value=s),class:"sort-select"},n[9]||(n[9]=[t("option",{value:"asc"},"Sáº¯p xáº¿p theo ngÃ y giáº£m dáº§n",-1),t("option",{value:"desc"},"Sáº¯p xáº¿p theo ngÃ y tÄƒng dáº§n",-1)]),512),[[st,b.value]])])]),t("section",Dt,[t("div",wt,[(l(!0),e(g,null,y(K.value,s=>(l(),e("button",{key:s.id,onClick:u=>d.value=s.id,class:I(["tab-button",{active:d.value===s.id}])},o(s.label),11,Vt))),128))]),t("div",Ht,[d.value==="all"?(l(),e("div",xt,[t("table",Lt,[n[10]||(n[10]=t("thead",null,[t("tr",null,[t("th",null,"MÃ£ Ä‘Æ¡n"),t("th",null,"KhÃ¡ch hÃ ng"),t("th",null,"Loáº¡i yÃªu cáº§u"),t("th",null,"NgÃ y yÃªu cáº§u xá»­ lÃ½"),t("th",null,"GiÃ¡ trá»‹"),t("th",null,"Tráº¡ng thÃ¡i"),t("th",null,"Thao tÃ¡c")])],-1)),t("tbody",null,[(l(!0),e(g,null,y(r.value,s=>(l(),e("tr",{key:s.idXuLyBanHang,class:"order-row"},[t("td",St,"#"+o(s.maHoaDon),1),t("td",Nt,[t("div",Tt,[t("strong",null,o(s.tenKhachHang||"KhÃ¡ch vÃ£ng lai"),1),t("span",Bt,o(s.sdt),1)])]),t("td",Xt,[t("span",{class:I(["order-status",s.trangThaiDonHang])},o(A(s.trangThaiDonHang)),3)]),t("td",It,o(T(s.thoiGianYeuCau)),1),t("td",Et,o(B(s.giaBan)),1),t("td",Gt,[t("span",{class:I(["order-status",s.hanhDongSauVuViec])},o(A(s.hanhDongSauVuViec)),3)]),t("td",Mt,[H.includes(s.hanhDongSauVuViec)?i("",!0):(l(),e("div",$t,[t("button",{class:"action-btn primary",onClick:u=>N(s.idHoaDon)},"Xá»­ lÃ½",8,Kt)])),s.hanhDongSauVuViec==="PENDING"||s.hanhDongSauVuViec==="HOLD"?(l(),e("div",Pt,[t("button",{class:"action-btn info",onClick:u=>V(s.idHoaDon)}," Xem chi tiáº¿t ",8,Ot)])):i("",!0)])]))),128))])])])):i("",!0),d.value==="failed_delivery"?(l(),e("div",At,[t("table",Yt,[n[11]||(n[11]=t("thead",null,[t("tr",null,[t("th",null,"MÃ£ Ä‘Æ¡n"),t("th",null,"KhÃ¡ch hÃ ng"),t("th",null,"LÃ½ do tháº¥t báº¡i"),t("th",null,"Thá»i gian yÃªu cáº§u"),t("th",null,"GiÃ¡ trá»‹"),t("th",null,"Thao tÃ¡c")])],-1)),t("tbody",null,[(l(!0),e(g,null,y(r.value,s=>(l(),e("tr",{key:s.idXuLyBanHang,class:"order-row failed"},[t("td",zt,"#"+o(s.maHoaDon),1),t("td",Ft,[t("div",Ut,[t("strong",null,o(s.tenKhachHang||"KhÃ¡ch vÃ£ng lai"),1),t("span",Rt,o(s.sdt),1)])]),t("td",qt,[t("span",Qt,o(s.trangThaiDonHang),1)]),t("td",jt,o(T(s.thoiGianYeuCau)),1),t("td",Jt,o(B(s.giaBan)),1),t("td",Wt,[H.includes(s.hanhDongSauVuViec)?i("",!0):(l(),e("div",Zt,[t("button",{class:"action-btn primary",onClick:u=>N(s.idHoaDon)},"Xá»­ lÃ½",8,ts)])),s.hanhDongSauVuViec==="PENDING"||s.hanhDongSauVuViec==="HOLD"?(l(),e("div",ss,[t("button",{class:"action-btn info",onClick:u=>V(s.idHoaDon)}," Xem chi tiáº¿t ",8,ns)])):i("",!0)])]))),128))])])])):i("",!0),d.value==="return"?(l(),e("div",as,[t("table",ls,[n[12]||(n[12]=t("thead",null,[t("tr",null,[t("th",null,"MÃ£ Ä‘Æ¡n"),t("th",null,"KhÃ¡ch hÃ ng"),t("th",null,"LÃ½ do tráº£ hÃ ng"),t("th",null,"NgÃ y yÃªu cáº§u"),t("th",null,"GiÃ¡ trá»‹"),t("th",null,"Thao tÃ¡c")])],-1)),t("tbody",null,[(l(!0),e(g,null,y(r.value,s=>(l(),e("tr",{key:s.idXuLyBanHang,class:"order-row return"},[t("td",es,"#"+o(s.maHoaDon),1),t("td",os,[t("div",is,[t("strong",null,o(s.tenKhachHang||"KhÃ¡ch vÃ£ng lai"),1),t("span",cs,o(s.trangThaiDonHang),1)])]),t("td",us,[t("span",ds,o(s.returnReason),1)]),t("td",hs,o(T(s.thoiGianYeuCau)),1),t("td",rs,o(B(s.giaBan)),1),t("td",vs,[H.includes(s.hanhDongSauVuViec)?i("",!0):(l(),e("div",_s,[t("button",{class:"action-btn primary",onClick:u=>N(s.idHoaDon)},"Xá»­ lÃ½",8,gs)])),s.hanhDongSauVuViec==="PENDING"||s.hanhDongSauVuViec==="HOLD"?(l(),e("div",ys,[t("button",{class:"action-btn info",onClick:u=>V(s.idHoaDon)}," Xem chi tiáº¿t ",8,ps)])):i("",!0)])]))),128))])])])):i("",!0)]),w.value?(l(),e("div",bs,[t("div",ms,[t("button",{class:"tw-modal-close",onClick:M},"âœ•"),n[14]||(n[14]=t("h2",null,"Chi tiáº¿t yÃªu cáº§u xá»­ lÃ½",-1)),t("table",fs,[n[13]||(n[13]=t("thead",null,[t("tr",null,[t("th",null,"IMEI"),t("th",null,"TÃªn sáº£n pháº©m"),t("th",null,"HÃ¬nh áº£nh"),t("th",null,"Video"),t("th",null,"HÃ nh Ä‘á»™ng")])],-1)),t("tbody",null,[(l(!0),e(g,null,y(E.value,s=>(l(),e("tr",{key:s.idImei},[t("td",null,o(s.soImei),1),t("td",null,o(s.tenSanPham+"-"+s.mau+"-"+s.dungLuong),1),t("td",null,[s.urlHinh?(l(),e("img",{key:0,src:s.urlHinh,style:{"max-width":"80px",cursor:"zoom-in"},onClick:u=>m.value=s.urlHinh},null,8,ks)):i("",!0),s.urlHinh?i("",!0):(l(),e("span",Cs,"KhÃ´ng cÃ³ hÃ¬nh áº£nh"))]),m.value?(l(),e("div",{key:0,class:"tw-modal-overlay",onClick:n[2]||(n[2]=u=>m.value=null)},[t("div",Ds,[t("img",{src:m.value,style:{"max-width":"100%","max-height":"100%","border-radius":"8px"}},null,8,ws)])])):i("",!0),t("td",null,[s.urlVideo?(l(),e("video",{key:0,ref_for:!0,ref:"videoThumb",controls:"",style:{"max-width":"120px",cursor:"pointer"},onClick:z},[t("source",{src:s.urlVideo,type:"video/mp4"},null,8,Vs)],512)):i("",!0),s.urlVideo?i("",!0):(l(),e("span",Hs,"KhÃ´ng cÃ³ video"))]),D.value?(l(),e("div",{key:1,class:"modal",onClick:F},[t("video",xs,[t("source",{src:s.urlVideo,type:"video/mp4"},null,8,Ls)])])):i("",!0),s.trangThaiDon==="PENDING"?(l(),e("td",Ss,[t("button",{class:"tw-btn tw-btn-success",onClick:u=>S("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n cháº¥p nháº­n yÃªu cáº§u?",()=>x(s.idHoaDon,s.soImei,"HOLD")),title:"Cháº¥p nháº­n"}," Cháº¥p nháº­n ",8,Ns),t("button",{class:"tw-btn tw-btn-danger",onClick:u=>S("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n tá»« chá»‘i yÃªu cáº§u?",()=>x(s.idHoaDon,s.soImei,"CANCEL")),title:"Tá»« chá»‘i"}," Tá»« chá»‘i ",8,Ts)])):i("",!0),t("td",null,[s.trangThaiDon==="HOLD"?(l(),e("button",{key:0,class:"tw-btn tw-btn-success",onClick:u=>S("XÃ¡c nháº­n Ä‘Ã£ nháº­n Ä‘Æ°á»£c hÃ ng?",()=>x(s.idHoaDon,s.soImei,"RECEIVED")),title:"ÄÃ£ nháº­n hÃ ng"}," ÄÃ£ nháº­n hÃ ng ",8,Bs)):i("",!0)])]))),128))])]),t("div",{class:"tw-modal-actions"},[t("button",{class:"tw-btn",onClick:M},"ÄÃ³ng")])])])):i("",!0),n[15]||(n[15]=t("br",null,null,-1)),t("div",Xs,[t("button",{onClick:R,disabled:h.value===0}," < ",8,Is),t("span",null,"Trang "+o(h.value+1)+" / "+o(k.value),1),t("button",{onClick:U,disabled:h.value+1>=k.value}," > ",8,Es)]),n[16]||(n[16]=t("br",null,null,-1)),C.value?(l(),nt(ct,{key:1,message:O.value,onConfirm:q,onCancel:n[3]||(n[3]=s=>C.value=!1)},null,8,["message"])):i("",!0)])]))}},Os=Q(Gs,[["__scopeId","data-v-01ddb0e5"]]);export{Os as default};
